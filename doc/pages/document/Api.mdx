---
name: API
route: /document/Api.mdx
---

import { FormattedMessage } from "@components/FormattedMessage";
import { Playground } from "@components/Playground";

# API

<FormattedMessage id="api-ts-surport" />

## flowProps

```tsx
link?: (source: D, target: D) => boolean;
dir: PortDir;
anchor: { x: number; y: number } | (() => { x: number; y: number });
data: Object;
```

## portProps

```tsx
canvasData?: any; // 画布的数据
onEvent?: (e: { type: string; data: any }) => void; // propProps-onEnvent

onLoad?: (model: FlowModel) => void;
flowModelRef?: any;
width?: number;
height?: number;
grid?: number;
multiSelect?: boolean; // 是否开启多选
components?: Record<string, React.FC<any>>;
models?: Record<string, typeof CellModel>;
linkEdge?: string; // 当前默认连接的edge
```

## flowModelProps

```tsx
get height: () => number
set height: (grid: number) => void

get width: () => number
set width: (grid: number) => void

get grid: () => number
set grid: (grid: number) => void

get linkEdge: () => number
set linkEdge: (linkEdge: string) => void

get scale: () => number
set scale: (scale: number) => void

get x: () => number
set x: (x: number) => void

get y: () => number
set y: (y: number) => void

// 右键菜单的visible
get contextMenuVisible: () => boolean
set contextMenuVisible: (visible: boolean) => void

// 获取当前正在连接的port
getLinkingPort: () => string

// 获取当前鼠标的[画布坐标]
getCursorCoord: (e: React.MouseEvent, isCanvasCoord: boolean = true) => {x: Number, y: number};

canvasData: Object

// 设置画布数据
setCanvasData: (canvasData: CanvasDataType) => void;

// 设置某个Cell的data，包括node，edge，port
setCellData = (id: string, data: any, deepMerge: boolean = true) => void;

// 获取某个node连接的所有edge
getNodeEdges: (nodeId: string) => string[];

//获取某个port连接的所有port
getPortLinkPorts: (portId: string) => string[];

// 获取某个port连接的所有node
getPortLinkNodes: (portId: string) => string[]

// 获取某个node连接的所有port
getLinkPorts: (nodeId: string) => string[];

// 获取某个node连接的所有node
getLinkNodes: (nodeId: string) => string[];

// 删除某个Cell
deleCell: (id: string) => string;

// 增添Cell，返回增添cell的id
addCell: (componentName: string, initOptions?: any) => string

// 手动对port进行连线，返回增添edge的id
link: (source: string, target: string) => string

// 调整某个Cell的层级
moveTo: (id: string, index: number) => void

getCellData: (id: string) => Object

getCellModel: (id: string) => CellModel;

getPortInstance: (id: string) => React.Component
```

## cellModelProps

NodeModel 和 EdgeModel 都是继承于 CellModel

```jsx
defaultData = (): any => ({
    id: "", // 自动生成
    component: "", // 取注册的component，如没有则自动生成
    cellType: "", // 自动生成
  });

context: FlowModel;

data: CellDataType;

// 是否被选中
isSelect: boolean

// 获取外层包裹div/g的元素实例
getWrapperRef: () => HTMLDivElement

setData = (data: any, rec: boolean = true): void

// 获取某个Model合并了原型链上所有父class的defaultData后的defaultData
static getDefaultData: () => Object
```

## nodeModelProps

```tsx
getLinkNodes: () => string[]
getLinkPorts: () => string[]
getNodeEdges: () => string[]

```

## edgeModelProps

```tsx
defaultData: () => ({
  source: "", // 连线会自动更改
  target: "", // 连线会自动更改
});

getLinkNodesData: () => {source: Object, target: Object}

getPointAt: (ratio: number) => {x: number, y: number}

// 是否正在连线
isLinking: () => boolean

// 用作<path>的d属性中
d: string

```
