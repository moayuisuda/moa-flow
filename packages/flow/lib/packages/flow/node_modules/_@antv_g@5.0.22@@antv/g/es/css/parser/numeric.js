import '../cssom/types.js';
import '../cssom/CSSColorValue.js';
import '../cssom/CSSKeywordValue.js';
import '../cssom/CSSMathOperator.js';
import '../cssom/CSSMathInvert.js';
import '../cssom/CSSMathMax.js';
import '../cssom/CSSMathMin.js';
import '../cssom/CSSMathNegate.js';
import '../cssom/CSSMathProduct.js';
import '../cssom/CSSMathSum.js';
import '../cssom/CSSMathValue.js';
import '../cssom/CSSMathVariadic.js';
import '../cssom/CSSNumericValue.js';
import '../cssom/CSSNumericValueType.js';
import '../cssom/CSSRGB.js';
import '../cssom/CSSGradientValue.js';
import '../cssom/CSSStyleValue.js';
import '../cssom/CSSTransformValue.js';
import '../cssom/CSSTranslate.js';
import { CSSUnitValue } from '../cssom/CSSUnitValue.js';
import clamp from '../../../../../_lodash-es@4.17.21@lodash-es/clamp.js';
import isString from '../../../../../_lodash-es@4.17.21@lodash-es/isString.js';

function numberToString(x) {
  // scale(0.00000001) -> scale(0)
  // return x.toFixed(6).replace(/0+$/, '').replace(/\.$/, '');
  return x.toString();
}
/**
 * parse string or number to CSSUnitValue(numeric)
 *
 * eg.
 * * 0 -> CSSUnitValue(0)
 * * '2' -> CSSUnitValue(2)
 */

function parseNumber(string) {
  if (typeof string === 'number') {
    return new CSSUnitValue(string);
  }

  if (/^\s*[-+]?(\d*\.)?\d+\s*$/.test(string)) {
    return new CSSUnitValue(Number(string));
  } else {
    return new CSSUnitValue(0);
  }
}
/**
 * separate string to array
 * eg.
 * * [0.5, 0.5] -> [CSSUnitValue, CSSUnitValue]
 */

function parseNumberList(string) {
  if (isString(string)) {
    return string.split(' ').map(parseNumber);
  } else {
    return string.map(parseNumber);
  }
}
function mergeNumbers(left, right) {
  return [left.value, right.value, numberToString];
}
function clampedMergeNumbers(min, max) {
  return function (left, right) {
    return [left.value, right.value, function (x) {
      return numberToString(clamp(x, min, max));
    }];
  };
}

export { clampedMergeNumbers, mergeNumbers, numberToString, parseNumber, parseNumberList };
