{"ast":null,"code":"import { __decorate, __metadata } from \"tslib\";\nimport { inject, singleton } from 'mana-syringe';\nimport { CSSRGB, CSSGradientValue, GradientPatternType } from '@antv/g';\nimport { Shape, RenderingPluginContribution, ContextService, RenderingContext, ElementEvent } from '@antv/g';\nimport { isString } from 'lodash-es';\nvar HTML_PREFIX = 'g-html-';\n\nvar HTMLRenderingPlugin =\n/** @class */\nfunction () {\n  function HTMLRenderingPlugin() {}\n\n  HTMLRenderingPlugin_1 = HTMLRenderingPlugin;\n\n  HTMLRenderingPlugin.prototype.apply = function (renderingService) {\n    var _this = this;\n\n    var handleMounted = function handleMounted(e) {\n      var object = e.target;\n\n      if (object.nodeName === Shape.HTML) {\n        var innerHTML = object.parsedStyle.innerHTML;\n        var existedId = HTML_PREFIX + object.entity;\n\n        var $container = _this.contextService.getDomElement().parentNode;\n\n        if ($container) {\n          var $existedElement = $container.querySelector('#' + existedId);\n\n          if (!$existedElement) {\n            var $div = document.createElement('div');\n            object.parsedStyle.$el = $div;\n            $div.id = existedId;\n\n            if (isString(innerHTML)) {\n              $div.innerHTML = innerHTML;\n            } else {\n              $div.appendChild(innerHTML);\n            }\n\n            $container.appendChild($div);\n          }\n        }\n      }\n    };\n\n    var handleUnmounted = function handleUnmounted(e) {\n      var object = e.target;\n\n      if (object.nodeName === Shape.HTML) {\n        var existedId = HTML_PREFIX + object.entity;\n\n        var $container = _this.contextService.getDomElement().parentNode;\n\n        if ($container) {\n          var $existedElement = $container.querySelector('#' + existedId);\n\n          if ($existedElement) {\n            $container.removeChild($existedElement);\n          }\n        }\n      }\n    };\n\n    renderingService.hooks.init.tap(HTMLRenderingPlugin_1.tag, function () {\n      _this.renderingContext.root.addEventListener(ElementEvent.MOUNTED, handleMounted);\n\n      _this.renderingContext.root.addEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n    });\n    renderingService.hooks.destroy.tap(HTMLRenderingPlugin_1.tag, function () {\n      _this.renderingContext.root.removeEventListener(ElementEvent.MOUNTED, handleMounted);\n\n      _this.renderingContext.root.removeEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n    });\n    renderingService.hooks.render.tap(HTMLRenderingPlugin_1.tag, function (object) {\n      if (object.nodeName === Shape.HTML) {\n        var existedId = HTML_PREFIX + object.entity;\n\n        var $container = _this.contextService.getDomElement().parentNode;\n\n        if ($container) {\n          var $existedElement = $container.querySelector('#' + existedId);\n\n          _this.updateCSSStyle($existedElement, object.parsedStyle, object);\n        }\n      }\n    });\n  };\n\n  HTMLRenderingPlugin.prototype.updateCSSStyle = function ($el, parsedStyle, object) {\n    var zIndex = parsedStyle.zIndex,\n        visibility = parsedStyle.visibility,\n        opacity = parsedStyle.opacity,\n        fill = parsedStyle.fill,\n        lineWidth = parsedStyle.lineWidth,\n        lineDash = parsedStyle.lineDash,\n        stroke = parsedStyle.stroke,\n        width = parsedStyle.width,\n        height = parsedStyle.height,\n        _a = parsedStyle.style,\n        initialStyle = _a === void 0 ? '' : _a,\n        _b = parsedStyle.className,\n        className = _b === void 0 ? '' : _b;\n    var contentWidth = 0;\n    var contentHeight = 0;\n    var widthValue = width.value;\n    var heightValue = height.value;\n    contentWidth = widthValue;\n    contentHeight = heightValue;\n    var style = {}; // use absolute position\n\n    style.position = 'absolute';\n    style.top = 0;\n    style.left = 0;\n    style.width = \"\".concat(contentWidth, \"px\");\n    style.height = \"\".concat(contentHeight, \"px\"); // use transform\n\n    style.transform = \"matrix3d(\".concat(object.getWorldTransform().join(','), \")\"); // use unparsed transform origin\n\n    if (object.style.transformOrigin) {\n      style['transform-origin'] = object.style.transformOrigin;\n    } // z-index\n\n\n    style['z-index'] = zIndex.value; // visibility\n\n    style.visibility = visibility.value; // opacity\n\n    style.opacity = opacity.value; // backgroundColor\n\n    if (fill) {\n      var color = '';\n\n      if (fill instanceof CSSRGB) {\n        color = fill.toString();\n      } else if (fill instanceof CSSGradientValue) {\n        if (fill.type === GradientPatternType.LinearGradient) {\n          var steps = fill.value.steps.map(function (cur) {\n            //  ['0', '#ffffff'],\n            return \"\".concat(cur[1], \" \").concat(Number(cur[0]) * 100, \"%\");\n          }).join(','); // @see https://developer.mozilla.org/en-US/docs/Web/CSS/gradient/linear-gradient()\n\n          color = \"linear-gradient(to right, \".concat(steps, \");\");\n        }\n      }\n\n      style.background = color;\n    } // border\n\n\n    style['border-width'] = \"\".concat((lineWidth === null || lineWidth === void 0 ? void 0 : lineWidth.value) || 0, \"px\");\n\n    if (stroke) {\n      style['border-color'] = stroke.toString();\n      style['border-style'] = 'solid';\n    }\n\n    if (lineDash) {\n      style['border-style'] = 'dashed';\n    } // filters\n\n\n    if (object.style.filter) {\n      // use unparsed filter directly\n      style.filter = object.style.filter;\n    }\n\n    if (className) {\n      if (Array.isArray(className)) {\n        className.forEach(function (c) {\n          $el.classList.add(c);\n        });\n      } else {\n        $el.classList.add(className);\n      }\n    }\n\n    $el.setAttribute('style', Object.keys(style).map(function (key) {\n      return \"\".concat(key, \":\").concat(style[key]);\n    }).join(';') + initialStyle);\n  };\n\n  var HTMLRenderingPlugin_1;\n  HTMLRenderingPlugin.tag = 'HTMLRenderingPlugin';\n\n  __decorate([inject(ContextService), __metadata(\"design:type\", Object)], HTMLRenderingPlugin.prototype, \"contextService\", void 0);\n\n  __decorate([inject(RenderingContext), __metadata(\"design:type\", Object)], HTMLRenderingPlugin.prototype, \"renderingContext\", void 0);\n\n  HTMLRenderingPlugin = HTMLRenderingPlugin_1 = __decorate([singleton({\n    contrib: RenderingPluginContribution\n  })], HTMLRenderingPlugin);\n  return HTMLRenderingPlugin;\n}();\n\nexport { HTMLRenderingPlugin };","map":{"version":3,"sources":["/Users/dennis.zhang/Desktop/其它代码库/moa-flow/node_modules/@antv/g-plugin-html-renderer/es/HTMLRenderingPlugin.js"],"names":["__decorate","__metadata","inject","singleton","CSSRGB","CSSGradientValue","GradientPatternType","Shape","RenderingPluginContribution","ContextService","RenderingContext","ElementEvent","isString","HTML_PREFIX","HTMLRenderingPlugin","HTMLRenderingPlugin_1","prototype","apply","renderingService","_this","handleMounted","e","object","target","nodeName","HTML","innerHTML","parsedStyle","existedId","entity","$container","contextService","getDomElement","parentNode","$existedElement","querySelector","$div","document","createElement","$el","id","appendChild","handleUnmounted","removeChild","hooks","init","tap","tag","renderingContext","root","addEventListener","MOUNTED","UNMOUNTED","destroy","removeEventListener","render","updateCSSStyle","zIndex","visibility","opacity","fill","lineWidth","lineDash","stroke","width","height","_a","style","initialStyle","_b","className","contentWidth","contentHeight","widthValue","value","heightValue","position","top","left","concat","transform","getWorldTransform","join","transformOrigin","color","toString","type","LinearGradient","steps","map","cur","Number","background","filter","Array","isArray","forEach","c","classList","add","setAttribute","Object","keys","key","contrib"],"mappings":"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","sourcesContent":["import { __decorate, __metadata } from \"tslib\";\nimport { inject, singleton } from 'mana-syringe';\nimport { CSSRGB, CSSGradientValue, GradientPatternType } from '@antv/g';\nimport { Shape, RenderingPluginContribution, ContextService, RenderingContext, ElementEvent } from '@antv/g';\nimport { isString } from 'lodash-es';\nvar HTML_PREFIX = 'g-html-';\n\nvar HTMLRenderingPlugin =\n/** @class */\nfunction () {\n  function HTMLRenderingPlugin() {}\n\n  HTMLRenderingPlugin_1 = HTMLRenderingPlugin;\n\n  HTMLRenderingPlugin.prototype.apply = function (renderingService) {\n    var _this = this;\n\n    var handleMounted = function handleMounted(e) {\n      var object = e.target;\n\n      if (object.nodeName === Shape.HTML) {\n        var innerHTML = object.parsedStyle.innerHTML;\n        var existedId = HTML_PREFIX + object.entity;\n\n        var $container = _this.contextService.getDomElement().parentNode;\n\n        if ($container) {\n          var $existedElement = $container.querySelector('#' + existedId);\n\n          if (!$existedElement) {\n            var $div = document.createElement('div');\n            object.parsedStyle.$el = $div;\n            $div.id = existedId;\n\n            if (isString(innerHTML)) {\n              $div.innerHTML = innerHTML;\n            } else {\n              $div.appendChild(innerHTML);\n            }\n\n            $container.appendChild($div);\n          }\n        }\n      }\n    };\n\n    var handleUnmounted = function handleUnmounted(e) {\n      var object = e.target;\n\n      if (object.nodeName === Shape.HTML) {\n        var existedId = HTML_PREFIX + object.entity;\n\n        var $container = _this.contextService.getDomElement().parentNode;\n\n        if ($container) {\n          var $existedElement = $container.querySelector('#' + existedId);\n\n          if ($existedElement) {\n            $container.removeChild($existedElement);\n          }\n        }\n      }\n    };\n\n    renderingService.hooks.init.tap(HTMLRenderingPlugin_1.tag, function () {\n      _this.renderingContext.root.addEventListener(ElementEvent.MOUNTED, handleMounted);\n\n      _this.renderingContext.root.addEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n    });\n    renderingService.hooks.destroy.tap(HTMLRenderingPlugin_1.tag, function () {\n      _this.renderingContext.root.removeEventListener(ElementEvent.MOUNTED, handleMounted);\n\n      _this.renderingContext.root.removeEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n    });\n    renderingService.hooks.render.tap(HTMLRenderingPlugin_1.tag, function (object) {\n      if (object.nodeName === Shape.HTML) {\n        var existedId = HTML_PREFIX + object.entity;\n\n        var $container = _this.contextService.getDomElement().parentNode;\n\n        if ($container) {\n          var $existedElement = $container.querySelector('#' + existedId);\n\n          _this.updateCSSStyle($existedElement, object.parsedStyle, object);\n        }\n      }\n    });\n  };\n\n  HTMLRenderingPlugin.prototype.updateCSSStyle = function ($el, parsedStyle, object) {\n    var zIndex = parsedStyle.zIndex,\n        visibility = parsedStyle.visibility,\n        opacity = parsedStyle.opacity,\n        fill = parsedStyle.fill,\n        lineWidth = parsedStyle.lineWidth,\n        lineDash = parsedStyle.lineDash,\n        stroke = parsedStyle.stroke,\n        width = parsedStyle.width,\n        height = parsedStyle.height,\n        _a = parsedStyle.style,\n        initialStyle = _a === void 0 ? '' : _a,\n        _b = parsedStyle.className,\n        className = _b === void 0 ? '' : _b;\n    var contentWidth = 0;\n    var contentHeight = 0;\n    var widthValue = width.value;\n    var heightValue = height.value;\n    contentWidth = widthValue;\n    contentHeight = heightValue;\n    var style = {}; // use absolute position\n\n    style.position = 'absolute';\n    style.top = 0;\n    style.left = 0;\n    style.width = \"\".concat(contentWidth, \"px\");\n    style.height = \"\".concat(contentHeight, \"px\"); // use transform\n\n    style.transform = \"matrix3d(\".concat(object.getWorldTransform().join(','), \")\"); // use unparsed transform origin\n\n    if (object.style.transformOrigin) {\n      style['transform-origin'] = object.style.transformOrigin;\n    } // z-index\n\n\n    style['z-index'] = zIndex.value; // visibility\n\n    style.visibility = visibility.value; // opacity\n\n    style.opacity = opacity.value; // backgroundColor\n\n    if (fill) {\n      var color = '';\n\n      if (fill instanceof CSSRGB) {\n        color = fill.toString();\n      } else if (fill instanceof CSSGradientValue) {\n        if (fill.type === GradientPatternType.LinearGradient) {\n          var steps = fill.value.steps.map(function (cur) {\n            //  ['0', '#ffffff'],\n            return \"\".concat(cur[1], \" \").concat(Number(cur[0]) * 100, \"%\");\n          }).join(','); // @see https://developer.mozilla.org/en-US/docs/Web/CSS/gradient/linear-gradient()\n\n          color = \"linear-gradient(to right, \".concat(steps, \");\");\n        }\n      }\n\n      style.background = color;\n    } // border\n\n\n    style['border-width'] = \"\".concat((lineWidth === null || lineWidth === void 0 ? void 0 : lineWidth.value) || 0, \"px\");\n\n    if (stroke) {\n      style['border-color'] = stroke.toString();\n      style['border-style'] = 'solid';\n    }\n\n    if (lineDash) {\n      style['border-style'] = 'dashed';\n    } // filters\n\n\n    if (object.style.filter) {\n      // use unparsed filter directly\n      style.filter = object.style.filter;\n    }\n\n    if (className) {\n      if (Array.isArray(className)) {\n        className.forEach(function (c) {\n          $el.classList.add(c);\n        });\n      } else {\n        $el.classList.add(className);\n      }\n    }\n\n    $el.setAttribute('style', Object.keys(style).map(function (key) {\n      return \"\".concat(key, \":\").concat(style[key]);\n    }).join(';') + initialStyle);\n  };\n\n  var HTMLRenderingPlugin_1;\n  HTMLRenderingPlugin.tag = 'HTMLRenderingPlugin';\n\n  __decorate([inject(ContextService), __metadata(\"design:type\", Object)], HTMLRenderingPlugin.prototype, \"contextService\", void 0);\n\n  __decorate([inject(RenderingContext), __metadata(\"design:type\", Object)], HTMLRenderingPlugin.prototype, \"renderingContext\", void 0);\n\n  HTMLRenderingPlugin = HTMLRenderingPlugin_1 = __decorate([singleton({\n    contrib: RenderingPluginContribution\n  })], HTMLRenderingPlugin);\n  return HTMLRenderingPlugin;\n}();\n\nexport { HTMLRenderingPlugin };"]},"metadata":{},"sourceType":"module"}