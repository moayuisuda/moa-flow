{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { singleton, Syringe } from 'mana-syringe';\nexport var SceneGraphSelectorFactory = Syringe.defineToken('SceneGraphSelectorFactory');\nexport var SceneGraphSelector = Syringe.defineToken('SceneGraphSelector', {\n  multiple: false\n});\nvar NAME_REGEXP = /\\[\\s*name=(.*)\\s*\\]/;\n/**\n * support the following DOM API:\n * * getElementById\n * * getElementsByClassName\n * * getElementsByName\n * * getElementsByTag\n * * querySelector\n * * querySelectorAll\n */\n\nvar DefaultSceneGraphSelector =\n/** @class */\nfunction () {\n  function DefaultSceneGraphSelector() {}\n\n  DefaultSceneGraphSelector.prototype.selectOne = function (query, root) {\n    if (query.startsWith('.')) {\n      return root.find(function (node) {\n        // return !node.shadow && node.id === query.substring(1);\n        return node.className === query.substring(1);\n      });\n    } else if (query.startsWith('#')) {\n      // getElementById('id')\n      return root.find(function (node) {\n        // return !node.shadow && node.id === query.substring(1);\n        return node.id === query.substring(1);\n      });\n    } else if (query.startsWith('[name=')) {\n      var matches = query.match(NAME_REGEXP);\n\n      if (matches && matches.length > 1) {\n        var targetName_1 = matches[1].replace(/\"/g, ''); // getElementByName();\n\n        return root.find(function (node) {\n          return root !== node && node.name === targetName_1;\n        });\n      } else {\n        return null;\n      }\n    } else {\n      // getElementsByTag('circle');\n      return root.find(function (node) {\n        return root !== node && node.nodeName === query;\n      });\n    }\n  };\n\n  DefaultSceneGraphSelector.prototype.selectAll = function (query, root) {\n    // only support `[name=\"${name}\"]` `.className` `#id`\n    if (query.startsWith('.')) {\n      // getElementsByClassName('className');\n      // should not include itself\n      return root.findAll(function (node) {\n        return root !== node && node.className === query.substring(1);\n      });\n    } else if (query.startsWith('#')) {\n      return root.findAll(function (node) {\n        return root !== node && node.id === query.substring(1);\n      });\n    } else if (query.startsWith('[name=')) {\n      // getElementsByName();\n      var matches = query.match(NAME_REGEXP);\n\n      if (matches && matches.length > 1) {\n        var targetName_2 = matches[1].replace(/\"/g, ''); // getElementByName();\n\n        return root.findAll(function (node) {\n          return root !== node && node.name === targetName_2;\n        });\n      } else {\n        return [];\n      }\n    } else {\n      // getElementsByTag('circle');\n      return root.findAll(function (node) {\n        return root !== node && node.nodeName === query;\n      });\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  DefaultSceneGraphSelector.prototype.is = function () {\n    // TODO: need a simple `matches` implementation\n    return true;\n  };\n\n  DefaultSceneGraphSelector = __decorate([singleton({\n    token: SceneGraphSelector\n  })], DefaultSceneGraphSelector);\n  return DefaultSceneGraphSelector;\n}();\n\nexport { DefaultSceneGraphSelector };","map":{"version":3,"sources":["/Users/dennis.zhang/Desktop/其它代码库/moa-flow/node_modules/@antv/g/es/services/SceneGraphSelector.js"],"names":["__decorate","singleton","Syringe","SceneGraphSelectorFactory","defineToken","SceneGraphSelector","multiple","NAME_REGEXP","DefaultSceneGraphSelector","prototype","selectOne","query","root","startsWith","find","node","className","substring","id","matches","match","length","targetName_1","replace","name","nodeName","selectAll","findAll","targetName_2","is","token"],"mappings":"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","sourcesContent":["import { __decorate } from \"tslib\";\nimport { singleton, Syringe } from 'mana-syringe';\nexport var SceneGraphSelectorFactory = Syringe.defineToken('SceneGraphSelectorFactory');\nexport var SceneGraphSelector = Syringe.defineToken('SceneGraphSelector', {\n  multiple: false\n});\nvar NAME_REGEXP = /\\[\\s*name=(.*)\\s*\\]/;\n/**\n * support the following DOM API:\n * * getElementById\n * * getElementsByClassName\n * * getElementsByName\n * * getElementsByTag\n * * querySelector\n * * querySelectorAll\n */\n\nvar DefaultSceneGraphSelector =\n/** @class */\nfunction () {\n  function DefaultSceneGraphSelector() {}\n\n  DefaultSceneGraphSelector.prototype.selectOne = function (query, root) {\n    if (query.startsWith('.')) {\n      return root.find(function (node) {\n        // return !node.shadow && node.id === query.substring(1);\n        return node.className === query.substring(1);\n      });\n    } else if (query.startsWith('#')) {\n      // getElementById('id')\n      return root.find(function (node) {\n        // return !node.shadow && node.id === query.substring(1);\n        return node.id === query.substring(1);\n      });\n    } else if (query.startsWith('[name=')) {\n      var matches = query.match(NAME_REGEXP);\n\n      if (matches && matches.length > 1) {\n        var targetName_1 = matches[1].replace(/\"/g, ''); // getElementByName();\n\n        return root.find(function (node) {\n          return root !== node && node.name === targetName_1;\n        });\n      } else {\n        return null;\n      }\n    } else {\n      // getElementsByTag('circle');\n      return root.find(function (node) {\n        return root !== node && node.nodeName === query;\n      });\n    }\n  };\n\n  DefaultSceneGraphSelector.prototype.selectAll = function (query, root) {\n    // only support `[name=\"${name}\"]` `.className` `#id`\n    if (query.startsWith('.')) {\n      // getElementsByClassName('className');\n      // should not include itself\n      return root.findAll(function (node) {\n        return root !== node && node.className === query.substring(1);\n      });\n    } else if (query.startsWith('#')) {\n      return root.findAll(function (node) {\n        return root !== node && node.id === query.substring(1);\n      });\n    } else if (query.startsWith('[name=')) {\n      // getElementsByName();\n      var matches = query.match(NAME_REGEXP);\n\n      if (matches && matches.length > 1) {\n        var targetName_2 = matches[1].replace(/\"/g, ''); // getElementByName();\n\n        return root.findAll(function (node) {\n          return root !== node && node.name === targetName_2;\n        });\n      } else {\n        return [];\n      }\n    } else {\n      // getElementsByTag('circle');\n      return root.findAll(function (node) {\n        return root !== node && node.nodeName === query;\n      });\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  DefaultSceneGraphSelector.prototype.is = function () {\n    // TODO: need a simple `matches` implementation\n    return true;\n  };\n\n  DefaultSceneGraphSelector = __decorate([singleton({\n    token: SceneGraphSelector\n  })], DefaultSceneGraphSelector);\n  return DefaultSceneGraphSelector;\n}();\n\nexport { DefaultSceneGraphSelector };"]},"metadata":{},"sourceType":"module"}