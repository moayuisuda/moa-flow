{"ast":null,"code":"/**\n * @example\n  {\n    translateY: [200, 300],\n    scale: [1, 10],\n  }\n\n * groups' length can be different, the following config should generate 3 frames:\n  @example\n  {\n    translateY: [200, 300, 400],\n    scale: [1, 10],\n  }\n */\nfunction convertToArrayForm(effectInput) {\n  var normalizedEffectInput = [];\n\n  for (var property in effectInput) {\n    // skip reserved props\n    if (property in ['easing', 'offset', 'composite']) {\n      continue;\n    } // @ts-ignore\n\n\n    var values = effectInput[property];\n\n    if (!Array.isArray(values)) {\n      values = [values];\n    }\n\n    var numKeyframes = values.length;\n\n    for (var i = 0; i < numKeyframes; i++) {\n      if (!normalizedEffectInput[i]) {\n        var keyframe = {};\n\n        if ('offset' in effectInput) {\n          keyframe.offset = Number(effectInput.offset);\n        }\n\n        if ('easing' in effectInput) {\n          // @ts-ignore\n          keyframe.easing = effectInput.easing;\n        }\n\n        if ('composite' in effectInput) {\n          // @ts-ignore\n          keyframe.composite = effectInput.composite;\n        }\n\n        normalizedEffectInput[i] = keyframe;\n      }\n\n      if (values[i] !== undefined && values[i] !== null) {\n        normalizedEffectInput[i][property] = values[i];\n      }\n    }\n  }\n\n  normalizedEffectInput.sort(function (a, b) {\n    return (a.computedOffset || 0) - (b.computedOffset || 0);\n  });\n  return normalizedEffectInput;\n}\n\nexport function normalizeKeyframes(effectInput, timing) {\n  if (effectInput === null) {\n    return [];\n  }\n\n  if (!Array.isArray(effectInput)) {\n    effectInput = convertToArrayForm(effectInput);\n  }\n\n  var keyframes = effectInput.map(function (originalKeyframe) {\n    var keyframe = {};\n\n    if (timing === null || timing === void 0 ? void 0 : timing.composite) {\n      // This will be auto if the composite operation specified on the effect is being used.\n      // @see https://developer.mozilla.org/en-US/docs/Web/API/Web_Animations_API/Keyframe_Formats\n      keyframe.composite = 'auto';\n    }\n\n    for (var member in originalKeyframe) {\n      var memberValue = originalKeyframe[member];\n\n      if (member === 'offset') {\n        if (memberValue !== null) {\n          memberValue = Number(memberValue);\n          if (!isFinite(memberValue)) throw new Error('Keyframe offsets must be numbers.');\n          if (memberValue < 0 || memberValue > 1) throw new Error('Keyframe offsets must be between 0 and 1.');\n          keyframe.computedOffset = memberValue;\n        }\n      } else if (member === 'composite') {\n        // TODO: Support add & accumulate in KeyframeEffect.composite\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/KeyframeEffect/composite\n        if (['replace', 'add', 'accumulate', 'auto'].indexOf(memberValue) === -1) {\n          throw new Error(\"\".concat(memberValue, \" compositing is not supported\"));\n        }\n      } else if (member === 'easing') {// TODO: Validate animation-timing-function\n        // @see https://developer.mozilla.org/en-US/docs/Web/CSS/animation-timing-function\n        // memberValue = memberValue;\n        // } else {\n        //   memberValue = '' + memberValue;\n      } // assign to keyframe, no need to parse shorthand value\n\n\n      keyframe[member] = memberValue;\n    }\n\n    if (keyframe.offset === undefined) {\n      keyframe.offset = null;\n    }\n\n    if (keyframe.easing === undefined) {\n      // override with timing.easing\n      keyframe.easing = (timing === null || timing === void 0 ? void 0 : timing.easing) || 'linear';\n    }\n\n    if (keyframe.composite === undefined) {\n      keyframe.composite = 'auto';\n    }\n\n    return keyframe;\n  });\n  var everyFrameHasOffset = true;\n  var previousOffset = -Infinity;\n\n  for (var i = 0; i < keyframes.length; i++) {\n    var offset = keyframes[i].offset;\n\n    if (offset !== null && offset !== undefined) {\n      if (offset < previousOffset) {\n        throw new TypeError('Keyframes are not loosely sorted by offset. Sort or specify offsets.');\n      }\n\n      previousOffset = offset;\n    } else {\n      everyFrameHasOffset = false;\n    }\n  }\n\n  keyframes = keyframes.filter(function (keyframe) {\n    return Number(keyframe.offset) >= 0 && Number(keyframe.offset) <= 1;\n  });\n\n  function spaceKeyframes() {\n    var _a, _b;\n\n    var length = keyframes.length;\n    keyframes[length - 1].computedOffset = Number((_a = keyframes[length - 1].offset) !== null && _a !== void 0 ? _a : 1);\n\n    if (length > 1) {\n      keyframes[0].computedOffset = Number((_b = keyframes[0].offset) !== null && _b !== void 0 ? _b : 0);\n    }\n\n    var previousIndex = 0;\n    var previousOffset = Number(keyframes[0].computedOffset);\n\n    for (var i = 1; i < length; i++) {\n      var offset = Number(keyframes[i].computedOffset);\n\n      if (offset !== null && offset !== undefined && previousOffset !== null && previousOffset !== undefined) {\n        for (var j = 1; j < i - previousIndex; j++) {\n          keyframes[previousIndex + j].computedOffset = previousOffset + (offset - previousOffset) * j / (i - previousIndex);\n        }\n\n        previousIndex = i;\n        previousOffset = offset;\n      }\n    }\n  }\n\n  if (!everyFrameHasOffset) spaceKeyframes();\n  return keyframes;\n}","map":{"version":3,"sources":["/Users/dennis.zhang/Desktop/其它代码库/moa-flow/node_modules/@antv/g/es/dom/KeyframeList.js"],"names":["convertToArrayForm","effectInput","normalizedEffectInput","property","values","Array","isArray","numKeyframes","length","i","keyframe","offset","Number","easing","composite","undefined","sort","a","b","computedOffset","normalizeKeyframes","timing","keyframes","map","originalKeyframe","member","memberValue","isFinite","Error","indexOf","concat","everyFrameHasOffset","previousOffset","Infinity","TypeError","filter","spaceKeyframes","_a","_b","previousIndex","j"],"mappings":"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","sourcesContent":["/**\n * @example\n  {\n    translateY: [200, 300],\n    scale: [1, 10],\n  }\n\n * groups' length can be different, the following config should generate 3 frames:\n  @example\n  {\n    translateY: [200, 300, 400],\n    scale: [1, 10],\n  }\n */\nfunction convertToArrayForm(effectInput) {\n  var normalizedEffectInput = [];\n\n  for (var property in effectInput) {\n    // skip reserved props\n    if (property in ['easing', 'offset', 'composite']) {\n      continue;\n    } // @ts-ignore\n\n\n    var values = effectInput[property];\n\n    if (!Array.isArray(values)) {\n      values = [values];\n    }\n\n    var numKeyframes = values.length;\n\n    for (var i = 0; i < numKeyframes; i++) {\n      if (!normalizedEffectInput[i]) {\n        var keyframe = {};\n\n        if ('offset' in effectInput) {\n          keyframe.offset = Number(effectInput.offset);\n        }\n\n        if ('easing' in effectInput) {\n          // @ts-ignore\n          keyframe.easing = effectInput.easing;\n        }\n\n        if ('composite' in effectInput) {\n          // @ts-ignore\n          keyframe.composite = effectInput.composite;\n        }\n\n        normalizedEffectInput[i] = keyframe;\n      }\n\n      if (values[i] !== undefined && values[i] !== null) {\n        normalizedEffectInput[i][property] = values[i];\n      }\n    }\n  }\n\n  normalizedEffectInput.sort(function (a, b) {\n    return (a.computedOffset || 0) - (b.computedOffset || 0);\n  });\n  return normalizedEffectInput;\n}\n\nexport function normalizeKeyframes(effectInput, timing) {\n  if (effectInput === null) {\n    return [];\n  }\n\n  if (!Array.isArray(effectInput)) {\n    effectInput = convertToArrayForm(effectInput);\n  }\n\n  var keyframes = effectInput.map(function (originalKeyframe) {\n    var keyframe = {};\n\n    if (timing === null || timing === void 0 ? void 0 : timing.composite) {\n      // This will be auto if the composite operation specified on the effect is being used.\n      // @see https://developer.mozilla.org/en-US/docs/Web/API/Web_Animations_API/Keyframe_Formats\n      keyframe.composite = 'auto';\n    }\n\n    for (var member in originalKeyframe) {\n      var memberValue = originalKeyframe[member];\n\n      if (member === 'offset') {\n        if (memberValue !== null) {\n          memberValue = Number(memberValue);\n          if (!isFinite(memberValue)) throw new Error('Keyframe offsets must be numbers.');\n          if (memberValue < 0 || memberValue > 1) throw new Error('Keyframe offsets must be between 0 and 1.');\n          keyframe.computedOffset = memberValue;\n        }\n      } else if (member === 'composite') {\n        // TODO: Support add & accumulate in KeyframeEffect.composite\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/KeyframeEffect/composite\n        if (['replace', 'add', 'accumulate', 'auto'].indexOf(memberValue) === -1) {\n          throw new Error(\"\".concat(memberValue, \" compositing is not supported\"));\n        }\n      } else if (member === 'easing') {// TODO: Validate animation-timing-function\n        // @see https://developer.mozilla.org/en-US/docs/Web/CSS/animation-timing-function\n        // memberValue = memberValue;\n        // } else {\n        //   memberValue = '' + memberValue;\n      } // assign to keyframe, no need to parse shorthand value\n\n\n      keyframe[member] = memberValue;\n    }\n\n    if (keyframe.offset === undefined) {\n      keyframe.offset = null;\n    }\n\n    if (keyframe.easing === undefined) {\n      // override with timing.easing\n      keyframe.easing = (timing === null || timing === void 0 ? void 0 : timing.easing) || 'linear';\n    }\n\n    if (keyframe.composite === undefined) {\n      keyframe.composite = 'auto';\n    }\n\n    return keyframe;\n  });\n  var everyFrameHasOffset = true;\n  var previousOffset = -Infinity;\n\n  for (var i = 0; i < keyframes.length; i++) {\n    var offset = keyframes[i].offset;\n\n    if (offset !== null && offset !== undefined) {\n      if (offset < previousOffset) {\n        throw new TypeError('Keyframes are not loosely sorted by offset. Sort or specify offsets.');\n      }\n\n      previousOffset = offset;\n    } else {\n      everyFrameHasOffset = false;\n    }\n  }\n\n  keyframes = keyframes.filter(function (keyframe) {\n    return Number(keyframe.offset) >= 0 && Number(keyframe.offset) <= 1;\n  });\n\n  function spaceKeyframes() {\n    var _a, _b;\n\n    var length = keyframes.length;\n    keyframes[length - 1].computedOffset = Number((_a = keyframes[length - 1].offset) !== null && _a !== void 0 ? _a : 1);\n\n    if (length > 1) {\n      keyframes[0].computedOffset = Number((_b = keyframes[0].offset) !== null && _b !== void 0 ? _b : 0);\n    }\n\n    var previousIndex = 0;\n    var previousOffset = Number(keyframes[0].computedOffset);\n\n    for (var i = 1; i < length; i++) {\n      var offset = Number(keyframes[i].computedOffset);\n\n      if (offset !== null && offset !== undefined && previousOffset !== null && previousOffset !== undefined) {\n        for (var j = 1; j < i - previousIndex; j++) {\n          keyframes[previousIndex + j].computedOffset = previousOffset + (offset - previousOffset) * j / (i - previousIndex);\n        }\n\n        previousIndex = i;\n        previousOffset = offset;\n      }\n    }\n  }\n\n  if (!everyFrameHasOffset) spaceKeyframes();\n  return keyframes;\n}"]},"metadata":{},"sourceType":"module"}