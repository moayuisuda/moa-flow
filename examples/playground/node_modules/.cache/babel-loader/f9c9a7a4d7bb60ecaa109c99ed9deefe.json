{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.typeConstraint = exports.namedConstraint = exports.taggedConstraint = exports.traverseAncerstors = void 0;\n\nvar METADATA_KEY = require(\"../constants/metadata_keys\");\n\nvar metadata_1 = require(\"../planning/metadata\");\n\nvar traverseAncerstors = function (request, constraint) {\n  var parent = request.parentRequest;\n\n  if (parent !== null) {\n    return constraint(parent) ? true : traverseAncerstors(parent, constraint);\n  } else {\n    return false;\n  }\n};\n\nexports.traverseAncerstors = traverseAncerstors;\n\nvar taggedConstraint = function (key) {\n  return function (value) {\n    var constraint = function (request) {\n      return request !== null && request.target !== null && request.target.matchesTag(key)(value);\n    };\n\n    constraint.metaData = new metadata_1.Metadata(key, value);\n    return constraint;\n  };\n};\n\nexports.taggedConstraint = taggedConstraint;\nvar namedConstraint = taggedConstraint(METADATA_KEY.NAMED_TAG);\nexports.namedConstraint = namedConstraint;\n\nvar typeConstraint = function (type) {\n  return function (request) {\n    var binding = null;\n\n    if (request !== null) {\n      binding = request.bindings[0];\n\n      if (typeof type === \"string\") {\n        var serviceIdentifier = binding.serviceIdentifier;\n        return serviceIdentifier === type;\n      } else {\n        var constructor = request.bindings[0].implementationType;\n        return type === constructor;\n      }\n    }\n\n    return false;\n  };\n};\n\nexports.typeConstraint = typeConstraint;","map":{"version":3,"mappings":";;;;;;;AAAA;;AAEA;;AAEA,IAAMA,kBAAkB,GAAG,UACvBC,OADuB,EAEvBC,UAFuB,EAEkB;AAGzC,MAAMC,MAAM,GAAGF,OAAO,CAACG,aAAvB;;AACA,MAAID,MAAM,KAAK,IAAf,EAAqB;AACjB,WAAOD,UAAU,CAACC,MAAD,CAAV,GAAqB,IAArB,GAA4BH,kBAAkB,CAACG,MAAD,EAASD,UAAT,CAArD;AACH,GAFD,MAEO;AACH,WAAO,KAAP;AACH;AACJ,CAXD;;AA+CSG;;AAhCT,IAAMC,gBAAgB,GAAG,UAACC,GAAD,EAA8B;AAAK,mBAACC,KAAD,EAAW;AAEnE,QAAMN,UAAU,GAAmC,UAACD,OAAD,EAAmC;AAClF,oBAAO,KAAK,IAAZ,IAAoBA,OAAO,CAACQ,MAAR,KAAmB,IAAvC,IAA+CR,OAAO,CAACQ,MAAR,CAAeC,UAAf,CAA0BH,GAA1B,EAA+BC,KAA/B,CAA/C;AAAoF,KADxF;;AAGAN,cAAU,CAACS,QAAX,GAAsB,IAAIC,mBAAJ,CAAaL,GAAb,EAAkBC,KAAlB,CAAtB;AAEA,WAAON,UAAP;AACH,GAR2D;AAQ3D,CARD;;AAgC6BG;AAtB7B,IAAMQ,eAAe,GAAGP,gBAAgB,CAACQ,YAAY,CAACC,SAAd,CAAxC;AAsB+CV;;AApB/C,IAAMW,cAAc,GAAG,UAACC,IAAD,EAA0B;AAAK,mBAAChB,OAAD,EAAmC;AAIrF,QAAIiB,OAAO,GAAmC,IAA9C;;AAEA,QAAIjB,OAAO,KAAK,IAAhB,EAAsB;AAClBiB,aAAO,GAAGjB,OAAO,CAACkB,QAAR,CAAiB,CAAjB,CAAV;;AACA,UAAI,OAAOF,IAAP,KAAgB,QAApB,EAA8B;AAC1B,YAAMG,iBAAiB,GAAGF,OAAO,CAACE,iBAAlC;AACA,eAAOA,iBAAiB,KAAKH,IAA7B;AACH,OAHD,MAGO;AACH,YAAMI,WAAW,GAAGpB,OAAO,CAACkB,QAAR,CAAiB,CAAjB,EAAoBG,kBAAxC;AACA,eAAOL,IAAI,KAAKI,WAAhB;AACH;AACJ;;AAED,WAAO,KAAP;AACH,GAlBqD;AAkBrD,CAlBD;;AAoBgEhB","names":["traverseAncerstors","request","constraint","parent","parentRequest","exports","taggedConstraint","key","value","target","matchesTag","metaData","metadata_1","namedConstraint","METADATA_KEY","NAMED_TAG","typeConstraint","type","binding","bindings","serviceIdentifier","constructor","implementationType"],"sources":["../../src/syntax/constraint_helpers.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}