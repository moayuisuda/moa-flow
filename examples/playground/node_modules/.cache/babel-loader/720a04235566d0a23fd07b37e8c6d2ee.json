{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.circularDependencyToException = exports.listMetadataForTarget = exports.listRegisteredBindingsForServiceIdentifier = exports.getServiceIdentifierAsString = exports.getFunctionName = void 0;\n\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\n\nfunction getServiceIdentifierAsString(serviceIdentifier) {\n  if (typeof serviceIdentifier === \"function\") {\n    var _serviceIdentifier = serviceIdentifier;\n    return _serviceIdentifier.name;\n  } else if (typeof serviceIdentifier === \"symbol\") {\n    return serviceIdentifier.toString();\n  } else {\n    var _serviceIdentifier = serviceIdentifier;\n    return _serviceIdentifier;\n  }\n}\n\nexports.getServiceIdentifierAsString = getServiceIdentifierAsString;\n\nfunction listRegisteredBindingsForServiceIdentifier(container, serviceIdentifier, getBindings) {\n  var registeredBindingsList = \"\";\n  var registeredBindings = getBindings(container, serviceIdentifier);\n\n  if (registeredBindings.length !== 0) {\n    registeredBindingsList = \"\\nRegistered bindings:\";\n    registeredBindings.forEach(function (binding) {\n      var name = \"Object\";\n\n      if (binding.implementationType !== null) {\n        name = getFunctionName(binding.implementationType);\n      }\n\n      registeredBindingsList = registeredBindingsList + \"\\n \" + name;\n\n      if (binding.constraint.metaData) {\n        registeredBindingsList = registeredBindingsList + \" - \" + binding.constraint.metaData;\n      }\n    });\n  }\n\n  return registeredBindingsList;\n}\n\nexports.listRegisteredBindingsForServiceIdentifier = listRegisteredBindingsForServiceIdentifier;\n\nfunction alreadyDependencyChain(request, serviceIdentifier) {\n  if (request.parentRequest === null) {\n    return false;\n  } else if (request.parentRequest.serviceIdentifier === serviceIdentifier) {\n    return true;\n  } else {\n    return alreadyDependencyChain(request.parentRequest, serviceIdentifier);\n  }\n}\n\nfunction dependencyChainToString(request) {\n  function _createStringArr(req, result) {\n    if (result === void 0) {\n      result = [];\n    }\n\n    var serviceIdentifier = getServiceIdentifierAsString(req.serviceIdentifier);\n    result.push(serviceIdentifier);\n\n    if (req.parentRequest !== null) {\n      return _createStringArr(req.parentRequest, result);\n    }\n\n    return result;\n  }\n\n  var stringArr = _createStringArr(request);\n\n  return stringArr.reverse().join(\" --> \");\n}\n\nfunction circularDependencyToException(request) {\n  request.childRequests.forEach(function (childRequest) {\n    if (alreadyDependencyChain(childRequest, childRequest.serviceIdentifier)) {\n      var services = dependencyChainToString(childRequest);\n      throw new Error(ERROR_MSGS.CIRCULAR_DEPENDENCY + \" \" + services);\n    } else {\n      circularDependencyToException(childRequest);\n    }\n  });\n}\n\nexports.circularDependencyToException = circularDependencyToException;\n\nfunction listMetadataForTarget(serviceIdentifierString, target) {\n  if (target.isTagged() || target.isNamed()) {\n    var m_1 = \"\";\n    var namedTag = target.getNamedTag();\n    var otherTags = target.getCustomTags();\n\n    if (namedTag !== null) {\n      m_1 += namedTag.toString() + \"\\n\";\n    }\n\n    if (otherTags !== null) {\n      otherTags.forEach(function (tag) {\n        m_1 += tag.toString() + \"\\n\";\n      });\n    }\n\n    return \" \" + serviceIdentifierString + \"\\n \" + serviceIdentifierString + \" - \" + m_1;\n  } else {\n    return \" \" + serviceIdentifierString;\n  }\n}\n\nexports.listMetadataForTarget = listMetadataForTarget;\n\nfunction getFunctionName(v) {\n  if (v.name) {\n    return v.name;\n  } else {\n    var name_1 = v.toString();\n    var match = name_1.match(/^function\\s*([^\\s(]+)/);\n    return match ? match[1] : \"Anonymous function: \" + name_1;\n  }\n}\n\nexports.getFunctionName = getFunctionName;","map":{"version":3,"mappings":"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","names":["getServiceIdentifierAsString","serviceIdentifier","_serviceIdentifier","name","toString","exports","listRegisteredBindingsForServiceIdentifier","container","getBindings","registeredBindingsList","registeredBindings","length","forEach","binding","implementationType","getFunctionName","constraint","metaData","alreadyDependencyChain","request","parentRequest","dependencyChainToString","_createStringArr","req","result","push","stringArr","reverse","join","circularDependencyToException","childRequests","childRequest","services","Error","ERROR_MSGS","CIRCULAR_DEPENDENCY","listMetadataForTarget","serviceIdentifierString","target","isTagged","isNamed","m_1","namedTag","getNamedTag","otherTags","getCustomTags","tag","v","name_1","match"],"sources":["../../src/utils/serialization.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}