{"ast":null,"code":"import { AnimationEvent } from './AnimationEvent';\nvar sequenceNumber = 0;\n/**\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Animation/Animation\n */\n\nvar Animation =\n/** @class */\nfunction () {\n  function Animation(effect, timeline) {\n    this.currentTimePending = false;\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Animation/playState\n     */\n    // playState: AnimationPlayState;\n\n    this._idle = true;\n    this._paused = false;\n    this._finishedFlag = true;\n    this._currentTime = 0;\n    this._playbackRate = 1;\n    this._inTimeline = true;\n    this.effect = effect;\n    effect.animation = this;\n    this.timeline = timeline;\n    this.id = \"\".concat(sequenceNumber++);\n    this._inEffect = !!this.effect.update(0);\n    this._holdTime = 0;\n    this._paused = false;\n    this.oldPlayState = 'idle';\n    this.updatePromises();\n  }\n\n  Object.defineProperty(Animation.prototype, \"pending\", {\n    // animation: InternalAnimation | null;\n\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Animation/pending\n     */\n    get: function get() {\n      return this._startTime === null && !this._paused && this.playbackRate !== 0 || this.currentTimePending;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Animation.prototype, \"playState\", {\n    get: function get() {\n      if (this._idle) return 'idle';\n      if (this._isFinished) return 'finished';\n      if (this._paused) return 'paused';\n      return 'running';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Animation.prototype, \"ready\", {\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Animation/ready\n     * @example\n      animation.pause();\n      animation.ready.then(function() {\n        // Displays 'running'\n        alert(animation.playState);\n      });\n      animation.play();\n     */\n    get: function get() {\n      var _this = this;\n\n      if (!this.readyPromise) {\n        if (this.timeline.animationsWithPromises.indexOf(this) === -1) {\n          this.timeline.animationsWithPromises.push(this);\n        }\n\n        this.readyPromise = new Promise(function (resolve, reject) {\n          _this.resolveReadyPromise = function () {\n            resolve(_this);\n          };\n\n          _this.rejectReadyPromise = function () {\n            reject(new Error());\n          };\n        });\n\n        if (!this.pending) {\n          this.resolveReadyPromise();\n        }\n      }\n\n      return this.readyPromise;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Animation.prototype, \"finished\", {\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Animation/finished\n     * @example\n      Promise.all(\n        elem.getAnimations().map(\n          function(animation) {\n            return animation.finished\n          }\n        )\n      ).then(\n        function() {\n          return elem.remove();\n        }\n      );\n     */\n    get: function get() {\n      var _this = this;\n\n      if (!this.finishedPromise) {\n        if (this.timeline.animationsWithPromises.indexOf(this) === -1) {\n          this.timeline.animationsWithPromises.push(this);\n        }\n\n        this.finishedPromise = new Promise(function (resolve, reject) {\n          _this.resolveFinishedPromise = function () {\n            resolve(_this);\n          };\n\n          _this.rejectFinishedPromise = function () {\n            reject(new Error());\n          };\n        });\n\n        if (this.playState === 'finished') {\n          this.resolveFinishedPromise();\n        }\n      }\n\n      return this.finishedPromise;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Animation.prototype, \"currentTime\", {\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Animation/currentTime\n     */\n    get: function get() {\n      this.updatePromises();\n      return this._idle || this.currentTimePending ? null : this._currentTime;\n    },\n    set: function set(newTime) {\n      var _a;\n\n      newTime = Number(newTime);\n      if (isNaN(newTime)) return;\n      this.timeline.restart();\n\n      if (!this._paused && this._startTime !== null) {\n        this._startTime = Number((_a = this.timeline) === null || _a === void 0 ? void 0 : _a.currentTime) - newTime / this.playbackRate;\n      }\n\n      this.currentTimePending = false;\n\n      if (this._currentTime === newTime) {\n        return;\n      }\n\n      if (this._idle) {\n        this._idle = false;\n        this._paused = true;\n      }\n\n      this.tickCurrentTime(newTime, true);\n      this.timeline.applyDirtiedAnimation(this);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Animation.prototype, \"startTime\", {\n    get: function get() {\n      return this._startTime;\n    },\n    set: function set(newTime) {\n      if (newTime !== null) {\n        this.updatePromises();\n        newTime = Number(newTime);\n        if (isNaN(newTime)) return;\n        if (this._paused || this._idle) return;\n        this._startTime = newTime;\n        this.tickCurrentTime((Number(this.timeline.currentTime) - this._startTime) * this.playbackRate);\n        this.timeline.applyDirtiedAnimation(this);\n        this.updatePromises();\n      }\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Animation.prototype, \"playbackRate\", {\n    get: function get() {\n      return this._playbackRate;\n    },\n    set: function set(value) {\n      if (value === this._playbackRate) {\n        return;\n      }\n\n      this.updatePromises();\n      var oldCurrentTime = this.currentTime;\n      this._playbackRate = value;\n      this.startTime = null;\n\n      if (this.playState !== 'paused' && this.playState !== 'idle') {\n        this._finishedFlag = false;\n        this._idle = false;\n        this.ensureAlive();\n        this.timeline.applyDirtiedAnimation(this);\n      }\n\n      if (oldCurrentTime !== null) {\n        this.currentTime = oldCurrentTime;\n      }\n\n      this.updatePromises();\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Animation.prototype, \"_isFinished\", {\n    get: function get() {\n      return !this._idle && (this._playbackRate > 0 && Number(this._currentTime) >= this.totalDuration || this._playbackRate < 0 && Number(this._currentTime) <= 0);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Animation.prototype, \"totalDuration\", {\n    get: function get() {\n      var _a;\n\n      return Number((_a = this.effect) === null || _a === void 0 ? void 0 : _a.getComputedTiming().endTime);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Animation.prototype, \"_needsTick\", {\n    get: function get() {\n      return this.pending || this.playState === 'running' || !this._finishedFlag;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\n   * state machine,\n   * resolve/reject ready/finished Promise according to current state\n   */\n\n  Animation.prototype.updatePromises = function () {\n    var oldPlayState = this.oldPlayState;\n    var newPlayState = this.pending ? 'pending' : this.playState;\n\n    if (this.readyPromise && newPlayState !== oldPlayState) {\n      if (newPlayState === 'idle') {\n        this.rejectReadyPromise();\n        this.readyPromise = undefined;\n      } else if (oldPlayState === 'pending') {\n        this.resolveReadyPromise();\n      } else if (newPlayState === 'pending') {\n        this.readyPromise = undefined;\n      }\n    }\n\n    if (this.finishedPromise && newPlayState !== oldPlayState) {\n      if (newPlayState === 'idle') {\n        this.rejectFinishedPromise();\n        this.finishedPromise = undefined;\n      } else if (newPlayState === 'finished') {\n        this.resolveFinishedPromise();\n      } else if (oldPlayState === 'finished') {\n        this.finishedPromise = undefined;\n      }\n    }\n\n    this.oldPlayState = newPlayState;\n    return this.readyPromise || this.finishedPromise;\n  };\n\n  Animation.prototype.play = function () {\n    this.updatePromises();\n    this._paused = false;\n\n    if (this._isFinished || this._idle) {\n      this.rewind();\n      this._startTime = null;\n    }\n\n    this._finishedFlag = false;\n    this._idle = false;\n    this.ensureAlive();\n    this.timeline.applyDirtiedAnimation(this);\n\n    if (this.timeline.animations.indexOf(this) === -1) {\n      this.timeline.animations.push(this);\n    }\n\n    this.updatePromises();\n  };\n\n  Animation.prototype.pause = function () {\n    this.updatePromises();\n\n    if (this.currentTime) {\n      this._holdTime = this.currentTime;\n    }\n\n    if (!this._isFinished && !this._paused && !this._idle) {\n      this.currentTimePending = true;\n    } else if (this._idle) {\n      this.rewind();\n      this._idle = false;\n    }\n\n    this._startTime = null;\n    this._paused = true;\n    this.updatePromises();\n  };\n\n  Animation.prototype.finish = function () {\n    this.updatePromises();\n    if (this._idle) return;\n    this.currentTime = this._playbackRate > 0 ? this.totalDuration : 0;\n    this._startTime = this.totalDuration - this.currentTime;\n    this.currentTimePending = false;\n    this.timeline.applyDirtiedAnimation(this);\n    this.updatePromises();\n  };\n\n  Animation.prototype.cancel = function () {\n    this.updatePromises();\n    if (!this._inEffect) return;\n    this._inEffect = false;\n    this._idle = true;\n    this._paused = false;\n    this._finishedFlag = true;\n    this._currentTime = 0;\n    this._startTime = null;\n    this.effect.update(null); // effects are invalid after cancellation as the animation state\n    // needs to un-apply.\n\n    this.timeline.applyDirtiedAnimation(this);\n    this.updatePromises();\n  };\n\n  Animation.prototype.reverse = function () {\n    this.updatePromises();\n    var oldCurrentTime = this.currentTime;\n    this.playbackRate *= -1;\n    this.play();\n\n    if (oldCurrentTime !== null) {\n      this.currentTime = oldCurrentTime;\n    }\n\n    this.updatePromises();\n  };\n  /**\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/Animation/updatePlaybackRate\n   */\n\n\n  Animation.prototype.updatePlaybackRate = function (playbackRate) {\n    this.playbackRate = playbackRate;\n  };\n\n  Animation.prototype.targetAnimations = function () {\n    var _a;\n\n    var target = (_a = this.effect) === null || _a === void 0 ? void 0 : _a.target;\n    return target.getAnimations();\n  };\n\n  Animation.prototype.markTarget = function () {\n    var animations = this.targetAnimations();\n\n    if (animations.indexOf(this) === -1) {\n      animations.push(this);\n    }\n  };\n\n  Animation.prototype.unmarkTarget = function () {\n    var animations = this.targetAnimations();\n    var index = animations.indexOf(this);\n\n    if (index !== -1) {\n      animations.splice(index, 1);\n    }\n  };\n\n  Animation.prototype.tick = function (timelineTime, isAnimationFrame) {\n    if (!this._idle && !this._paused) {\n      if (this._startTime === null) {\n        if (isAnimationFrame) {\n          this.startTime = timelineTime - this._currentTime / this.playbackRate;\n        }\n      } else if (!this._isFinished) {\n        this.tickCurrentTime((timelineTime - this._startTime) * this.playbackRate);\n      }\n    }\n\n    if (isAnimationFrame) {\n      this.currentTimePending = false;\n      this.fireEvents(timelineTime);\n    }\n  };\n\n  Animation.prototype.rewind = function () {\n    if (this.playbackRate >= 0) {\n      this.currentTime = 0;\n    } else if (this.totalDuration < Infinity) {\n      this.currentTime = this.totalDuration;\n    } else {\n      throw new Error('Unable to rewind negative playback rate animation with infinite duration');\n    }\n  };\n\n  Animation.prototype.persist = function () {\n    throw new Error('Method not implemented.');\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  Animation.prototype.addEventListener = function (type, listener, options) {\n    throw new Error('Method not implemented.');\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  Animation.prototype.removeEventListener = function (type, listener, options) {\n    throw new Error('Method not implemented.');\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  Animation.prototype.dispatchEvent = function (event) {\n    throw new Error('Method not implemented.');\n  }; // replaceState: AnimationReplaceState;\n\n\n  Animation.prototype.commitStyles = function () {\n    throw new Error('Method not implemented.');\n  };\n\n  Animation.prototype.ensureAlive = function () {\n    var _a, _b; // If an animation is playing backwards and is not fill backwards/both\n    // then it should go out of effect when it reaches the start of its\n    // active interval (currentTime === 0).\n\n\n    if (this.playbackRate < 0 && this.currentTime === 0) {\n      this._inEffect = !!((_a = this.effect) === null || _a === void 0 ? void 0 : _a.update(-1));\n    } else {\n      this._inEffect = !!((_b = this.effect) === null || _b === void 0 ? void 0 : _b.update(this.currentTime));\n    }\n\n    if (!this._inTimeline && (this._inEffect || !this._finishedFlag)) {\n      this._inTimeline = true;\n      this.timeline.animations.push(this);\n    }\n  };\n\n  Animation.prototype.tickCurrentTime = function (newTime, ignoreLimit) {\n    if (newTime !== this._currentTime) {\n      this._currentTime = newTime;\n\n      if (this._isFinished && !ignoreLimit) {\n        this._currentTime = this._playbackRate > 0 ? this.totalDuration : 0;\n      }\n\n      this.ensureAlive();\n    }\n  };\n\n  Animation.prototype.fireEvents = function (baseTime) {\n    var _this = this;\n\n    if (this._isFinished) {\n      if (!this._finishedFlag) {\n        if (this.onfinish) {\n          var event_1 = new AnimationEvent(null, this, this.currentTime, baseTime);\n          setTimeout(function () {\n            if (_this.onfinish) {\n              _this.onfinish(event_1);\n            }\n          });\n        }\n\n        this._finishedFlag = true;\n      }\n    } else {\n      if (this.onframe && this.playState === 'running') {\n        var event_2 = new AnimationEvent(null, this, this.currentTime, baseTime);\n        this.onframe(event_2);\n      }\n\n      this._finishedFlag = false;\n    }\n  };\n\n  return Animation;\n}();\n\nexport { Animation };","map":{"version":3,"sources":["/Users/dennis.zhang/Desktop/其它代码库/moa-flow/node_modules/@antv/g/es/dom/Animation.js"],"names":["AnimationEvent","sequenceNumber","Animation","effect","timeline","currentTimePending","_idle","_paused","_finishedFlag","_currentTime","_playbackRate","_inTimeline","animation","id","concat","_inEffect","update","_holdTime","oldPlayState","updatePromises","Object","defineProperty","prototype","get","_startTime","playbackRate","enumerable","configurable","_isFinished","_this","readyPromise","animationsWithPromises","indexOf","push","Promise","resolve","reject","resolveReadyPromise","rejectReadyPromise","Error","pending","finishedPromise","resolveFinishedPromise","rejectFinishedPromise","playState","set","newTime","_a","Number","isNaN","restart","currentTime","tickCurrentTime","applyDirtiedAnimation","value","oldCurrentTime","startTime","ensureAlive","totalDuration","getComputedTiming","endTime","newPlayState","undefined","play","rewind","animations","pause","finish","cancel","reverse","updatePlaybackRate","targetAnimations","target","getAnimations","markTarget","unmarkTarget","index","splice","tick","timelineTime","isAnimationFrame","fireEvents","Infinity","persist","addEventListener","type","listener","options","removeEventListener","dispatchEvent","event","commitStyles","_b","ignoreLimit","baseTime","onfinish","event_1","setTimeout","onframe","event_2"],"mappings":"AAAA,SAASA,cAAT,QAA+B,kBAA/B;AACA,IAAIC,cAAc,GAAG,CAArB;AACA;AACA;AACA;;AAEA,IAAIC,SAAS;AACb;AACA,YAAY;AACV,WAASA,SAAT,CAAmBC,MAAnB,EAA2BC,QAA3B,EAAqC;AACnC,SAAKC,kBAAL,GAA0B,KAA1B;AACA;AACJ;AACA;AACI;;AAEA,SAAKC,KAAL,GAAa,IAAb;AACA,SAAKC,OAAL,GAAe,KAAf;AACA,SAAKC,aAAL,GAAqB,IAArB;AACA,SAAKC,YAAL,GAAoB,CAApB;AACA,SAAKC,aAAL,GAAqB,CAArB;AACA,SAAKC,WAAL,GAAmB,IAAnB;AACA,SAAKR,MAAL,GAAcA,MAAd;AACAA,IAAAA,MAAM,CAACS,SAAP,GAAmB,IAAnB;AACA,SAAKR,QAAL,GAAgBA,QAAhB;AACA,SAAKS,EAAL,GAAU,GAAGC,MAAH,CAAUb,cAAc,EAAxB,CAAV;AACA,SAAKc,SAAL,GAAiB,CAAC,CAAC,KAAKZ,MAAL,CAAYa,MAAZ,CAAmB,CAAnB,CAAnB;AACA,SAAKC,SAAL,GAAiB,CAAjB;AACA,SAAKV,OAAL,GAAe,KAAf;AACA,SAAKW,YAAL,GAAoB,MAApB;AACA,SAAKC,cAAL;AACD;;AAEDC,EAAAA,MAAM,CAACC,cAAP,CAAsBnB,SAAS,CAACoB,SAAhC,EAA2C,SAA3C,EAAsD;AACpD;;AAEA;AACJ;AACA;AACIC,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAO,KAAKC,UAAL,KAAoB,IAApB,IAA4B,CAAC,KAAKjB,OAAlC,IAA6C,KAAKkB,YAAL,KAAsB,CAAnE,IAAwE,KAAKpB,kBAApF;AACD,KARmD;AASpDqB,IAAAA,UAAU,EAAE,KATwC;AAUpDC,IAAAA,YAAY,EAAE;AAVsC,GAAtD;AAYAP,EAAAA,MAAM,CAACC,cAAP,CAAsBnB,SAAS,CAACoB,SAAhC,EAA2C,WAA3C,EAAwD;AACtDC,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,UAAI,KAAKjB,KAAT,EAAgB,OAAO,MAAP;AAChB,UAAI,KAAKsB,WAAT,EAAsB,OAAO,UAAP;AACtB,UAAI,KAAKrB,OAAT,EAAkB,OAAO,QAAP;AAClB,aAAO,SAAP;AACD,KANqD;AAOtDmB,IAAAA,UAAU,EAAE,KAP0C;AAQtDC,IAAAA,YAAY,EAAE;AARwC,GAAxD;AAUAP,EAAAA,MAAM,CAACC,cAAP,CAAsBnB,SAAS,CAACoB,SAAhC,EAA2C,OAA3C,EAAoD;AAClD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACIC,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,UAAIM,KAAK,GAAG,IAAZ;;AAEA,UAAI,CAAC,KAAKC,YAAV,EAAwB;AACtB,YAAI,KAAK1B,QAAL,CAAc2B,sBAAd,CAAqCC,OAArC,CAA6C,IAA7C,MAAuD,CAAC,CAA5D,EAA+D;AAC7D,eAAK5B,QAAL,CAAc2B,sBAAd,CAAqCE,IAArC,CAA0C,IAA1C;AACD;;AAED,aAAKH,YAAL,GAAoB,IAAII,OAAJ,CAAY,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;AACzDP,UAAAA,KAAK,CAACQ,mBAAN,GAA4B,YAAY;AACtCF,YAAAA,OAAO,CAACN,KAAD,CAAP;AACD,WAFD;;AAIAA,UAAAA,KAAK,CAACS,kBAAN,GAA2B,YAAY;AACrCF,YAAAA,MAAM,CAAC,IAAIG,KAAJ,EAAD,CAAN;AACD,WAFD;AAGD,SARmB,CAApB;;AAUA,YAAI,CAAC,KAAKC,OAAV,EAAmB;AACjB,eAAKH,mBAAL;AACD;AACF;;AAED,aAAO,KAAKP,YAAZ;AACD,KAnCiD;AAoClDJ,IAAAA,UAAU,EAAE,KApCsC;AAqClDC,IAAAA,YAAY,EAAE;AArCoC,GAApD;AAuCAP,EAAAA,MAAM,CAACC,cAAP,CAAsBnB,SAAS,CAACoB,SAAhC,EAA2C,UAA3C,EAAuD;AACrD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACIC,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,UAAIM,KAAK,GAAG,IAAZ;;AAEA,UAAI,CAAC,KAAKY,eAAV,EAA2B;AACzB,YAAI,KAAKrC,QAAL,CAAc2B,sBAAd,CAAqCC,OAArC,CAA6C,IAA7C,MAAuD,CAAC,CAA5D,EAA+D;AAC7D,eAAK5B,QAAL,CAAc2B,sBAAd,CAAqCE,IAArC,CAA0C,IAA1C;AACD;;AAED,aAAKQ,eAAL,GAAuB,IAAIP,OAAJ,CAAY,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;AAC5DP,UAAAA,KAAK,CAACa,sBAAN,GAA+B,YAAY;AACzCP,YAAAA,OAAO,CAACN,KAAD,CAAP;AACD,WAFD;;AAIAA,UAAAA,KAAK,CAACc,qBAAN,GAA8B,YAAY;AACxCP,YAAAA,MAAM,CAAC,IAAIG,KAAJ,EAAD,CAAN;AACD,WAFD;AAGD,SARsB,CAAvB;;AAUA,YAAI,KAAKK,SAAL,KAAmB,UAAvB,EAAmC;AACjC,eAAKF,sBAAL;AACD;AACF;;AAED,aAAO,KAAKD,eAAZ;AACD,KAxCoD;AAyCrDf,IAAAA,UAAU,EAAE,KAzCyC;AA0CrDC,IAAAA,YAAY,EAAE;AA1CuC,GAAvD;AA4CAP,EAAAA,MAAM,CAACC,cAAP,CAAsBnB,SAAS,CAACoB,SAAhC,EAA2C,aAA3C,EAA0D;AACxD;AACJ;AACA;AACIC,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,WAAKJ,cAAL;AACA,aAAO,KAAKb,KAAL,IAAc,KAAKD,kBAAnB,GAAwC,IAAxC,GAA+C,KAAKI,YAA3D;AACD,KAPuD;AAQxDoC,IAAAA,GAAG,EAAE,SAASA,GAAT,CAAaC,OAAb,EAAsB;AACzB,UAAIC,EAAJ;;AAEAD,MAAAA,OAAO,GAAGE,MAAM,CAACF,OAAD,CAAhB;AACA,UAAIG,KAAK,CAACH,OAAD,CAAT,EAAoB;AACpB,WAAK1C,QAAL,CAAc8C,OAAd;;AAEA,UAAI,CAAC,KAAK3C,OAAN,IAAiB,KAAKiB,UAAL,KAAoB,IAAzC,EAA+C;AAC7C,aAAKA,UAAL,GAAkBwB,MAAM,CAAC,CAACD,EAAE,GAAG,KAAK3C,QAAX,MAAyB,IAAzB,IAAiC2C,EAAE,KAAK,KAAK,CAA7C,GAAiD,KAAK,CAAtD,GAA0DA,EAAE,CAACI,WAA9D,CAAN,GAAmFL,OAAO,GAAG,KAAKrB,YAApH;AACD;;AAED,WAAKpB,kBAAL,GAA0B,KAA1B;;AAEA,UAAI,KAAKI,YAAL,KAAsBqC,OAA1B,EAAmC;AACjC;AACD;;AAED,UAAI,KAAKxC,KAAT,EAAgB;AACd,aAAKA,KAAL,GAAa,KAAb;AACA,aAAKC,OAAL,GAAe,IAAf;AACD;;AAED,WAAK6C,eAAL,CAAqBN,OAArB,EAA8B,IAA9B;AACA,WAAK1C,QAAL,CAAciD,qBAAd,CAAoC,IAApC;AACD,KAhCuD;AAiCxD3B,IAAAA,UAAU,EAAE,KAjC4C;AAkCxDC,IAAAA,YAAY,EAAE;AAlC0C,GAA1D;AAoCAP,EAAAA,MAAM,CAACC,cAAP,CAAsBnB,SAAS,CAACoB,SAAhC,EAA2C,WAA3C,EAAwD;AACtDC,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAO,KAAKC,UAAZ;AACD,KAHqD;AAItDqB,IAAAA,GAAG,EAAE,SAASA,GAAT,CAAaC,OAAb,EAAsB;AACzB,UAAIA,OAAO,KAAK,IAAhB,EAAsB;AACpB,aAAK3B,cAAL;AACA2B,QAAAA,OAAO,GAAGE,MAAM,CAACF,OAAD,CAAhB;AACA,YAAIG,KAAK,CAACH,OAAD,CAAT,EAAoB;AACpB,YAAI,KAAKvC,OAAL,IAAgB,KAAKD,KAAzB,EAAgC;AAChC,aAAKkB,UAAL,GAAkBsB,OAAlB;AACA,aAAKM,eAAL,CAAqB,CAACJ,MAAM,CAAC,KAAK5C,QAAL,CAAc+C,WAAf,CAAN,GAAoC,KAAK3B,UAA1C,IAAwD,KAAKC,YAAlF;AACA,aAAKrB,QAAL,CAAciD,qBAAd,CAAoC,IAApC;AACA,aAAKlC,cAAL;AACD;AACF,KAfqD;AAgBtDO,IAAAA,UAAU,EAAE,KAhB0C;AAiBtDC,IAAAA,YAAY,EAAE;AAjBwC,GAAxD;AAmBAP,EAAAA,MAAM,CAACC,cAAP,CAAsBnB,SAAS,CAACoB,SAAhC,EAA2C,cAA3C,EAA2D;AACzDC,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAO,KAAKb,aAAZ;AACD,KAHwD;AAIzDmC,IAAAA,GAAG,EAAE,SAASA,GAAT,CAAaS,KAAb,EAAoB;AACvB,UAAIA,KAAK,KAAK,KAAK5C,aAAnB,EAAkC;AAChC;AACD;;AAED,WAAKS,cAAL;AACA,UAAIoC,cAAc,GAAG,KAAKJ,WAA1B;AACA,WAAKzC,aAAL,GAAqB4C,KAArB;AACA,WAAKE,SAAL,GAAiB,IAAjB;;AAEA,UAAI,KAAKZ,SAAL,KAAmB,QAAnB,IAA+B,KAAKA,SAAL,KAAmB,MAAtD,EAA8D;AAC5D,aAAKpC,aAAL,GAAqB,KAArB;AACA,aAAKF,KAAL,GAAa,KAAb;AACA,aAAKmD,WAAL;AACA,aAAKrD,QAAL,CAAciD,qBAAd,CAAoC,IAApC;AACD;;AAED,UAAIE,cAAc,KAAK,IAAvB,EAA6B;AAC3B,aAAKJ,WAAL,GAAmBI,cAAnB;AACD;;AAED,WAAKpC,cAAL;AACD,KA1BwD;AA2BzDO,IAAAA,UAAU,EAAE,KA3B6C;AA4BzDC,IAAAA,YAAY,EAAE;AA5B2C,GAA3D;AA8BAP,EAAAA,MAAM,CAACC,cAAP,CAAsBnB,SAAS,CAACoB,SAAhC,EAA2C,aAA3C,EAA0D;AACxDC,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAO,CAAC,KAAKjB,KAAN,KAAgB,KAAKI,aAAL,GAAqB,CAArB,IAA0BsC,MAAM,CAAC,KAAKvC,YAAN,CAAN,IAA6B,KAAKiD,aAA5D,IAA6E,KAAKhD,aAAL,GAAqB,CAArB,IAA0BsC,MAAM,CAAC,KAAKvC,YAAN,CAAN,IAA6B,CAApJ,CAAP;AACD,KAHuD;AAIxDiB,IAAAA,UAAU,EAAE,KAJ4C;AAKxDC,IAAAA,YAAY,EAAE;AAL0C,GAA1D;AAOAP,EAAAA,MAAM,CAACC,cAAP,CAAsBnB,SAAS,CAACoB,SAAhC,EAA2C,eAA3C,EAA4D;AAC1DC,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,UAAIwB,EAAJ;;AAEA,aAAOC,MAAM,CAAC,CAACD,EAAE,GAAG,KAAK5C,MAAX,MAAuB,IAAvB,IAA+B4C,EAAE,KAAK,KAAK,CAA3C,GAA+C,KAAK,CAApD,GAAwDA,EAAE,CAACY,iBAAH,GAAuBC,OAAhF,CAAb;AACD,KALyD;AAM1DlC,IAAAA,UAAU,EAAE,KAN8C;AAO1DC,IAAAA,YAAY,EAAE;AAP4C,GAA5D;AASAP,EAAAA,MAAM,CAACC,cAAP,CAAsBnB,SAAS,CAACoB,SAAhC,EAA2C,YAA3C,EAAyD;AACvDC,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AAClB,aAAO,KAAKiB,OAAL,IAAgB,KAAKI,SAAL,KAAmB,SAAnC,IAAgD,CAAC,KAAKpC,aAA7D;AACD,KAHsD;AAIvDkB,IAAAA,UAAU,EAAE,KAJ2C;AAKvDC,IAAAA,YAAY,EAAE;AALyC,GAAzD;AAOA;AACF;AACA;AACA;;AAEEzB,EAAAA,SAAS,CAACoB,SAAV,CAAoBH,cAApB,GAAqC,YAAY;AAC/C,QAAID,YAAY,GAAG,KAAKA,YAAxB;AACA,QAAI2C,YAAY,GAAG,KAAKrB,OAAL,GAAe,SAAf,GAA2B,KAAKI,SAAnD;;AAEA,QAAI,KAAKd,YAAL,IAAqB+B,YAAY,KAAK3C,YAA1C,EAAwD;AACtD,UAAI2C,YAAY,KAAK,MAArB,EAA6B;AAC3B,aAAKvB,kBAAL;AACA,aAAKR,YAAL,GAAoBgC,SAApB;AACD,OAHD,MAGO,IAAI5C,YAAY,KAAK,SAArB,EAAgC;AACrC,aAAKmB,mBAAL;AACD,OAFM,MAEA,IAAIwB,YAAY,KAAK,SAArB,EAAgC;AACrC,aAAK/B,YAAL,GAAoBgC,SAApB;AACD;AACF;;AAED,QAAI,KAAKrB,eAAL,IAAwBoB,YAAY,KAAK3C,YAA7C,EAA2D;AACzD,UAAI2C,YAAY,KAAK,MAArB,EAA6B;AAC3B,aAAKlB,qBAAL;AACA,aAAKF,eAAL,GAAuBqB,SAAvB;AACD,OAHD,MAGO,IAAID,YAAY,KAAK,UAArB,EAAiC;AACtC,aAAKnB,sBAAL;AACD,OAFM,MAEA,IAAIxB,YAAY,KAAK,UAArB,EAAiC;AACtC,aAAKuB,eAAL,GAAuBqB,SAAvB;AACD;AACF;;AAED,SAAK5C,YAAL,GAAoB2C,YAApB;AACA,WAAO,KAAK/B,YAAL,IAAqB,KAAKW,eAAjC;AACD,GA5BD;;AA8BAvC,EAAAA,SAAS,CAACoB,SAAV,CAAoByC,IAApB,GAA2B,YAAY;AACrC,SAAK5C,cAAL;AACA,SAAKZ,OAAL,GAAe,KAAf;;AAEA,QAAI,KAAKqB,WAAL,IAAoB,KAAKtB,KAA7B,EAAoC;AAClC,WAAK0D,MAAL;AACA,WAAKxC,UAAL,GAAkB,IAAlB;AACD;;AAED,SAAKhB,aAAL,GAAqB,KAArB;AACA,SAAKF,KAAL,GAAa,KAAb;AACA,SAAKmD,WAAL;AACA,SAAKrD,QAAL,CAAciD,qBAAd,CAAoC,IAApC;;AAEA,QAAI,KAAKjD,QAAL,CAAc6D,UAAd,CAAyBjC,OAAzB,CAAiC,IAAjC,MAA2C,CAAC,CAAhD,EAAmD;AACjD,WAAK5B,QAAL,CAAc6D,UAAd,CAAyBhC,IAAzB,CAA8B,IAA9B;AACD;;AAED,SAAKd,cAAL;AACD,GAnBD;;AAqBAjB,EAAAA,SAAS,CAACoB,SAAV,CAAoB4C,KAApB,GAA4B,YAAY;AACtC,SAAK/C,cAAL;;AAEA,QAAI,KAAKgC,WAAT,EAAsB;AACpB,WAAKlC,SAAL,GAAiB,KAAKkC,WAAtB;AACD;;AAED,QAAI,CAAC,KAAKvB,WAAN,IAAqB,CAAC,KAAKrB,OAA3B,IAAsC,CAAC,KAAKD,KAAhD,EAAuD;AACrD,WAAKD,kBAAL,GAA0B,IAA1B;AACD,KAFD,MAEO,IAAI,KAAKC,KAAT,EAAgB;AACrB,WAAK0D,MAAL;AACA,WAAK1D,KAAL,GAAa,KAAb;AACD;;AAED,SAAKkB,UAAL,GAAkB,IAAlB;AACA,SAAKjB,OAAL,GAAe,IAAf;AACA,SAAKY,cAAL;AACD,GAjBD;;AAmBAjB,EAAAA,SAAS,CAACoB,SAAV,CAAoB6C,MAApB,GAA6B,YAAY;AACvC,SAAKhD,cAAL;AACA,QAAI,KAAKb,KAAT,EAAgB;AAChB,SAAK6C,WAAL,GAAmB,KAAKzC,aAAL,GAAqB,CAArB,GAAyB,KAAKgD,aAA9B,GAA8C,CAAjE;AACA,SAAKlC,UAAL,GAAkB,KAAKkC,aAAL,GAAqB,KAAKP,WAA5C;AACA,SAAK9C,kBAAL,GAA0B,KAA1B;AACA,SAAKD,QAAL,CAAciD,qBAAd,CAAoC,IAApC;AACA,SAAKlC,cAAL;AACD,GARD;;AAUAjB,EAAAA,SAAS,CAACoB,SAAV,CAAoB8C,MAApB,GAA6B,YAAY;AACvC,SAAKjD,cAAL;AACA,QAAI,CAAC,KAAKJ,SAAV,EAAqB;AACrB,SAAKA,SAAL,GAAiB,KAAjB;AACA,SAAKT,KAAL,GAAa,IAAb;AACA,SAAKC,OAAL,GAAe,KAAf;AACA,SAAKC,aAAL,GAAqB,IAArB;AACA,SAAKC,YAAL,GAAoB,CAApB;AACA,SAAKe,UAAL,GAAkB,IAAlB;AACA,SAAKrB,MAAL,CAAYa,MAAZ,CAAmB,IAAnB,EATuC,CASb;AAC1B;;AAEA,SAAKZ,QAAL,CAAciD,qBAAd,CAAoC,IAApC;AACA,SAAKlC,cAAL;AACD,GAdD;;AAgBAjB,EAAAA,SAAS,CAACoB,SAAV,CAAoB+C,OAApB,GAA8B,YAAY;AACxC,SAAKlD,cAAL;AACA,QAAIoC,cAAc,GAAG,KAAKJ,WAA1B;AACA,SAAK1B,YAAL,IAAqB,CAAC,CAAtB;AACA,SAAKsC,IAAL;;AAEA,QAAIR,cAAc,KAAK,IAAvB,EAA6B;AAC3B,WAAKJ,WAAL,GAAmBI,cAAnB;AACD;;AAED,SAAKpC,cAAL;AACD,GAXD;AAYA;AACF;AACA;;;AAGEjB,EAAAA,SAAS,CAACoB,SAAV,CAAoBgD,kBAApB,GAAyC,UAAU7C,YAAV,EAAwB;AAC/D,SAAKA,YAAL,GAAoBA,YAApB;AACD,GAFD;;AAIAvB,EAAAA,SAAS,CAACoB,SAAV,CAAoBiD,gBAApB,GAAuC,YAAY;AACjD,QAAIxB,EAAJ;;AAEA,QAAIyB,MAAM,GAAG,CAACzB,EAAE,GAAG,KAAK5C,MAAX,MAAuB,IAAvB,IAA+B4C,EAAE,KAAK,KAAK,CAA3C,GAA+C,KAAK,CAApD,GAAwDA,EAAE,CAACyB,MAAxE;AACA,WAAOA,MAAM,CAACC,aAAP,EAAP;AACD,GALD;;AAOAvE,EAAAA,SAAS,CAACoB,SAAV,CAAoBoD,UAApB,GAAiC,YAAY;AAC3C,QAAIT,UAAU,GAAG,KAAKM,gBAAL,EAAjB;;AAEA,QAAIN,UAAU,CAACjC,OAAX,CAAmB,IAAnB,MAA6B,CAAC,CAAlC,EAAqC;AACnCiC,MAAAA,UAAU,CAAChC,IAAX,CAAgB,IAAhB;AACD;AACF,GAND;;AAQA/B,EAAAA,SAAS,CAACoB,SAAV,CAAoBqD,YAApB,GAAmC,YAAY;AAC7C,QAAIV,UAAU,GAAG,KAAKM,gBAAL,EAAjB;AACA,QAAIK,KAAK,GAAGX,UAAU,CAACjC,OAAX,CAAmB,IAAnB,CAAZ;;AAEA,QAAI4C,KAAK,KAAK,CAAC,CAAf,EAAkB;AAChBX,MAAAA,UAAU,CAACY,MAAX,CAAkBD,KAAlB,EAAyB,CAAzB;AACD;AACF,GAPD;;AASA1E,EAAAA,SAAS,CAACoB,SAAV,CAAoBwD,IAApB,GAA2B,UAAUC,YAAV,EAAwBC,gBAAxB,EAA0C;AACnE,QAAI,CAAC,KAAK1E,KAAN,IAAe,CAAC,KAAKC,OAAzB,EAAkC;AAChC,UAAI,KAAKiB,UAAL,KAAoB,IAAxB,EAA8B;AAC5B,YAAIwD,gBAAJ,EAAsB;AACpB,eAAKxB,SAAL,GAAiBuB,YAAY,GAAG,KAAKtE,YAAL,GAAoB,KAAKgB,YAAzD;AACD;AACF,OAJD,MAIO,IAAI,CAAC,KAAKG,WAAV,EAAuB;AAC5B,aAAKwB,eAAL,CAAqB,CAAC2B,YAAY,GAAG,KAAKvD,UAArB,IAAmC,KAAKC,YAA7D;AACD;AACF;;AAED,QAAIuD,gBAAJ,EAAsB;AACpB,WAAK3E,kBAAL,GAA0B,KAA1B;AACA,WAAK4E,UAAL,CAAgBF,YAAhB;AACD;AACF,GAfD;;AAiBA7E,EAAAA,SAAS,CAACoB,SAAV,CAAoB0C,MAApB,GAA6B,YAAY;AACvC,QAAI,KAAKvC,YAAL,IAAqB,CAAzB,EAA4B;AAC1B,WAAK0B,WAAL,GAAmB,CAAnB;AACD,KAFD,MAEO,IAAI,KAAKO,aAAL,GAAqBwB,QAAzB,EAAmC;AACxC,WAAK/B,WAAL,GAAmB,KAAKO,aAAxB;AACD,KAFM,MAEA;AACL,YAAM,IAAInB,KAAJ,CAAU,0EAAV,CAAN;AACD;AACF,GARD;;AAUArC,EAAAA,SAAS,CAACoB,SAAV,CAAoB6D,OAApB,GAA8B,YAAY;AACxC,UAAM,IAAI5C,KAAJ,CAAU,yBAAV,CAAN;AACD,GAFD,CA3ZU,CA6ZP;;;AAGHrC,EAAAA,SAAS,CAACoB,SAAV,CAAoB8D,gBAApB,GAAuC,UAAUC,IAAV,EAAgBC,QAAhB,EAA0BC,OAA1B,EAAmC;AACxE,UAAM,IAAIhD,KAAJ,CAAU,yBAAV,CAAN;AACD,GAFD,CAhaU,CAkaP;;;AAGHrC,EAAAA,SAAS,CAACoB,SAAV,CAAoBkE,mBAApB,GAA0C,UAAUH,IAAV,EAAgBC,QAAhB,EAA0BC,OAA1B,EAAmC;AAC3E,UAAM,IAAIhD,KAAJ,CAAU,yBAAV,CAAN;AACD,GAFD,CAraU,CAuaP;;;AAGHrC,EAAAA,SAAS,CAACoB,SAAV,CAAoBmE,aAApB,GAAoC,UAAUC,KAAV,EAAiB;AACnD,UAAM,IAAInD,KAAJ,CAAU,yBAAV,CAAN;AACD,GAFD,CA1aU,CA4aP;;;AAGHrC,EAAAA,SAAS,CAACoB,SAAV,CAAoBqE,YAApB,GAAmC,YAAY;AAC7C,UAAM,IAAIpD,KAAJ,CAAU,yBAAV,CAAN;AACD,GAFD;;AAIArC,EAAAA,SAAS,CAACoB,SAAV,CAAoBmC,WAApB,GAAkC,YAAY;AAC5C,QAAIV,EAAJ,EAAQ6C,EAAR,CAD4C,CAChC;AACZ;AACA;;;AAGA,QAAI,KAAKnE,YAAL,GAAoB,CAApB,IAAyB,KAAK0B,WAAL,KAAqB,CAAlD,EAAqD;AACnD,WAAKpC,SAAL,GAAiB,CAAC,EAAE,CAACgC,EAAE,GAAG,KAAK5C,MAAX,MAAuB,IAAvB,IAA+B4C,EAAE,KAAK,KAAK,CAA3C,GAA+C,KAAK,CAApD,GAAwDA,EAAE,CAAC/B,MAAH,CAAU,CAAC,CAAX,CAA1D,CAAlB;AACD,KAFD,MAEO;AACL,WAAKD,SAAL,GAAiB,CAAC,EAAE,CAAC6E,EAAE,GAAG,KAAKzF,MAAX,MAAuB,IAAvB,IAA+ByF,EAAE,KAAK,KAAK,CAA3C,GAA+C,KAAK,CAApD,GAAwDA,EAAE,CAAC5E,MAAH,CAAU,KAAKmC,WAAf,CAA1D,CAAlB;AACD;;AAED,QAAI,CAAC,KAAKxC,WAAN,KAAsB,KAAKI,SAAL,IAAkB,CAAC,KAAKP,aAA9C,CAAJ,EAAkE;AAChE,WAAKG,WAAL,GAAmB,IAAnB;AACA,WAAKP,QAAL,CAAc6D,UAAd,CAAyBhC,IAAzB,CAA8B,IAA9B;AACD;AACF,GAhBD;;AAkBA/B,EAAAA,SAAS,CAACoB,SAAV,CAAoB8B,eAApB,GAAsC,UAAUN,OAAV,EAAmB+C,WAAnB,EAAgC;AACpE,QAAI/C,OAAO,KAAK,KAAKrC,YAArB,EAAmC;AACjC,WAAKA,YAAL,GAAoBqC,OAApB;;AAEA,UAAI,KAAKlB,WAAL,IAAoB,CAACiE,WAAzB,EAAsC;AACpC,aAAKpF,YAAL,GAAoB,KAAKC,aAAL,GAAqB,CAArB,GAAyB,KAAKgD,aAA9B,GAA8C,CAAlE;AACD;;AAED,WAAKD,WAAL;AACD;AACF,GAVD;;AAYAvD,EAAAA,SAAS,CAACoB,SAAV,CAAoB2D,UAApB,GAAiC,UAAUa,QAAV,EAAoB;AACnD,QAAIjE,KAAK,GAAG,IAAZ;;AAEA,QAAI,KAAKD,WAAT,EAAsB;AACpB,UAAI,CAAC,KAAKpB,aAAV,EAAyB;AACvB,YAAI,KAAKuF,QAAT,EAAmB;AACjB,cAAIC,OAAO,GAAG,IAAIhG,cAAJ,CAAmB,IAAnB,EAAyB,IAAzB,EAA+B,KAAKmD,WAApC,EAAiD2C,QAAjD,CAAd;AACAG,UAAAA,UAAU,CAAC,YAAY;AACrB,gBAAIpE,KAAK,CAACkE,QAAV,EAAoB;AAClBlE,cAAAA,KAAK,CAACkE,QAAN,CAAeC,OAAf;AACD;AACF,WAJS,CAAV;AAKD;;AAED,aAAKxF,aAAL,GAAqB,IAArB;AACD;AACF,KAbD,MAaO;AACL,UAAI,KAAK0F,OAAL,IAAgB,KAAKtD,SAAL,KAAmB,SAAvC,EAAkD;AAChD,YAAIuD,OAAO,GAAG,IAAInG,cAAJ,CAAmB,IAAnB,EAAyB,IAAzB,EAA+B,KAAKmD,WAApC,EAAiD2C,QAAjD,CAAd;AACA,aAAKI,OAAL,CAAaC,OAAb;AACD;;AAED,WAAK3F,aAAL,GAAqB,KAArB;AACD;AACF,GAxBD;;AA0BA,SAAON,SAAP;AACD,CA5eD,EAFA;;AAgfA,SAASA,SAAT","sourcesContent":["import { AnimationEvent } from './AnimationEvent';\nvar sequenceNumber = 0;\n/**\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Animation/Animation\n */\n\nvar Animation =\n/** @class */\nfunction () {\n  function Animation(effect, timeline) {\n    this.currentTimePending = false;\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Animation/playState\n     */\n    // playState: AnimationPlayState;\n\n    this._idle = true;\n    this._paused = false;\n    this._finishedFlag = true;\n    this._currentTime = 0;\n    this._playbackRate = 1;\n    this._inTimeline = true;\n    this.effect = effect;\n    effect.animation = this;\n    this.timeline = timeline;\n    this.id = \"\".concat(sequenceNumber++);\n    this._inEffect = !!this.effect.update(0);\n    this._holdTime = 0;\n    this._paused = false;\n    this.oldPlayState = 'idle';\n    this.updatePromises();\n  }\n\n  Object.defineProperty(Animation.prototype, \"pending\", {\n    // animation: InternalAnimation | null;\n\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Animation/pending\n     */\n    get: function get() {\n      return this._startTime === null && !this._paused && this.playbackRate !== 0 || this.currentTimePending;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Animation.prototype, \"playState\", {\n    get: function get() {\n      if (this._idle) return 'idle';\n      if (this._isFinished) return 'finished';\n      if (this._paused) return 'paused';\n      return 'running';\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Animation.prototype, \"ready\", {\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Animation/ready\n     * @example\n      animation.pause();\n      animation.ready.then(function() {\n        // Displays 'running'\n        alert(animation.playState);\n      });\n      animation.play();\n     */\n    get: function get() {\n      var _this = this;\n\n      if (!this.readyPromise) {\n        if (this.timeline.animationsWithPromises.indexOf(this) === -1) {\n          this.timeline.animationsWithPromises.push(this);\n        }\n\n        this.readyPromise = new Promise(function (resolve, reject) {\n          _this.resolveReadyPromise = function () {\n            resolve(_this);\n          };\n\n          _this.rejectReadyPromise = function () {\n            reject(new Error());\n          };\n        });\n\n        if (!this.pending) {\n          this.resolveReadyPromise();\n        }\n      }\n\n      return this.readyPromise;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Animation.prototype, \"finished\", {\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Animation/finished\n     * @example\n      Promise.all(\n        elem.getAnimations().map(\n          function(animation) {\n            return animation.finished\n          }\n        )\n      ).then(\n        function() {\n          return elem.remove();\n        }\n      );\n     */\n    get: function get() {\n      var _this = this;\n\n      if (!this.finishedPromise) {\n        if (this.timeline.animationsWithPromises.indexOf(this) === -1) {\n          this.timeline.animationsWithPromises.push(this);\n        }\n\n        this.finishedPromise = new Promise(function (resolve, reject) {\n          _this.resolveFinishedPromise = function () {\n            resolve(_this);\n          };\n\n          _this.rejectFinishedPromise = function () {\n            reject(new Error());\n          };\n        });\n\n        if (this.playState === 'finished') {\n          this.resolveFinishedPromise();\n        }\n      }\n\n      return this.finishedPromise;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Animation.prototype, \"currentTime\", {\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Animation/currentTime\n     */\n    get: function get() {\n      this.updatePromises();\n      return this._idle || this.currentTimePending ? null : this._currentTime;\n    },\n    set: function set(newTime) {\n      var _a;\n\n      newTime = Number(newTime);\n      if (isNaN(newTime)) return;\n      this.timeline.restart();\n\n      if (!this._paused && this._startTime !== null) {\n        this._startTime = Number((_a = this.timeline) === null || _a === void 0 ? void 0 : _a.currentTime) - newTime / this.playbackRate;\n      }\n\n      this.currentTimePending = false;\n\n      if (this._currentTime === newTime) {\n        return;\n      }\n\n      if (this._idle) {\n        this._idle = false;\n        this._paused = true;\n      }\n\n      this.tickCurrentTime(newTime, true);\n      this.timeline.applyDirtiedAnimation(this);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Animation.prototype, \"startTime\", {\n    get: function get() {\n      return this._startTime;\n    },\n    set: function set(newTime) {\n      if (newTime !== null) {\n        this.updatePromises();\n        newTime = Number(newTime);\n        if (isNaN(newTime)) return;\n        if (this._paused || this._idle) return;\n        this._startTime = newTime;\n        this.tickCurrentTime((Number(this.timeline.currentTime) - this._startTime) * this.playbackRate);\n        this.timeline.applyDirtiedAnimation(this);\n        this.updatePromises();\n      }\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Animation.prototype, \"playbackRate\", {\n    get: function get() {\n      return this._playbackRate;\n    },\n    set: function set(value) {\n      if (value === this._playbackRate) {\n        return;\n      }\n\n      this.updatePromises();\n      var oldCurrentTime = this.currentTime;\n      this._playbackRate = value;\n      this.startTime = null;\n\n      if (this.playState !== 'paused' && this.playState !== 'idle') {\n        this._finishedFlag = false;\n        this._idle = false;\n        this.ensureAlive();\n        this.timeline.applyDirtiedAnimation(this);\n      }\n\n      if (oldCurrentTime !== null) {\n        this.currentTime = oldCurrentTime;\n      }\n\n      this.updatePromises();\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Animation.prototype, \"_isFinished\", {\n    get: function get() {\n      return !this._idle && (this._playbackRate > 0 && Number(this._currentTime) >= this.totalDuration || this._playbackRate < 0 && Number(this._currentTime) <= 0);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Animation.prototype, \"totalDuration\", {\n    get: function get() {\n      var _a;\n\n      return Number((_a = this.effect) === null || _a === void 0 ? void 0 : _a.getComputedTiming().endTime);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Animation.prototype, \"_needsTick\", {\n    get: function get() {\n      return this.pending || this.playState === 'running' || !this._finishedFlag;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\n   * state machine,\n   * resolve/reject ready/finished Promise according to current state\n   */\n\n  Animation.prototype.updatePromises = function () {\n    var oldPlayState = this.oldPlayState;\n    var newPlayState = this.pending ? 'pending' : this.playState;\n\n    if (this.readyPromise && newPlayState !== oldPlayState) {\n      if (newPlayState === 'idle') {\n        this.rejectReadyPromise();\n        this.readyPromise = undefined;\n      } else if (oldPlayState === 'pending') {\n        this.resolveReadyPromise();\n      } else if (newPlayState === 'pending') {\n        this.readyPromise = undefined;\n      }\n    }\n\n    if (this.finishedPromise && newPlayState !== oldPlayState) {\n      if (newPlayState === 'idle') {\n        this.rejectFinishedPromise();\n        this.finishedPromise = undefined;\n      } else if (newPlayState === 'finished') {\n        this.resolveFinishedPromise();\n      } else if (oldPlayState === 'finished') {\n        this.finishedPromise = undefined;\n      }\n    }\n\n    this.oldPlayState = newPlayState;\n    return this.readyPromise || this.finishedPromise;\n  };\n\n  Animation.prototype.play = function () {\n    this.updatePromises();\n    this._paused = false;\n\n    if (this._isFinished || this._idle) {\n      this.rewind();\n      this._startTime = null;\n    }\n\n    this._finishedFlag = false;\n    this._idle = false;\n    this.ensureAlive();\n    this.timeline.applyDirtiedAnimation(this);\n\n    if (this.timeline.animations.indexOf(this) === -1) {\n      this.timeline.animations.push(this);\n    }\n\n    this.updatePromises();\n  };\n\n  Animation.prototype.pause = function () {\n    this.updatePromises();\n\n    if (this.currentTime) {\n      this._holdTime = this.currentTime;\n    }\n\n    if (!this._isFinished && !this._paused && !this._idle) {\n      this.currentTimePending = true;\n    } else if (this._idle) {\n      this.rewind();\n      this._idle = false;\n    }\n\n    this._startTime = null;\n    this._paused = true;\n    this.updatePromises();\n  };\n\n  Animation.prototype.finish = function () {\n    this.updatePromises();\n    if (this._idle) return;\n    this.currentTime = this._playbackRate > 0 ? this.totalDuration : 0;\n    this._startTime = this.totalDuration - this.currentTime;\n    this.currentTimePending = false;\n    this.timeline.applyDirtiedAnimation(this);\n    this.updatePromises();\n  };\n\n  Animation.prototype.cancel = function () {\n    this.updatePromises();\n    if (!this._inEffect) return;\n    this._inEffect = false;\n    this._idle = true;\n    this._paused = false;\n    this._finishedFlag = true;\n    this._currentTime = 0;\n    this._startTime = null;\n    this.effect.update(null); // effects are invalid after cancellation as the animation state\n    // needs to un-apply.\n\n    this.timeline.applyDirtiedAnimation(this);\n    this.updatePromises();\n  };\n\n  Animation.prototype.reverse = function () {\n    this.updatePromises();\n    var oldCurrentTime = this.currentTime;\n    this.playbackRate *= -1;\n    this.play();\n\n    if (oldCurrentTime !== null) {\n      this.currentTime = oldCurrentTime;\n    }\n\n    this.updatePromises();\n  };\n  /**\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/Animation/updatePlaybackRate\n   */\n\n\n  Animation.prototype.updatePlaybackRate = function (playbackRate) {\n    this.playbackRate = playbackRate;\n  };\n\n  Animation.prototype.targetAnimations = function () {\n    var _a;\n\n    var target = (_a = this.effect) === null || _a === void 0 ? void 0 : _a.target;\n    return target.getAnimations();\n  };\n\n  Animation.prototype.markTarget = function () {\n    var animations = this.targetAnimations();\n\n    if (animations.indexOf(this) === -1) {\n      animations.push(this);\n    }\n  };\n\n  Animation.prototype.unmarkTarget = function () {\n    var animations = this.targetAnimations();\n    var index = animations.indexOf(this);\n\n    if (index !== -1) {\n      animations.splice(index, 1);\n    }\n  };\n\n  Animation.prototype.tick = function (timelineTime, isAnimationFrame) {\n    if (!this._idle && !this._paused) {\n      if (this._startTime === null) {\n        if (isAnimationFrame) {\n          this.startTime = timelineTime - this._currentTime / this.playbackRate;\n        }\n      } else if (!this._isFinished) {\n        this.tickCurrentTime((timelineTime - this._startTime) * this.playbackRate);\n      }\n    }\n\n    if (isAnimationFrame) {\n      this.currentTimePending = false;\n      this.fireEvents(timelineTime);\n    }\n  };\n\n  Animation.prototype.rewind = function () {\n    if (this.playbackRate >= 0) {\n      this.currentTime = 0;\n    } else if (this.totalDuration < Infinity) {\n      this.currentTime = this.totalDuration;\n    } else {\n      throw new Error('Unable to rewind negative playback rate animation with infinite duration');\n    }\n  };\n\n  Animation.prototype.persist = function () {\n    throw new Error('Method not implemented.');\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  Animation.prototype.addEventListener = function (type, listener, options) {\n    throw new Error('Method not implemented.');\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  Animation.prototype.removeEventListener = function (type, listener, options) {\n    throw new Error('Method not implemented.');\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  Animation.prototype.dispatchEvent = function (event) {\n    throw new Error('Method not implemented.');\n  }; // replaceState: AnimationReplaceState;\n\n\n  Animation.prototype.commitStyles = function () {\n    throw new Error('Method not implemented.');\n  };\n\n  Animation.prototype.ensureAlive = function () {\n    var _a, _b; // If an animation is playing backwards and is not fill backwards/both\n    // then it should go out of effect when it reaches the start of its\n    // active interval (currentTime === 0).\n\n\n    if (this.playbackRate < 0 && this.currentTime === 0) {\n      this._inEffect = !!((_a = this.effect) === null || _a === void 0 ? void 0 : _a.update(-1));\n    } else {\n      this._inEffect = !!((_b = this.effect) === null || _b === void 0 ? void 0 : _b.update(this.currentTime));\n    }\n\n    if (!this._inTimeline && (this._inEffect || !this._finishedFlag)) {\n      this._inTimeline = true;\n      this.timeline.animations.push(this);\n    }\n  };\n\n  Animation.prototype.tickCurrentTime = function (newTime, ignoreLimit) {\n    if (newTime !== this._currentTime) {\n      this._currentTime = newTime;\n\n      if (this._isFinished && !ignoreLimit) {\n        this._currentTime = this._playbackRate > 0 ? this.totalDuration : 0;\n      }\n\n      this.ensureAlive();\n    }\n  };\n\n  Animation.prototype.fireEvents = function (baseTime) {\n    var _this = this;\n\n    if (this._isFinished) {\n      if (!this._finishedFlag) {\n        if (this.onfinish) {\n          var event_1 = new AnimationEvent(null, this, this.currentTime, baseTime);\n          setTimeout(function () {\n            if (_this.onfinish) {\n              _this.onfinish(event_1);\n            }\n          });\n        }\n\n        this._finishedFlag = true;\n      }\n    } else {\n      if (this.onframe && this.playState === 'running') {\n        var event_2 = new AnimationEvent(null, this, this.currentTime, baseTime);\n        this.onframe(event_2);\n      }\n\n      this._finishedFlag = false;\n    }\n  };\n\n  return Animation;\n}();\n\nexport { Animation };"]},"metadata":{},"sourceType":"module"}