{"ast":null,"code":"import { __decorate, __metadata } from \"tslib\";\nimport { CanvasConfig, ContextService, isBrowser } from '@antv/g';\nimport { inject, singleton } from 'mana-syringe';\nimport { isString } from 'lodash-es';\nimport { setDOMSize } from './utils/dom';\n\nvar Canvas2DContextService =\n/** @class */\nfunction () {\n  function Canvas2DContextService() {}\n\n  Canvas2DContextService.prototype.init = function () {\n    var _a = this.canvasConfig,\n        container = _a.container,\n        canvas = _a.canvas,\n        devicePixelRatio = _a.devicePixelRatio;\n\n    if (canvas) {\n      this.$canvas = canvas;\n\n      if (container && canvas.parentElement !== container) {\n        container.appendChild(canvas);\n      }\n\n      this.$container = canvas.parentElement;\n      this.canvasConfig.container = this.$container;\n    } else if (container) {\n      // create container\n      this.$container = isString(container) ? document.getElementById(container) : container;\n\n      if (this.$container) {\n        // create canvas\n        var $canvas = document.createElement('canvas');\n        this.$container.appendChild($canvas);\n\n        if (!this.$container.style.position) {\n          this.$container.style.position = 'relative';\n        }\n\n        this.$canvas = $canvas;\n      }\n    }\n\n    this.context = this.$canvas.getContext('2d'); // use user-defined dpr first\n\n    var dpr = devicePixelRatio || isBrowser && window.devicePixelRatio || 1;\n    dpr = dpr >= 1 ? Math.ceil(dpr) : 1;\n    this.dpr = dpr;\n    this.resize(this.canvasConfig.width, this.canvasConfig.height);\n  };\n\n  Canvas2DContextService.prototype.getContext = function () {\n    return this.context;\n  };\n\n  Canvas2DContextService.prototype.getDomElement = function () {\n    return this.$canvas;\n  };\n\n  Canvas2DContextService.prototype.getDPR = function () {\n    return this.dpr;\n  };\n\n  Canvas2DContextService.prototype.getBoundingClientRect = function () {\n    if (this.$canvas.getBoundingClientRect) {\n      return this.$canvas.getBoundingClientRect();\n    }\n  };\n\n  Canvas2DContextService.prototype.destroy = function () {\n    // @ts-ignore\n    if (this.$container && this.$canvas && this.$canvas.parentNode) {\n      // destroy context\n      // @ts-ignore\n      this.$container.removeChild(this.$canvas);\n    }\n  };\n\n  Canvas2DContextService.prototype.resize = function (width, height) {\n    if (this.$canvas) {\n      // set canvas width & height\n      this.$canvas.width = this.dpr * width;\n      this.$canvas.height = this.dpr * height; // set CSS style width & height\n\n      setDOMSize(this.$canvas, width, height);\n      var dpr = this.getDPR(); // scale all drawing operations by the dpr\n      // @see https://www.html5rocks.com/en/tutorials/canvas/hidpi/\n\n      this.context.scale(dpr, dpr);\n    }\n  };\n\n  Canvas2DContextService.prototype.applyCursorStyle = function (cursor) {\n    if (this.$container && this.$container.style) {\n      this.$container.style.cursor = cursor;\n    }\n  };\n\n  __decorate([inject(CanvasConfig), __metadata(\"design:type\", Object)], Canvas2DContextService.prototype, \"canvasConfig\", void 0);\n\n  Canvas2DContextService = __decorate([singleton({\n    token: ContextService\n  })], Canvas2DContextService);\n  return Canvas2DContextService;\n}();\n\nexport { Canvas2DContextService };","map":{"version":3,"sources":["/Users/dennis.zhang/Desktop/其它代码库/moa-flow/node_modules/@antv/g-canvas/es/Canvas2DContextService.js"],"names":["__decorate","__metadata","CanvasConfig","ContextService","isBrowser","inject","singleton","isString","setDOMSize","Canvas2DContextService","prototype","init","_a","canvasConfig","container","canvas","devicePixelRatio","$canvas","parentElement","appendChild","$container","document","getElementById","createElement","style","position","context","getContext","dpr","window","Math","ceil","resize","width","height","getDomElement","getDPR","getBoundingClientRect","destroy","parentNode","removeChild","scale","applyCursorStyle","cursor","Object","token"],"mappings":"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","sourcesContent":["import { __decorate, __metadata } from \"tslib\";\nimport { CanvasConfig, ContextService, isBrowser } from '@antv/g';\nimport { inject, singleton } from 'mana-syringe';\nimport { isString } from 'lodash-es';\nimport { setDOMSize } from './utils/dom';\n\nvar Canvas2DContextService =\n/** @class */\nfunction () {\n  function Canvas2DContextService() {}\n\n  Canvas2DContextService.prototype.init = function () {\n    var _a = this.canvasConfig,\n        container = _a.container,\n        canvas = _a.canvas,\n        devicePixelRatio = _a.devicePixelRatio;\n\n    if (canvas) {\n      this.$canvas = canvas;\n\n      if (container && canvas.parentElement !== container) {\n        container.appendChild(canvas);\n      }\n\n      this.$container = canvas.parentElement;\n      this.canvasConfig.container = this.$container;\n    } else if (container) {\n      // create container\n      this.$container = isString(container) ? document.getElementById(container) : container;\n\n      if (this.$container) {\n        // create canvas\n        var $canvas = document.createElement('canvas');\n        this.$container.appendChild($canvas);\n\n        if (!this.$container.style.position) {\n          this.$container.style.position = 'relative';\n        }\n\n        this.$canvas = $canvas;\n      }\n    }\n\n    this.context = this.$canvas.getContext('2d'); // use user-defined dpr first\n\n    var dpr = devicePixelRatio || isBrowser && window.devicePixelRatio || 1;\n    dpr = dpr >= 1 ? Math.ceil(dpr) : 1;\n    this.dpr = dpr;\n    this.resize(this.canvasConfig.width, this.canvasConfig.height);\n  };\n\n  Canvas2DContextService.prototype.getContext = function () {\n    return this.context;\n  };\n\n  Canvas2DContextService.prototype.getDomElement = function () {\n    return this.$canvas;\n  };\n\n  Canvas2DContextService.prototype.getDPR = function () {\n    return this.dpr;\n  };\n\n  Canvas2DContextService.prototype.getBoundingClientRect = function () {\n    if (this.$canvas.getBoundingClientRect) {\n      return this.$canvas.getBoundingClientRect();\n    }\n  };\n\n  Canvas2DContextService.prototype.destroy = function () {\n    // @ts-ignore\n    if (this.$container && this.$canvas && this.$canvas.parentNode) {\n      // destroy context\n      // @ts-ignore\n      this.$container.removeChild(this.$canvas);\n    }\n  };\n\n  Canvas2DContextService.prototype.resize = function (width, height) {\n    if (this.$canvas) {\n      // set canvas width & height\n      this.$canvas.width = this.dpr * width;\n      this.$canvas.height = this.dpr * height; // set CSS style width & height\n\n      setDOMSize(this.$canvas, width, height);\n      var dpr = this.getDPR(); // scale all drawing operations by the dpr\n      // @see https://www.html5rocks.com/en/tutorials/canvas/hidpi/\n\n      this.context.scale(dpr, dpr);\n    }\n  };\n\n  Canvas2DContextService.prototype.applyCursorStyle = function (cursor) {\n    if (this.$container && this.$container.style) {\n      this.$container.style.cursor = cursor;\n    }\n  };\n\n  __decorate([inject(CanvasConfig), __metadata(\"design:type\", Object)], Canvas2DContextService.prototype, \"canvasConfig\", void 0);\n\n  Canvas2DContextService = __decorate([singleton({\n    token: ContextService\n  })], Canvas2DContextService);\n  return Canvas2DContextService;\n}();\n\nexport { Canvas2DContextService };"]},"metadata":{},"sourceType":"module"}