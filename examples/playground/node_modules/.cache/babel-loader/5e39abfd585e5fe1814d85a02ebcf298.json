{"ast":null,"code":"import { __decorate, __read } from \"tslib\";\nimport { GradientPatternType } from '@antv/g';\nimport { singleton } from 'mana-syringe';\n\nvar GradientPool =\n/** @class */\nfunction () {\n  function GradientPool() {\n    this.gradientCache = {};\n  }\n\n  GradientPool.prototype.getOrCreateGradient = function (params, context) {\n    var key = this.generateCacheKey(params);\n    var type = params.type,\n        x0 = params.x0,\n        y0 = params.y0,\n        x1 = params.x1,\n        y1 = params.y1,\n        steps = params.steps,\n        width = params.width,\n        height = params.height;\n\n    if (this.gradientCache[key]) {\n      return this.gradientCache[key];\n    }\n\n    var gradient = null;\n\n    if (type === GradientPatternType.LinearGradient) {\n      // @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/createLinearGradient\n      gradient = context.createLinearGradient(x0 * width, y0 * height, x1 * width, y1 * height);\n    } else if (type === GradientPatternType.RadialGradient) {\n      var r = Math.sqrt(width * width + height * height) / 2; // @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/createRadialGradient\n\n      gradient = context.createRadialGradient(x0 * width, y0 * height, 0, x1 * width, y1 * height, params.r1 * r);\n    }\n\n    if (gradient) {\n      steps.forEach(function (_a) {\n        var _b = __read(_a, 2),\n            offset = _b[0],\n            color = _b[1];\n\n        gradient === null || gradient === void 0 ? void 0 : gradient.addColorStop(Number(offset), color);\n      });\n      this.gradientCache[key] = gradient;\n    }\n\n    return this.gradientCache[key];\n  };\n\n  GradientPool.prototype.generateCacheKey = function (params) {\n    // @ts-ignore\n    var type = params.type,\n        x0 = params.x0,\n        y0 = params.y0,\n        x1 = params.x1,\n        y1 = params.y1,\n        r1 = params.r1,\n        steps = params.steps,\n        width = params.width,\n        height = params.height;\n    return \"gradient-\".concat(type, \"-\").concat(x0, \"-\").concat(y0, \"-\").concat(x1, \"-\").concat(y1, \"-\").concat(r1 || 0, \"-\").concat(width, \"-\").concat(height, \"-\").concat(steps.map(function (step) {\n      return step.join('');\n    }).join('-'));\n  };\n\n  GradientPool = __decorate([singleton()], GradientPool);\n  return GradientPool;\n}();\n\nexport { GradientPool };","map":{"version":3,"sources":["/Users/dennis.zhang/Desktop/其它代码库/moa-flow/node_modules/@antv/g-plugin-canvas-renderer/es/shapes/GradientPool.js"],"names":["__decorate","__read","GradientPatternType","singleton","GradientPool","gradientCache","prototype","getOrCreateGradient","params","context","key","generateCacheKey","type","x0","y0","x1","y1","steps","width","height","gradient","LinearGradient","createLinearGradient","RadialGradient","r","Math","sqrt","createRadialGradient","r1","forEach","_a","_b","offset","color","addColorStop","Number","concat","map","step","join"],"mappings":"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","sourcesContent":["import { __decorate, __read } from \"tslib\";\nimport { GradientPatternType } from '@antv/g';\nimport { singleton } from 'mana-syringe';\n\nvar GradientPool =\n/** @class */\nfunction () {\n  function GradientPool() {\n    this.gradientCache = {};\n  }\n\n  GradientPool.prototype.getOrCreateGradient = function (params, context) {\n    var key = this.generateCacheKey(params);\n    var type = params.type,\n        x0 = params.x0,\n        y0 = params.y0,\n        x1 = params.x1,\n        y1 = params.y1,\n        steps = params.steps,\n        width = params.width,\n        height = params.height;\n\n    if (this.gradientCache[key]) {\n      return this.gradientCache[key];\n    }\n\n    var gradient = null;\n\n    if (type === GradientPatternType.LinearGradient) {\n      // @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/createLinearGradient\n      gradient = context.createLinearGradient(x0 * width, y0 * height, x1 * width, y1 * height);\n    } else if (type === GradientPatternType.RadialGradient) {\n      var r = Math.sqrt(width * width + height * height) / 2; // @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/createRadialGradient\n\n      gradient = context.createRadialGradient(x0 * width, y0 * height, 0, x1 * width, y1 * height, params.r1 * r);\n    }\n\n    if (gradient) {\n      steps.forEach(function (_a) {\n        var _b = __read(_a, 2),\n            offset = _b[0],\n            color = _b[1];\n\n        gradient === null || gradient === void 0 ? void 0 : gradient.addColorStop(Number(offset), color);\n      });\n      this.gradientCache[key] = gradient;\n    }\n\n    return this.gradientCache[key];\n  };\n\n  GradientPool.prototype.generateCacheKey = function (params) {\n    // @ts-ignore\n    var type = params.type,\n        x0 = params.x0,\n        y0 = params.y0,\n        x1 = params.x1,\n        y1 = params.y1,\n        r1 = params.r1,\n        steps = params.steps,\n        width = params.width,\n        height = params.height;\n    return \"gradient-\".concat(type, \"-\").concat(x0, \"-\").concat(y0, \"-\").concat(x1, \"-\").concat(y1, \"-\").concat(r1 || 0, \"-\").concat(width, \"-\").concat(height, \"-\").concat(steps.map(function (step) {\n      return step.join('');\n    }).join('-'));\n  };\n\n  GradientPool = __decorate([singleton()], GradientPool);\n  return GradientPool;\n}();\n\nexport { GradientPool };"]},"metadata":{},"sourceType":"module"}