{"ast":null,"code":"import { __decorate, __metadata, __read, __spreadArray } from \"tslib\";\nimport { postConstruct, singleton, GlobalContainer } from 'mana-syringe';\nimport { vec3 } from 'gl-matrix';\nimport { dirtifyToRoot, GeometryUpdaterFactory } from '../services';\nimport { ElementEvent } from '../dom';\nimport { Shape } from '../types';\nimport { CSSKeywordValue, CSSStyleValue, CSSUnitValue } from './cssom';\nimport { convertPercentUnit } from './parser';\nimport { CSSPropertyLocalPosition, CSSPropertyOpacity, CSSPropertyColor, CSSPropertyFilter, CSSPropertyLengthOrPercentage, CSSPropertyLineDash, CSSPropertyShadowBlur, CSSPropertyOffsetPath, CSSPropertyOffsetDistance, CSSPropertyAnchor, CSSPropertyZIndex, CSSPropertyTransform, CSSPropertyTransformOrigin, CSSPropertyPath, CSSPropertyClipPath, CSSPropertyPoints, CSSPropertyText, CSSPropertyTextTransform } from './properties';\nimport { formatAttribute } from '../utils';\nimport { AABB } from '../shapes';\nexport var PropertySyntax = {\n  COLOR: '<color>',\n  PAINT: '<paint>',\n  NUMBER: '<number>',\n  LENGTH: '<length>',\n  PERCENTAGE: '<percentage>',\n  LENGTH_PERCENTAGE: '<length> | <percentage>'\n};\n/**\n * Blink used them in code generation(css_properties.json5)\n */\n\nexport var BUILT_IN_PROPERTIES = [{\n  /**\n   * used in CSS Layout API\n   * eg. `display: 'flex'`\n   */\n  name: 'display',\n  keywords: ['none']\n}, {\n  // x in local space\n  name: 'x',\n  interpolable: true,\n  alias: ['cx'],\n  defaultValue: '0',\n  syntax: PropertySyntax.LENGTH_PERCENTAGE,\n  handler: CSSPropertyLocalPosition\n}, {\n  // y in local space\n  name: 'y',\n  interpolable: true,\n  alias: ['cy'],\n  defaultValue: '0',\n  syntax: PropertySyntax.LENGTH_PERCENTAGE,\n  handler: CSSPropertyLocalPosition\n}, {\n  // z in local space\n  name: 'z',\n  interpolable: true,\n  defaultValue: '0',\n  syntax: PropertySyntax.LENGTH_PERCENTAGE,\n  handler: CSSPropertyLocalPosition\n}, {\n  /**\n   * range [0.0, 1.0]\n   * @see https://developer.mozilla.org/en-US/docs/Web/CSS/opacity\n   */\n  name: 'opacity',\n  interpolable: true,\n  defaultValue: '1',\n  syntax: PropertySyntax.NUMBER,\n  handler: CSSPropertyOpacity\n}, {\n  /**\n   * range [0.0, 1.0]\n   * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/fill-opacity\n   */\n  name: 'fillOpacity',\n  interpolable: true,\n  inherited: true,\n  defaultValue: '1',\n  syntax: PropertySyntax.NUMBER,\n  handler: CSSPropertyOpacity\n}, {\n  /**\n   * range [0.0, 1.0]\n   * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-opacity\n   */\n  name: 'strokeOpacity',\n  interpolable: true,\n  inherited: true,\n  defaultValue: '1',\n  syntax: PropertySyntax.NUMBER,\n  handler: CSSPropertyOpacity\n}, {\n  /**\n   * background-color is not inheritable\n   * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Fills_and_Strokes\n   */\n  name: 'fill',\n  interpolable: true,\n  keywords: ['none'],\n  defaultValue: 'none',\n  syntax: PropertySyntax.PAINT,\n  handler: CSSPropertyColor\n}, {\n  name: 'stroke',\n  interpolable: true,\n  keywords: ['none'],\n  defaultValue: 'none',\n  syntax: PropertySyntax.PAINT,\n  handler: CSSPropertyColor\n}, {\n  name: 'shadowColor',\n  interpolable: true,\n  syntax: PropertySyntax.COLOR,\n  handler: CSSPropertyColor\n}, {\n  name: 'shadowOffsetX',\n  interpolable: true,\n  layoutDependent: true,\n  syntax: PropertySyntax.LENGTH_PERCENTAGE,\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'shadowOffsetY',\n  interpolable: true,\n  layoutDependent: true,\n  syntax: PropertySyntax.LENGTH_PERCENTAGE,\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'shadowBlur',\n  interpolable: true,\n  layoutDependent: true,\n  handler: CSSPropertyShadowBlur\n}, {\n  /**\n   * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-width\n   */\n  name: 'lineWidth',\n  interpolable: true,\n  inherited: true,\n  defaultValue: '1',\n  layoutDependent: true,\n  alias: ['strokeWidth'],\n  syntax: PropertySyntax.LENGTH_PERCENTAGE,\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'lineJoin',\n  inherited: true,\n  layoutDependent: true,\n  alias: ['strokeLinejoin'],\n  keywords: ['miter', 'bevel', 'round'],\n  defaultValue: 'miter'\n}, {\n  name: 'lineCap',\n  inherited: true,\n  layoutDependent: true,\n  alias: ['strokeLinecap'],\n  keywords: ['butt', 'round', 'square'],\n  defaultValue: 'butt'\n}, {\n  name: 'lineDash',\n  interpolable: true,\n  inherited: true,\n  keywords: ['none'],\n  alias: ['strokeDasharray'],\n  handler: CSSPropertyLineDash\n}, {\n  name: 'lineDashOffset',\n  interpolable: true,\n  inherited: true,\n  defaultValue: '0',\n  alias: ['strokeDashoffset'],\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'offsetPath',\n  handler: CSSPropertyOffsetPath\n}, {\n  name: 'offsetDistance',\n  interpolable: true,\n  handler: CSSPropertyOffsetDistance\n}, {\n  name: 'dx',\n  interpolable: true,\n  layoutDependent: true,\n  defaultValue: '0',\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'dy',\n  interpolable: true,\n  layoutDependent: true,\n  defaultValue: '0',\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'zIndex',\n  independent: true,\n  interpolable: true,\n  defaultValue: '0',\n  keywords: ['auto'],\n  handler: CSSPropertyZIndex\n}, {\n  name: 'visibility',\n  keywords: ['visible', 'hidden'],\n  independent: true,\n  inherited: true,\n\n  /**\n   * TODO: support interpolation\n   * @see https://developer.mozilla.org/en-US/docs/Web/CSS/visibility#interpolation\n   */\n  // interpolable: true,\n  defaultValue: 'visible'\n}, {\n  name: 'pointerEvents',\n  inherited: true,\n  keywords: ['none', 'auto', 'stroke', 'fill', 'painted', 'visible', 'visiblestroke', 'visiblefill', 'visiblepainted', 'bounding-box', 'all'],\n  defaultValue: 'auto'\n}, {\n  name: 'filter',\n  independent: true,\n  layoutDependent: true,\n  handler: CSSPropertyFilter\n}, {\n  name: 'clipPath',\n  handler: CSSPropertyClipPath\n}, {\n  name: 'transform',\n  interpolable: true,\n  keywords: ['none'],\n  defaultValue: 'none',\n  handler: CSSPropertyTransform\n}, {\n  name: 'transformOrigin',\n  parsePriority: 100,\n  // interpolable: true,\n  defaultValue: 'left top',\n  layoutDependent: true,\n  handler: CSSPropertyTransformOrigin\n}, {\n  name: 'anchor',\n  parsePriority: 99,\n  layoutDependent: true,\n  handler: CSSPropertyAnchor\n}, // Circle\n{\n  name: 'r',\n  interpolable: true,\n  layoutDependent: true,\n  defaultValue: '0',\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'rx',\n  interpolable: true,\n  layoutDependent: true,\n  defaultValue: 'auto',\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'ry',\n  interpolable: true,\n  layoutDependent: true,\n  defaultValue: 'auto',\n  handler: CSSPropertyLengthOrPercentage\n}, // Rect Image\n{\n  name: 'width',\n  interpolable: true,\n  layoutDependent: true,\n\n  /**\n   * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/width\n   */\n  keywords: ['auto', 'fit-content', 'min-content', 'max-content'],\n  defaultValue: '0',\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'height',\n  interpolable: true,\n  layoutDependent: true,\n\n  /**\n   * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/height\n   */\n  keywords: ['auto', 'fit-content', 'min-content', 'max-content'],\n  defaultValue: '0',\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'radius',\n  interpolable: true,\n  layoutDependent: true,\n  defaultValue: '0',\n  handler: CSSPropertyLengthOrPercentage\n}, // Line\n{\n  name: 'x1',\n  interpolable: true,\n  layoutDependent: true,\n  handler: CSSPropertyLocalPosition\n}, {\n  name: 'y1',\n  interpolable: true,\n  layoutDependent: true,\n  handler: CSSPropertyLocalPosition\n}, {\n  name: 'z1',\n  interpolable: true,\n  layoutDependent: true,\n  handler: CSSPropertyLocalPosition\n}, {\n  name: 'x2',\n  interpolable: true,\n  layoutDependent: true,\n  handler: CSSPropertyLocalPosition\n}, {\n  name: 'y2',\n  interpolable: true,\n  layoutDependent: true,\n  handler: CSSPropertyLocalPosition\n}, {\n  name: 'z2',\n  interpolable: true,\n  layoutDependent: true,\n  handler: CSSPropertyLocalPosition\n}, // Path\n{\n  name: 'path',\n  interpolable: true,\n  layoutDependent: true,\n  defaultValue: '',\n  handler: CSSPropertyPath\n}, // Polyline\n{\n  name: 'points',\n  layoutDependent: true,\n  handler: CSSPropertyPoints\n}, // Text\n{\n  name: 'text',\n  layoutDependent: true,\n  handler: CSSPropertyText,\n  defaultValue: ''\n}, {\n  name: 'textTransform',\n  layoutDependent: true,\n  inherited: true,\n  keywords: ['capitalize', 'uppercase', 'lowercase', 'none'],\n  defaultValue: 'none',\n  handler: CSSPropertyTextTransform\n}, {\n  name: 'font',\n  layoutDependent: true\n}, {\n  name: 'fontSize',\n  interpolable: true,\n  inherited: true,\n\n  /**\n   * @see https://www.w3schools.com/css/css_font_size.asp\n   */\n  defaultValue: '16px',\n  layoutDependent: true,\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'fontFamily',\n  layoutDependent: true,\n  inherited: true,\n  defaultValue: 'sans-serif'\n}, {\n  name: 'fontStyle',\n  layoutDependent: true,\n  inherited: true,\n  keywords: ['normal', 'italic', 'oblique'],\n  defaultValue: 'normal'\n}, {\n  name: 'fontWeight',\n  layoutDependent: true,\n  inherited: true,\n  keywords: ['normal', 'bold', 'bolder', 'lighter'],\n  defaultValue: 'normal'\n}, {\n  name: 'fontVariant',\n  layoutDependent: true,\n  inherited: true,\n  keywords: ['normal', 'small-caps'],\n  defaultValue: 'normal'\n}, {\n  name: 'lineHeight',\n  layoutDependent: true // interpolable: true,\n  // inherited: true,\n  // defaultValue: '-100%'\n\n}, {\n  name: 'letterSpacing',\n  layoutDependent: true // interpolable: true,\n  // inherited: true,\n  // defaultValue: '0',\n\n}, {\n  name: 'wordWrap',\n  layoutDependent: true\n}, {\n  name: 'wordWrapWidth',\n  layoutDependent: true\n}, {\n  name: 'leading',\n  layoutDependent: true\n}, {\n  name: 'textBaseline',\n  layoutDependent: true,\n  inherited: true,\n  keywords: ['top', 'hanging', 'middle', 'alphabetic', 'ideographic', 'bottom'],\n  defaultValue: 'alphabetic'\n}, {\n  name: 'textAlign',\n  layoutDependent: true,\n  inherited: true,\n  keywords: ['start', 'center', 'end', 'left', 'right'],\n  defaultValue: 'start'\n}, {\n  name: 'whiteSpace',\n  layoutDependent: true\n}];\n\nvar StyleValueRegistry =\n/** @class */\nfunction () {\n  function StyleValueRegistry() {\n    /**\n     * need recalc later\n     */\n    this.dirty = false;\n    this.cache = {};\n    this.unresolvedProperties = {};\n    /**\n     * eg.\n     *\n     * document: {\n     *   fontSize: [\n     *\n     *   ]\n     * }\n     */\n\n    this.cascadeProperties = {};\n  } // private boundsChangeListeners: Record<\n  //   /**\n  //    * parent's entity\n  //    */\n  //   number,\n  //   Record<\n  //     /**\n  //      * child's entity\n  //      */\n  //     number,\n  //     /**\n  //      * child properties\n  //      */\n  //     string[]\n  //   >\n  // > = {};\n\n\n  StyleValueRegistry.prototype.init = function () {\n    var _this = this;\n\n    BUILT_IN_PROPERTIES.forEach(function (property) {\n      _this.registerMetadata(property);\n    });\n  };\n\n  StyleValueRegistry.prototype.registerMetadata = function (metadata) {\n    var _this = this;\n\n    __spreadArray([metadata.name], __read(metadata.alias || []), false).forEach(function (name) {\n      _this.cache[name] = metadata;\n    });\n  };\n\n  StyleValueRegistry.prototype.getMetadata = function (name) {\n    return this.cache[name];\n  };\n  /**\n   * * parse value, eg.\n   * fill: 'red' => CSSRGB\n   * translateX: '10px' => CSSUnitValue { unit: 'px', value: 10 }\n   * fontSize: '2em' => { unit: 'px', value: 32 }\n   *\n   * * calculate used value\n   * * post process\n   */\n\n\n  StyleValueRegistry.prototype.processProperties = function (object, attributes, options) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = {\n        skipUpdateAttribute: false,\n        skipParse: false\n      };\n    }\n\n    var skipUpdateAttribute = options.skipUpdateAttribute,\n        skipParse = options.skipParse;\n    var needUpdateGeometry = false;\n    Object.keys(attributes).forEach(function (attributeName) {\n      var _a;\n\n      var _b = __read(formatAttribute(attributeName, attributes[attributeName]), 2),\n          name = _b[0],\n          value = _b[1];\n\n      if (!skipUpdateAttribute) {\n        object.attributes[name] = value;\n      }\n\n      if (!needUpdateGeometry && ((_a = _this.getMetadata(name)) === null || _a === void 0 ? void 0 : _a.layoutDependent)) {\n        needUpdateGeometry = true;\n      }\n    }); // parse according to priority\n\n    var sortedNames = Object.keys(attributes).sort(function (a, b) {\n      var _a, _b;\n\n      return (((_a = _this.getMetadata(a)) === null || _a === void 0 ? void 0 : _a.parsePriority) || 0) - (((_b = _this.getMetadata(b)) === null || _b === void 0 ? void 0 : _b.parsePriority) || 0);\n    });\n\n    if (!skipParse) {\n      sortedNames.forEach(function (name) {\n        object.computedStyle[name] = _this.parseProperty(name, object.attributes[name]);\n      });\n    }\n\n    var hasUnresolvedProperties = false;\n    sortedNames.forEach(function (name) {\n      // some style props maybe deleted after parsing such as `anchor` in Text\n      if (name in object.computedStyle) {\n        hasUnresolvedProperties = _this.computeProperty(name, object.computedStyle[name], object);\n      }\n    });\n\n    if (hasUnresolvedProperties) {\n      this.dirty = true;\n      return;\n    } // update geometry\n\n\n    if (needUpdateGeometry) {\n      this.updateGeometry(object);\n    }\n\n    sortedNames.forEach(function (name) {\n      if (name in object.parsedStyle) {\n        _this.postProcessProperty(name, object);\n      }\n    });\n    sortedNames.forEach(function (name) {\n      if (name in object.parsedStyle && _this.isPropertyInheritable(name)) {\n        // update children's inheritable\n        object.children.forEach(function (child) {\n          child.internalSetAttribute(name, null, {\n            skipUpdateAttribute: true,\n            skipParse: true\n          });\n        });\n      }\n    });\n  };\n  /**\n   * string -> parsed value\n   */\n\n\n  StyleValueRegistry.prototype.parseProperty = function (name, value) {\n    var metadata = this.getMetadata(name);\n    var computed = value;\n\n    if (value === '') {\n      value = 'unset';\n    }\n\n    if (value === 'unset' || value === 'initial' || value === 'inherit') {\n      computed = new CSSKeywordValue(value);\n    } else {\n      if (metadata) {\n        var keywords = metadata.keywords,\n            handler = metadata.handler; // use keywords\n\n        if (keywords && keywords.indexOf(value) > -1) {\n          computed = new CSSKeywordValue(value);\n        } else if (handler) {\n          // try to parse value with handler\n          var propertyHandler = GlobalContainer.get(handler);\n\n          if (propertyHandler && propertyHandler.parser) {\n            // try to parse it to CSSStyleValue, eg. '10px' -> CSS.px(10)\n            computed = propertyHandler.parser(value);\n          }\n        }\n      }\n    }\n\n    return computed;\n  };\n  /**\n   * computed value -> used value\n   */\n\n\n  StyleValueRegistry.prototype.computeProperty = function (name, computed, object) {\n    var metadata = this.getMetadata(name);\n    var isDocumentElement = object.id === 'g-root';\n    var used = computed instanceof CSSStyleValue ? computed.clone() : computed;\n\n    if (metadata) {\n      var handler = metadata.handler,\n          inherited = metadata.inherited,\n          defaultValue = metadata.defaultValue;\n\n      if (computed instanceof CSSKeywordValue) {\n        var value = computed.value;\n        /**\n         * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/unset\n         */\n\n        if (value === 'unset') {\n          if (inherited && !isDocumentElement) {\n            value = 'inherit';\n          } else {\n            value = 'initial';\n          }\n        }\n\n        if (value === 'initial') {\n          // @see https://developer.mozilla.org/en-US/docs/Web/CSS/initial\n          if (defaultValue) {\n            computed = this.parseProperty(name, defaultValue);\n          }\n        } else if (value === 'inherit') {\n          // @see https://developer.mozilla.org/en-US/docs/Web/CSS/inherit\n          // behave like `inherit`\n          var resolved = this.tryToResolveProperty(object, name, {\n            inherited: true\n          });\n\n          if (resolved) {\n            object.parsedStyle[name] = resolved;\n            return false;\n          } else {\n            this.addUnresolveProperty(object, name);\n            return true;\n          }\n        }\n      }\n\n      if (handler) {\n        var propertyHandler = GlobalContainer.get(handler); // convert computed value to used value\n\n        if (propertyHandler && propertyHandler.calculator) {\n          var oldParsedValue = object.parsedStyle[name];\n          used = propertyHandler.calculator(name, oldParsedValue, computed, object, this);\n        } else {\n          used = computed;\n        }\n      } else {\n        used = computed;\n      }\n    }\n\n    object.parsedStyle[name] = used;\n    return false;\n  };\n\n  StyleValueRegistry.prototype.postProcessProperty = function (name, object) {\n    var metadata = this.getMetadata(name);\n\n    if (metadata && metadata.handler) {\n      var propertyHandler = GlobalContainer.get(metadata.handler);\n\n      if (propertyHandler && propertyHandler.postProcessor) {\n        propertyHandler.postProcessor(object);\n      }\n    }\n  };\n\n  StyleValueRegistry.prototype.isPropertyResolved = function (object, name) {\n    if (!this.unresolvedProperties[object.entity] || this.unresolvedProperties[object.entity].length === 0) {\n      return true;\n    }\n\n    return this.unresolvedProperties[object.entity].includes(name);\n  };\n  /**\n   * resolve later\n   */\n\n\n  StyleValueRegistry.prototype.addUnresolveProperty = function (object, name) {\n    if (!this.unresolvedProperties[object.entity]) {\n      this.unresolvedProperties[object.entity] = [];\n    }\n\n    if (this.unresolvedProperties[object.entity].indexOf(name) === -1) {\n      this.unresolvedProperties[object.entity].push(name);\n    }\n  };\n\n  StyleValueRegistry.prototype.tryToResolveProperty = function (object, name, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var inherited = options.inherited;\n\n    if (inherited) {\n      if (object.parentElement && this.isPropertyResolved(object.parentElement, name)) {\n        var usedValue = object.parentElement.parsedStyle[name];\n\n        if (usedValue instanceof CSSKeywordValue && (usedValue.value === 'unset' || usedValue.value === 'initial' || usedValue.value === 'inherit')) {\n          return false;\n        } else if (usedValue instanceof CSSUnitValue && CSSUnitValue.isRelativeUnit(usedValue.unit)) {\n          return false;\n        }\n\n        return usedValue;\n      }\n    }\n\n    return false;\n  };\n\n  StyleValueRegistry.prototype.recalc = function (object) {\n    var properties = this.unresolvedProperties[object.entity];\n\n    if (properties && properties.length) {\n      var attributes_1 = {};\n      properties.forEach(function (property) {\n        attributes_1[property] = object.attributes[property];\n      });\n      this.processProperties(object, attributes_1);\n      delete this.unresolvedProperties[object.entity];\n    }\n  };\n  /**\n   * update geometry when relative props changed,\n   * eg. r of Circle, width/height of Rect\n   */\n\n\n  StyleValueRegistry.prototype.updateGeometry = function (object) {\n    var _a;\n\n    var geometryUpdaterFactory = GlobalContainer.get(GeometryUpdaterFactory);\n    var geometryUpdater = geometryUpdaterFactory(object.nodeName);\n\n    if (geometryUpdater) {\n      var geometry_1 = object.geometry;\n\n      if (!geometry_1.contentBounds) {\n        geometry_1.contentBounds = new AABB();\n      }\n\n      if (!geometry_1.renderBounds) {\n        geometry_1.renderBounds = new AABB();\n      }\n\n      var parsedStyle = object.parsedStyle;\n\n      var _b = geometryUpdater.update(parsedStyle, object),\n          width = _b.width,\n          height = _b.height,\n          _c = _b.depth,\n          depth = _c === void 0 ? 0 : _c,\n          _d = _b.x,\n          x = _d === void 0 ? 0 : _d,\n          _e = _b.y,\n          y = _e === void 0 ? 0 : _e,\n          // z = 0,\n      _f = _b.offsetX,\n          // z = 0,\n      offsetX = _f === void 0 ? 0 : _f,\n          _g = _b.offsetY,\n          offsetY = _g === void 0 ? 0 : _g,\n          _h = _b.offsetZ,\n          offsetZ = _h === void 0 ? 0 : _h;\n\n      if (object.nodeName === Shape.LINE || object.nodeName === Shape.POLYLINE || object.nodeName === Shape.POLYGON || object.nodeName === Shape.PATH) {\n        parsedStyle.offsetX = x - (parsedStyle.defX || 0);\n        parsedStyle.offsetY = y - (parsedStyle.defY || 0);\n        parsedStyle.defX = x;\n        parsedStyle.defY = y; // modify x/y/z\n\n        object.attributes.x += parsedStyle.offsetX;\n        object.attributes.y += parsedStyle.offsetY;\n        parsedStyle.x = parsedStyle.x.add(new CSSUnitValue(parsedStyle.offsetX, 'px'));\n        parsedStyle.y = parsedStyle.y.add(new CSSUnitValue(parsedStyle.offsetY, 'px'));\n      } // init with content box\n\n\n      var halfExtents = vec3.fromValues(width / 2, height / 2, depth / 2); // anchor is center by default, don't account for lineWidth here\n\n      var _j = parsedStyle,\n          lineWidth = _j.lineWidth,\n          shadowColor = _j.shadowColor,\n          _k = _j.filter,\n          filter = _k === void 0 ? [] : _k,\n          transformOrigin = _j.transformOrigin;\n      var anchor = parsedStyle.anchor; // <Text> use textAlign & textBaseline instead of anchor\n\n      if (object.nodeName === Shape.TEXT) {\n        delete parsedStyle.anchor;\n      }\n\n      var center = vec3.fromValues((1 - (anchor && anchor[0].value || 0) * 2) * halfExtents[0] + offsetX, (1 - (anchor && anchor[1].value || 0) * 2) * halfExtents[1] + offsetY, (1 - (anchor && ((_a = anchor[2]) === null || _a === void 0 ? void 0 : _a.value) || 0) * 2) * halfExtents[2] + offsetZ); // update geometry's AABB\n\n      geometry_1.contentBounds.update(center, halfExtents);\n\n      if (lineWidth) {\n        // append border\n        vec3.add(halfExtents, halfExtents, vec3.fromValues(lineWidth.value / 2, lineWidth.value / 2, 0));\n      }\n\n      geometry_1.renderBounds.update(center, halfExtents); // account for shadow, only support constant value now\n\n      if (shadowColor) {\n        var _l = geometry_1.renderBounds,\n            min = _l.min,\n            max = _l.max;\n        var _m = parsedStyle,\n            shadowBlur = _m.shadowBlur,\n            shadowOffsetX = _m.shadowOffsetX,\n            shadowOffsetY = _m.shadowOffsetY;\n        var shadowBlurInPixels = shadowBlur && shadowBlur.value || 0;\n        var shadowOffsetXInPixels = shadowOffsetX && shadowOffsetX.value || 0;\n        var shadowOffsetYInPixels = shadowOffsetY && shadowOffsetY.value || 0;\n        var shadowLeft = min[0] - shadowBlurInPixels + shadowOffsetXInPixels;\n        var shadowRight = max[0] + shadowBlurInPixels + shadowOffsetXInPixels;\n        var shadowTop = min[1] - shadowBlurInPixels + shadowOffsetYInPixels;\n        var shadowBottom = max[1] + shadowBlurInPixels + shadowOffsetYInPixels;\n        min[0] = Math.min(min[0], shadowLeft);\n        max[0] = Math.max(max[0], shadowRight);\n        min[1] = Math.min(min[1], shadowTop);\n        max[1] = Math.max(max[1], shadowBottom);\n        geometry_1.renderBounds.setMinMax(min, max);\n      } // account for filter, eg. blur(5px), drop-shadow()\n\n\n      filter.forEach(function (_a) {\n        var name = _a.name,\n            params = _a.params;\n\n        if (name === 'blur') {\n          var blurRadius = params[0].value;\n          geometry_1.renderBounds.update(geometry_1.renderBounds.center, vec3.add(geometry_1.renderBounds.halfExtents, geometry_1.renderBounds.halfExtents, vec3.fromValues(blurRadius, blurRadius, 0)));\n        } else if (name === 'drop-shadow') {\n          var shadowOffsetX = params[0].value;\n          var shadowOffsetY = params[1].value;\n          var shadowBlur = params[2].value;\n          var _b = geometry_1.renderBounds,\n              min = _b.min,\n              max = _b.max;\n          var shadowLeft = min[0] - shadowBlur + shadowOffsetX;\n          var shadowRight = max[0] + shadowBlur + shadowOffsetX;\n          var shadowTop = min[1] - shadowBlur + shadowOffsetY;\n          var shadowBottom = max[1] + shadowBlur + shadowOffsetY;\n          min[0] = Math.min(min[0], shadowLeft);\n          max[0] = Math.max(max[0], shadowRight);\n          min[1] = Math.min(min[1], shadowTop);\n          max[1] = Math.max(max[1], shadowBottom);\n          geometry_1.renderBounds.setMinMax(min, max);\n        }\n      });\n      anchor = parsedStyle.anchor; // set transform origin\n\n      var usedOriginXValue = convertPercentUnit(transformOrigin[0], 0, object);\n      var usedOriginYValue = convertPercentUnit(transformOrigin[1], 1, object);\n      usedOriginXValue -= (anchor && anchor[0].value || 0) * geometry_1.contentBounds.halfExtents[0] * 2;\n      usedOriginYValue -= (anchor && anchor[1].value || 0) * geometry_1.contentBounds.halfExtents[1] * 2;\n      object.setOrigin(usedOriginXValue, usedOriginYValue);\n      object.emit(ElementEvent.GEOMETRY_BOUNDS_CHANGED, {});\n      dirtifyToRoot(object);\n    }\n  };\n\n  StyleValueRegistry.prototype.isPropertyInheritable = function (name) {\n    var metadata = this.getMetadata(name);\n\n    if (!metadata) {\n      return false;\n    }\n\n    return metadata.inherited;\n  };\n\n  __decorate([postConstruct(), __metadata(\"design:type\", Function), __metadata(\"design:paramtypes\", []), __metadata(\"design:returntype\", void 0)], StyleValueRegistry.prototype, \"init\", null);\n\n  StyleValueRegistry = __decorate([singleton()], StyleValueRegistry);\n  return StyleValueRegistry;\n}();\n\nexport { StyleValueRegistry };","map":{"version":3,"sources":["/Users/dennis.zhang/Desktop/其它代码库/moa-flow/node_modules/@antv/g/es/css/StyleValueRegistry.js"],"names":["__decorate","__metadata","__read","__spreadArray","postConstruct","singleton","GlobalContainer","vec3","dirtifyToRoot","GeometryUpdaterFactory","ElementEvent","Shape","CSSKeywordValue","CSSStyleValue","CSSUnitValue","convertPercentUnit","CSSPropertyLocalPosition","CSSPropertyOpacity","CSSPropertyColor","CSSPropertyFilter","CSSPropertyLengthOrPercentage","CSSPropertyLineDash","CSSPropertyShadowBlur","CSSPropertyOffsetPath","CSSPropertyOffsetDistance","CSSPropertyAnchor","CSSPropertyZIndex","CSSPropertyTransform","CSSPropertyTransformOrigin","CSSPropertyPath","CSSPropertyClipPath","CSSPropertyPoints","CSSPropertyText","CSSPropertyTextTransform","formatAttribute","AABB","PropertySyntax","COLOR","PAINT","NUMBER","LENGTH","PERCENTAGE","LENGTH_PERCENTAGE","BUILT_IN_PROPERTIES","name","keywords","interpolable","alias","defaultValue","syntax","handler","inherited","layoutDependent","independent","parsePriority","StyleValueRegistry","dirty","cache","unresolvedProperties","cascadeProperties","prototype","init","_this","forEach","property","registerMetadata","metadata","getMetadata","processProperties","object","attributes","options","skipUpdateAttribute","skipParse","needUpdateGeometry","Object","keys","attributeName","_a","_b","value","sortedNames","sort","a","b","computedStyle","parseProperty","hasUnresolvedProperties","computeProperty","updateGeometry","parsedStyle","postProcessProperty","isPropertyInheritable","children","child","internalSetAttribute","computed","indexOf","propertyHandler","get","parser","isDocumentElement","id","used","clone","resolved","tryToResolveProperty","addUnresolveProperty","calculator","oldParsedValue","postProcessor","isPropertyResolved","entity","length","includes","push","parentElement","usedValue","isRelativeUnit","unit","recalc","properties","attributes_1","geometryUpdaterFactory","geometryUpdater","nodeName","geometry_1","geometry","contentBounds","renderBounds","update","width","height","_c","depth","_d","x","_e","y","_f","offsetX","_g","offsetY","_h","offsetZ","LINE","POLYLINE","POLYGON","PATH","defX","defY","add","halfExtents","fromValues","_j","lineWidth","shadowColor","_k","filter","transformOrigin","anchor","TEXT","center","_l","min","max","_m","shadowBlur","shadowOffsetX","shadowOffsetY","shadowBlurInPixels","shadowOffsetXInPixels","shadowOffsetYInPixels","shadowLeft","shadowRight","shadowTop","shadowBottom","Math","setMinMax","params","blurRadius","usedOriginXValue","usedOriginYValue","setOrigin","emit","GEOMETRY_BOUNDS_CHANGED","Function"],"mappings":"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","sourcesContent":["import { __decorate, __metadata, __read, __spreadArray } from \"tslib\";\nimport { postConstruct, singleton, GlobalContainer } from 'mana-syringe';\nimport { vec3 } from 'gl-matrix';\nimport { dirtifyToRoot, GeometryUpdaterFactory } from '../services';\nimport { ElementEvent } from '../dom';\nimport { Shape } from '../types';\nimport { CSSKeywordValue, CSSStyleValue, CSSUnitValue } from './cssom';\nimport { convertPercentUnit } from './parser';\nimport { CSSPropertyLocalPosition, CSSPropertyOpacity, CSSPropertyColor, CSSPropertyFilter, CSSPropertyLengthOrPercentage, CSSPropertyLineDash, CSSPropertyShadowBlur, CSSPropertyOffsetPath, CSSPropertyOffsetDistance, CSSPropertyAnchor, CSSPropertyZIndex, CSSPropertyTransform, CSSPropertyTransformOrigin, CSSPropertyPath, CSSPropertyClipPath, CSSPropertyPoints, CSSPropertyText, CSSPropertyTextTransform } from './properties';\nimport { formatAttribute } from '../utils';\nimport { AABB } from '../shapes';\nexport var PropertySyntax = {\n  COLOR: '<color>',\n  PAINT: '<paint>',\n  NUMBER: '<number>',\n  LENGTH: '<length>',\n  PERCENTAGE: '<percentage>',\n  LENGTH_PERCENTAGE: '<length> | <percentage>'\n};\n/**\n * Blink used them in code generation(css_properties.json5)\n */\n\nexport var BUILT_IN_PROPERTIES = [{\n  /**\n   * used in CSS Layout API\n   * eg. `display: 'flex'`\n   */\n  name: 'display',\n  keywords: ['none']\n}, {\n  // x in local space\n  name: 'x',\n  interpolable: true,\n  alias: ['cx'],\n  defaultValue: '0',\n  syntax: PropertySyntax.LENGTH_PERCENTAGE,\n  handler: CSSPropertyLocalPosition\n}, {\n  // y in local space\n  name: 'y',\n  interpolable: true,\n  alias: ['cy'],\n  defaultValue: '0',\n  syntax: PropertySyntax.LENGTH_PERCENTAGE,\n  handler: CSSPropertyLocalPosition\n}, {\n  // z in local space\n  name: 'z',\n  interpolable: true,\n  defaultValue: '0',\n  syntax: PropertySyntax.LENGTH_PERCENTAGE,\n  handler: CSSPropertyLocalPosition\n}, {\n  /**\n   * range [0.0, 1.0]\n   * @see https://developer.mozilla.org/en-US/docs/Web/CSS/opacity\n   */\n  name: 'opacity',\n  interpolable: true,\n  defaultValue: '1',\n  syntax: PropertySyntax.NUMBER,\n  handler: CSSPropertyOpacity\n}, {\n  /**\n   * range [0.0, 1.0]\n   * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/fill-opacity\n   */\n  name: 'fillOpacity',\n  interpolable: true,\n  inherited: true,\n  defaultValue: '1',\n  syntax: PropertySyntax.NUMBER,\n  handler: CSSPropertyOpacity\n}, {\n  /**\n   * range [0.0, 1.0]\n   * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-opacity\n   */\n  name: 'strokeOpacity',\n  interpolable: true,\n  inherited: true,\n  defaultValue: '1',\n  syntax: PropertySyntax.NUMBER,\n  handler: CSSPropertyOpacity\n}, {\n  /**\n   * background-color is not inheritable\n   * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Fills_and_Strokes\n   */\n  name: 'fill',\n  interpolable: true,\n  keywords: ['none'],\n  defaultValue: 'none',\n  syntax: PropertySyntax.PAINT,\n  handler: CSSPropertyColor\n}, {\n  name: 'stroke',\n  interpolable: true,\n  keywords: ['none'],\n  defaultValue: 'none',\n  syntax: PropertySyntax.PAINT,\n  handler: CSSPropertyColor\n}, {\n  name: 'shadowColor',\n  interpolable: true,\n  syntax: PropertySyntax.COLOR,\n  handler: CSSPropertyColor\n}, {\n  name: 'shadowOffsetX',\n  interpolable: true,\n  layoutDependent: true,\n  syntax: PropertySyntax.LENGTH_PERCENTAGE,\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'shadowOffsetY',\n  interpolable: true,\n  layoutDependent: true,\n  syntax: PropertySyntax.LENGTH_PERCENTAGE,\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'shadowBlur',\n  interpolable: true,\n  layoutDependent: true,\n  handler: CSSPropertyShadowBlur\n}, {\n  /**\n   * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-width\n   */\n  name: 'lineWidth',\n  interpolable: true,\n  inherited: true,\n  defaultValue: '1',\n  layoutDependent: true,\n  alias: ['strokeWidth'],\n  syntax: PropertySyntax.LENGTH_PERCENTAGE,\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'lineJoin',\n  inherited: true,\n  layoutDependent: true,\n  alias: ['strokeLinejoin'],\n  keywords: ['miter', 'bevel', 'round'],\n  defaultValue: 'miter'\n}, {\n  name: 'lineCap',\n  inherited: true,\n  layoutDependent: true,\n  alias: ['strokeLinecap'],\n  keywords: ['butt', 'round', 'square'],\n  defaultValue: 'butt'\n}, {\n  name: 'lineDash',\n  interpolable: true,\n  inherited: true,\n  keywords: ['none'],\n  alias: ['strokeDasharray'],\n  handler: CSSPropertyLineDash\n}, {\n  name: 'lineDashOffset',\n  interpolable: true,\n  inherited: true,\n  defaultValue: '0',\n  alias: ['strokeDashoffset'],\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'offsetPath',\n  handler: CSSPropertyOffsetPath\n}, {\n  name: 'offsetDistance',\n  interpolable: true,\n  handler: CSSPropertyOffsetDistance\n}, {\n  name: 'dx',\n  interpolable: true,\n  layoutDependent: true,\n  defaultValue: '0',\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'dy',\n  interpolable: true,\n  layoutDependent: true,\n  defaultValue: '0',\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'zIndex',\n  independent: true,\n  interpolable: true,\n  defaultValue: '0',\n  keywords: ['auto'],\n  handler: CSSPropertyZIndex\n}, {\n  name: 'visibility',\n  keywords: ['visible', 'hidden'],\n  independent: true,\n  inherited: true,\n\n  /**\n   * TODO: support interpolation\n   * @see https://developer.mozilla.org/en-US/docs/Web/CSS/visibility#interpolation\n   */\n  // interpolable: true,\n  defaultValue: 'visible'\n}, {\n  name: 'pointerEvents',\n  inherited: true,\n  keywords: ['none', 'auto', 'stroke', 'fill', 'painted', 'visible', 'visiblestroke', 'visiblefill', 'visiblepainted', 'bounding-box', 'all'],\n  defaultValue: 'auto'\n}, {\n  name: 'filter',\n  independent: true,\n  layoutDependent: true,\n  handler: CSSPropertyFilter\n}, {\n  name: 'clipPath',\n  handler: CSSPropertyClipPath\n}, {\n  name: 'transform',\n  interpolable: true,\n  keywords: ['none'],\n  defaultValue: 'none',\n  handler: CSSPropertyTransform\n}, {\n  name: 'transformOrigin',\n  parsePriority: 100,\n  // interpolable: true,\n  defaultValue: 'left top',\n  layoutDependent: true,\n  handler: CSSPropertyTransformOrigin\n}, {\n  name: 'anchor',\n  parsePriority: 99,\n  layoutDependent: true,\n  handler: CSSPropertyAnchor\n}, // Circle\n{\n  name: 'r',\n  interpolable: true,\n  layoutDependent: true,\n  defaultValue: '0',\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'rx',\n  interpolable: true,\n  layoutDependent: true,\n  defaultValue: 'auto',\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'ry',\n  interpolable: true,\n  layoutDependent: true,\n  defaultValue: 'auto',\n  handler: CSSPropertyLengthOrPercentage\n}, // Rect Image\n{\n  name: 'width',\n  interpolable: true,\n  layoutDependent: true,\n\n  /**\n   * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/width\n   */\n  keywords: ['auto', 'fit-content', 'min-content', 'max-content'],\n  defaultValue: '0',\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'height',\n  interpolable: true,\n  layoutDependent: true,\n\n  /**\n   * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/height\n   */\n  keywords: ['auto', 'fit-content', 'min-content', 'max-content'],\n  defaultValue: '0',\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'radius',\n  interpolable: true,\n  layoutDependent: true,\n  defaultValue: '0',\n  handler: CSSPropertyLengthOrPercentage\n}, // Line\n{\n  name: 'x1',\n  interpolable: true,\n  layoutDependent: true,\n  handler: CSSPropertyLocalPosition\n}, {\n  name: 'y1',\n  interpolable: true,\n  layoutDependent: true,\n  handler: CSSPropertyLocalPosition\n}, {\n  name: 'z1',\n  interpolable: true,\n  layoutDependent: true,\n  handler: CSSPropertyLocalPosition\n}, {\n  name: 'x2',\n  interpolable: true,\n  layoutDependent: true,\n  handler: CSSPropertyLocalPosition\n}, {\n  name: 'y2',\n  interpolable: true,\n  layoutDependent: true,\n  handler: CSSPropertyLocalPosition\n}, {\n  name: 'z2',\n  interpolable: true,\n  layoutDependent: true,\n  handler: CSSPropertyLocalPosition\n}, // Path\n{\n  name: 'path',\n  interpolable: true,\n  layoutDependent: true,\n  defaultValue: '',\n  handler: CSSPropertyPath\n}, // Polyline\n{\n  name: 'points',\n  layoutDependent: true,\n  handler: CSSPropertyPoints\n}, // Text\n{\n  name: 'text',\n  layoutDependent: true,\n  handler: CSSPropertyText,\n  defaultValue: ''\n}, {\n  name: 'textTransform',\n  layoutDependent: true,\n  inherited: true,\n  keywords: ['capitalize', 'uppercase', 'lowercase', 'none'],\n  defaultValue: 'none',\n  handler: CSSPropertyTextTransform\n}, {\n  name: 'font',\n  layoutDependent: true\n}, {\n  name: 'fontSize',\n  interpolable: true,\n  inherited: true,\n\n  /**\n   * @see https://www.w3schools.com/css/css_font_size.asp\n   */\n  defaultValue: '16px',\n  layoutDependent: true,\n  handler: CSSPropertyLengthOrPercentage\n}, {\n  name: 'fontFamily',\n  layoutDependent: true,\n  inherited: true,\n  defaultValue: 'sans-serif'\n}, {\n  name: 'fontStyle',\n  layoutDependent: true,\n  inherited: true,\n  keywords: ['normal', 'italic', 'oblique'],\n  defaultValue: 'normal'\n}, {\n  name: 'fontWeight',\n  layoutDependent: true,\n  inherited: true,\n  keywords: ['normal', 'bold', 'bolder', 'lighter'],\n  defaultValue: 'normal'\n}, {\n  name: 'fontVariant',\n  layoutDependent: true,\n  inherited: true,\n  keywords: ['normal', 'small-caps'],\n  defaultValue: 'normal'\n}, {\n  name: 'lineHeight',\n  layoutDependent: true // interpolable: true,\n  // inherited: true,\n  // defaultValue: '-100%'\n\n}, {\n  name: 'letterSpacing',\n  layoutDependent: true // interpolable: true,\n  // inherited: true,\n  // defaultValue: '0',\n\n}, {\n  name: 'wordWrap',\n  layoutDependent: true\n}, {\n  name: 'wordWrapWidth',\n  layoutDependent: true\n}, {\n  name: 'leading',\n  layoutDependent: true\n}, {\n  name: 'textBaseline',\n  layoutDependent: true,\n  inherited: true,\n  keywords: ['top', 'hanging', 'middle', 'alphabetic', 'ideographic', 'bottom'],\n  defaultValue: 'alphabetic'\n}, {\n  name: 'textAlign',\n  layoutDependent: true,\n  inherited: true,\n  keywords: ['start', 'center', 'end', 'left', 'right'],\n  defaultValue: 'start'\n}, {\n  name: 'whiteSpace',\n  layoutDependent: true\n}];\n\nvar StyleValueRegistry =\n/** @class */\nfunction () {\n  function StyleValueRegistry() {\n    /**\n     * need recalc later\n     */\n    this.dirty = false;\n    this.cache = {};\n    this.unresolvedProperties = {};\n    /**\n     * eg.\n     *\n     * document: {\n     *   fontSize: [\n     *\n     *   ]\n     * }\n     */\n\n    this.cascadeProperties = {};\n  } // private boundsChangeListeners: Record<\n  //   /**\n  //    * parent's entity\n  //    */\n  //   number,\n  //   Record<\n  //     /**\n  //      * child's entity\n  //      */\n  //     number,\n  //     /**\n  //      * child properties\n  //      */\n  //     string[]\n  //   >\n  // > = {};\n\n\n  StyleValueRegistry.prototype.init = function () {\n    var _this = this;\n\n    BUILT_IN_PROPERTIES.forEach(function (property) {\n      _this.registerMetadata(property);\n    });\n  };\n\n  StyleValueRegistry.prototype.registerMetadata = function (metadata) {\n    var _this = this;\n\n    __spreadArray([metadata.name], __read(metadata.alias || []), false).forEach(function (name) {\n      _this.cache[name] = metadata;\n    });\n  };\n\n  StyleValueRegistry.prototype.getMetadata = function (name) {\n    return this.cache[name];\n  };\n  /**\n   * * parse value, eg.\n   * fill: 'red' => CSSRGB\n   * translateX: '10px' => CSSUnitValue { unit: 'px', value: 10 }\n   * fontSize: '2em' => { unit: 'px', value: 32 }\n   *\n   * * calculate used value\n   * * post process\n   */\n\n\n  StyleValueRegistry.prototype.processProperties = function (object, attributes, options) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = {\n        skipUpdateAttribute: false,\n        skipParse: false\n      };\n    }\n\n    var skipUpdateAttribute = options.skipUpdateAttribute,\n        skipParse = options.skipParse;\n    var needUpdateGeometry = false;\n    Object.keys(attributes).forEach(function (attributeName) {\n      var _a;\n\n      var _b = __read(formatAttribute(attributeName, attributes[attributeName]), 2),\n          name = _b[0],\n          value = _b[1];\n\n      if (!skipUpdateAttribute) {\n        object.attributes[name] = value;\n      }\n\n      if (!needUpdateGeometry && ((_a = _this.getMetadata(name)) === null || _a === void 0 ? void 0 : _a.layoutDependent)) {\n        needUpdateGeometry = true;\n      }\n    }); // parse according to priority\n\n    var sortedNames = Object.keys(attributes).sort(function (a, b) {\n      var _a, _b;\n\n      return (((_a = _this.getMetadata(a)) === null || _a === void 0 ? void 0 : _a.parsePriority) || 0) - (((_b = _this.getMetadata(b)) === null || _b === void 0 ? void 0 : _b.parsePriority) || 0);\n    });\n\n    if (!skipParse) {\n      sortedNames.forEach(function (name) {\n        object.computedStyle[name] = _this.parseProperty(name, object.attributes[name]);\n      });\n    }\n\n    var hasUnresolvedProperties = false;\n    sortedNames.forEach(function (name) {\n      // some style props maybe deleted after parsing such as `anchor` in Text\n      if (name in object.computedStyle) {\n        hasUnresolvedProperties = _this.computeProperty(name, object.computedStyle[name], object);\n      }\n    });\n\n    if (hasUnresolvedProperties) {\n      this.dirty = true;\n      return;\n    } // update geometry\n\n\n    if (needUpdateGeometry) {\n      this.updateGeometry(object);\n    }\n\n    sortedNames.forEach(function (name) {\n      if (name in object.parsedStyle) {\n        _this.postProcessProperty(name, object);\n      }\n    });\n    sortedNames.forEach(function (name) {\n      if (name in object.parsedStyle && _this.isPropertyInheritable(name)) {\n        // update children's inheritable\n        object.children.forEach(function (child) {\n          child.internalSetAttribute(name, null, {\n            skipUpdateAttribute: true,\n            skipParse: true\n          });\n        });\n      }\n    });\n  };\n  /**\n   * string -> parsed value\n   */\n\n\n  StyleValueRegistry.prototype.parseProperty = function (name, value) {\n    var metadata = this.getMetadata(name);\n    var computed = value;\n\n    if (value === '') {\n      value = 'unset';\n    }\n\n    if (value === 'unset' || value === 'initial' || value === 'inherit') {\n      computed = new CSSKeywordValue(value);\n    } else {\n      if (metadata) {\n        var keywords = metadata.keywords,\n            handler = metadata.handler; // use keywords\n\n        if (keywords && keywords.indexOf(value) > -1) {\n          computed = new CSSKeywordValue(value);\n        } else if (handler) {\n          // try to parse value with handler\n          var propertyHandler = GlobalContainer.get(handler);\n\n          if (propertyHandler && propertyHandler.parser) {\n            // try to parse it to CSSStyleValue, eg. '10px' -> CSS.px(10)\n            computed = propertyHandler.parser(value);\n          }\n        }\n      }\n    }\n\n    return computed;\n  };\n  /**\n   * computed value -> used value\n   */\n\n\n  StyleValueRegistry.prototype.computeProperty = function (name, computed, object) {\n    var metadata = this.getMetadata(name);\n    var isDocumentElement = object.id === 'g-root';\n    var used = computed instanceof CSSStyleValue ? computed.clone() : computed;\n\n    if (metadata) {\n      var handler = metadata.handler,\n          inherited = metadata.inherited,\n          defaultValue = metadata.defaultValue;\n\n      if (computed instanceof CSSKeywordValue) {\n        var value = computed.value;\n        /**\n         * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/unset\n         */\n\n        if (value === 'unset') {\n          if (inherited && !isDocumentElement) {\n            value = 'inherit';\n          } else {\n            value = 'initial';\n          }\n        }\n\n        if (value === 'initial') {\n          // @see https://developer.mozilla.org/en-US/docs/Web/CSS/initial\n          if (defaultValue) {\n            computed = this.parseProperty(name, defaultValue);\n          }\n        } else if (value === 'inherit') {\n          // @see https://developer.mozilla.org/en-US/docs/Web/CSS/inherit\n          // behave like `inherit`\n          var resolved = this.tryToResolveProperty(object, name, {\n            inherited: true\n          });\n\n          if (resolved) {\n            object.parsedStyle[name] = resolved;\n            return false;\n          } else {\n            this.addUnresolveProperty(object, name);\n            return true;\n          }\n        }\n      }\n\n      if (handler) {\n        var propertyHandler = GlobalContainer.get(handler); // convert computed value to used value\n\n        if (propertyHandler && propertyHandler.calculator) {\n          var oldParsedValue = object.parsedStyle[name];\n          used = propertyHandler.calculator(name, oldParsedValue, computed, object, this);\n        } else {\n          used = computed;\n        }\n      } else {\n        used = computed;\n      }\n    }\n\n    object.parsedStyle[name] = used;\n    return false;\n  };\n\n  StyleValueRegistry.prototype.postProcessProperty = function (name, object) {\n    var metadata = this.getMetadata(name);\n\n    if (metadata && metadata.handler) {\n      var propertyHandler = GlobalContainer.get(metadata.handler);\n\n      if (propertyHandler && propertyHandler.postProcessor) {\n        propertyHandler.postProcessor(object);\n      }\n    }\n  };\n\n  StyleValueRegistry.prototype.isPropertyResolved = function (object, name) {\n    if (!this.unresolvedProperties[object.entity] || this.unresolvedProperties[object.entity].length === 0) {\n      return true;\n    }\n\n    return this.unresolvedProperties[object.entity].includes(name);\n  };\n  /**\n   * resolve later\n   */\n\n\n  StyleValueRegistry.prototype.addUnresolveProperty = function (object, name) {\n    if (!this.unresolvedProperties[object.entity]) {\n      this.unresolvedProperties[object.entity] = [];\n    }\n\n    if (this.unresolvedProperties[object.entity].indexOf(name) === -1) {\n      this.unresolvedProperties[object.entity].push(name);\n    }\n  };\n\n  StyleValueRegistry.prototype.tryToResolveProperty = function (object, name, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var inherited = options.inherited;\n\n    if (inherited) {\n      if (object.parentElement && this.isPropertyResolved(object.parentElement, name)) {\n        var usedValue = object.parentElement.parsedStyle[name];\n\n        if (usedValue instanceof CSSKeywordValue && (usedValue.value === 'unset' || usedValue.value === 'initial' || usedValue.value === 'inherit')) {\n          return false;\n        } else if (usedValue instanceof CSSUnitValue && CSSUnitValue.isRelativeUnit(usedValue.unit)) {\n          return false;\n        }\n\n        return usedValue;\n      }\n    }\n\n    return false;\n  };\n\n  StyleValueRegistry.prototype.recalc = function (object) {\n    var properties = this.unresolvedProperties[object.entity];\n\n    if (properties && properties.length) {\n      var attributes_1 = {};\n      properties.forEach(function (property) {\n        attributes_1[property] = object.attributes[property];\n      });\n      this.processProperties(object, attributes_1);\n      delete this.unresolvedProperties[object.entity];\n    }\n  };\n  /**\n   * update geometry when relative props changed,\n   * eg. r of Circle, width/height of Rect\n   */\n\n\n  StyleValueRegistry.prototype.updateGeometry = function (object) {\n    var _a;\n\n    var geometryUpdaterFactory = GlobalContainer.get(GeometryUpdaterFactory);\n    var geometryUpdater = geometryUpdaterFactory(object.nodeName);\n\n    if (geometryUpdater) {\n      var geometry_1 = object.geometry;\n\n      if (!geometry_1.contentBounds) {\n        geometry_1.contentBounds = new AABB();\n      }\n\n      if (!geometry_1.renderBounds) {\n        geometry_1.renderBounds = new AABB();\n      }\n\n      var parsedStyle = object.parsedStyle;\n\n      var _b = geometryUpdater.update(parsedStyle, object),\n          width = _b.width,\n          height = _b.height,\n          _c = _b.depth,\n          depth = _c === void 0 ? 0 : _c,\n          _d = _b.x,\n          x = _d === void 0 ? 0 : _d,\n          _e = _b.y,\n          y = _e === void 0 ? 0 : _e,\n          // z = 0,\n      _f = _b.offsetX,\n          // z = 0,\n      offsetX = _f === void 0 ? 0 : _f,\n          _g = _b.offsetY,\n          offsetY = _g === void 0 ? 0 : _g,\n          _h = _b.offsetZ,\n          offsetZ = _h === void 0 ? 0 : _h;\n\n      if (object.nodeName === Shape.LINE || object.nodeName === Shape.POLYLINE || object.nodeName === Shape.POLYGON || object.nodeName === Shape.PATH) {\n        parsedStyle.offsetX = x - (parsedStyle.defX || 0);\n        parsedStyle.offsetY = y - (parsedStyle.defY || 0);\n        parsedStyle.defX = x;\n        parsedStyle.defY = y; // modify x/y/z\n\n        object.attributes.x += parsedStyle.offsetX;\n        object.attributes.y += parsedStyle.offsetY;\n        parsedStyle.x = parsedStyle.x.add(new CSSUnitValue(parsedStyle.offsetX, 'px'));\n        parsedStyle.y = parsedStyle.y.add(new CSSUnitValue(parsedStyle.offsetY, 'px'));\n      } // init with content box\n\n\n      var halfExtents = vec3.fromValues(width / 2, height / 2, depth / 2); // anchor is center by default, don't account for lineWidth here\n\n      var _j = parsedStyle,\n          lineWidth = _j.lineWidth,\n          shadowColor = _j.shadowColor,\n          _k = _j.filter,\n          filter = _k === void 0 ? [] : _k,\n          transformOrigin = _j.transformOrigin;\n      var anchor = parsedStyle.anchor; // <Text> use textAlign & textBaseline instead of anchor\n\n      if (object.nodeName === Shape.TEXT) {\n        delete parsedStyle.anchor;\n      }\n\n      var center = vec3.fromValues((1 - (anchor && anchor[0].value || 0) * 2) * halfExtents[0] + offsetX, (1 - (anchor && anchor[1].value || 0) * 2) * halfExtents[1] + offsetY, (1 - (anchor && ((_a = anchor[2]) === null || _a === void 0 ? void 0 : _a.value) || 0) * 2) * halfExtents[2] + offsetZ); // update geometry's AABB\n\n      geometry_1.contentBounds.update(center, halfExtents);\n\n      if (lineWidth) {\n        // append border\n        vec3.add(halfExtents, halfExtents, vec3.fromValues(lineWidth.value / 2, lineWidth.value / 2, 0));\n      }\n\n      geometry_1.renderBounds.update(center, halfExtents); // account for shadow, only support constant value now\n\n      if (shadowColor) {\n        var _l = geometry_1.renderBounds,\n            min = _l.min,\n            max = _l.max;\n        var _m = parsedStyle,\n            shadowBlur = _m.shadowBlur,\n            shadowOffsetX = _m.shadowOffsetX,\n            shadowOffsetY = _m.shadowOffsetY;\n        var shadowBlurInPixels = shadowBlur && shadowBlur.value || 0;\n        var shadowOffsetXInPixels = shadowOffsetX && shadowOffsetX.value || 0;\n        var shadowOffsetYInPixels = shadowOffsetY && shadowOffsetY.value || 0;\n        var shadowLeft = min[0] - shadowBlurInPixels + shadowOffsetXInPixels;\n        var shadowRight = max[0] + shadowBlurInPixels + shadowOffsetXInPixels;\n        var shadowTop = min[1] - shadowBlurInPixels + shadowOffsetYInPixels;\n        var shadowBottom = max[1] + shadowBlurInPixels + shadowOffsetYInPixels;\n        min[0] = Math.min(min[0], shadowLeft);\n        max[0] = Math.max(max[0], shadowRight);\n        min[1] = Math.min(min[1], shadowTop);\n        max[1] = Math.max(max[1], shadowBottom);\n        geometry_1.renderBounds.setMinMax(min, max);\n      } // account for filter, eg. blur(5px), drop-shadow()\n\n\n      filter.forEach(function (_a) {\n        var name = _a.name,\n            params = _a.params;\n\n        if (name === 'blur') {\n          var blurRadius = params[0].value;\n          geometry_1.renderBounds.update(geometry_1.renderBounds.center, vec3.add(geometry_1.renderBounds.halfExtents, geometry_1.renderBounds.halfExtents, vec3.fromValues(blurRadius, blurRadius, 0)));\n        } else if (name === 'drop-shadow') {\n          var shadowOffsetX = params[0].value;\n          var shadowOffsetY = params[1].value;\n          var shadowBlur = params[2].value;\n          var _b = geometry_1.renderBounds,\n              min = _b.min,\n              max = _b.max;\n          var shadowLeft = min[0] - shadowBlur + shadowOffsetX;\n          var shadowRight = max[0] + shadowBlur + shadowOffsetX;\n          var shadowTop = min[1] - shadowBlur + shadowOffsetY;\n          var shadowBottom = max[1] + shadowBlur + shadowOffsetY;\n          min[0] = Math.min(min[0], shadowLeft);\n          max[0] = Math.max(max[0], shadowRight);\n          min[1] = Math.min(min[1], shadowTop);\n          max[1] = Math.max(max[1], shadowBottom);\n          geometry_1.renderBounds.setMinMax(min, max);\n        }\n      });\n      anchor = parsedStyle.anchor; // set transform origin\n\n      var usedOriginXValue = convertPercentUnit(transformOrigin[0], 0, object);\n      var usedOriginYValue = convertPercentUnit(transformOrigin[1], 1, object);\n      usedOriginXValue -= (anchor && anchor[0].value || 0) * geometry_1.contentBounds.halfExtents[0] * 2;\n      usedOriginYValue -= (anchor && anchor[1].value || 0) * geometry_1.contentBounds.halfExtents[1] * 2;\n      object.setOrigin(usedOriginXValue, usedOriginYValue);\n      object.emit(ElementEvent.GEOMETRY_BOUNDS_CHANGED, {});\n      dirtifyToRoot(object);\n    }\n  };\n\n  StyleValueRegistry.prototype.isPropertyInheritable = function (name) {\n    var metadata = this.getMetadata(name);\n\n    if (!metadata) {\n      return false;\n    }\n\n    return metadata.inherited;\n  };\n\n  __decorate([postConstruct(), __metadata(\"design:type\", Function), __metadata(\"design:paramtypes\", []), __metadata(\"design:returntype\", void 0)], StyleValueRegistry.prototype, \"init\", null);\n\n  StyleValueRegistry = __decorate([singleton()], StyleValueRegistry);\n  return StyleValueRegistry;\n}();\n\nexport { StyleValueRegistry };"]},"metadata":{},"sourceType":"module"}