{"ast":null,"code":"import { __assign, __extends, __read, __spreadArray } from \"tslib\";\nimport { GlobalContainer } from 'mana-syringe';\nimport { isEqual, isNil, isObject, isUndefined } from 'lodash-es';\nimport { mat4, quat, vec3 } from 'gl-matrix';\nimport { DisplayObjectPool } from '../DisplayObjectPool';\nimport { KeyframeEffect } from '../dom/KeyframeEffect';\nimport { Element } from '../dom/Element';\nimport { ElementEvent } from '../dom/interfaces';\nimport { Shape } from '../types';\nimport { createVec3, decompose, formatAttribute, fromRotationTranslationScale, getEuler, rad2deg } from '../utils';\nimport { dirtifyToRoot } from '../services';\nimport { MutationEvent } from '../dom/MutationEvent';\nimport { Rectangle } from '../shapes';\nimport { StyleValueRegistry } from '../css/StyleValueRegistry';\nimport { CSSUnitValue } from '../css';\nvar DEFAULT_STYLE_PROPS = {\n  x: '',\n  y: '',\n  z: '',\n  anchor: [0, 0],\n  opacity: '',\n  fillOpacity: '',\n  strokeOpacity: '',\n  fill: '',\n  stroke: '',\n  transformOrigin: '',\n  visibility: '',\n  pointerEvents: '',\n  lineCap: '',\n  lineJoin: '',\n  fontSize: '',\n  fontFamily: '',\n  fontStyle: '',\n  fontWeight: '',\n  fontVariant: '',\n  textAlign: '',\n  textBaseline: '',\n  textTransform: ''\n};\n/**\n * prototype chains: DisplayObject -> Element -> Node -> EventTarget\n *\n * mixins: Animatable, Transformable, Visible\n * @see https://github.com/tannerntannern/ts-mixer/blob/master/README.md#mixing-generic-classes\n *\n * Provide abilities in scene graph, such as:\n * * transform `translate/rotate/scale`\n * * add/remove child\n * * visibility and z-index\n *\n * Those abilities are implemented with those components: `Transform/Sortable/Visible`.\n *\n * Emit following events:\n * * init\n * * destroy\n * * attributeChanged\n */\n\nvar DisplayObject =\n/** @class */\nfunction (_super) {\n  __extends(DisplayObject, _super);\n\n  function DisplayObject(config) {\n    var _this = this;\n\n    var _a, _b, _c;\n\n    _this = _super.call(this) || this;\n    _this.styleValueRegistry = GlobalContainer.get(StyleValueRegistry);\n    /**\n     * push to active animations after calling `animate()`\n     */\n\n    _this.activeAnimations = []; // assign name, id to config\n    // eg. group.get('name')\n\n    _this.config = config; // compatible with G 3.0\n\n    _this.config.interactive = (_a = _this.config.capture) !== null && _a !== void 0 ? _a : _this.config.interactive; // init scene graph node\n\n    _this.id = _this.config.id || '';\n    _this.name = _this.config.name || '';\n\n    if (_this.config.className || _this.config.class) {\n      _this.className = _this.config.className || _this.config.class;\n    }\n\n    _this.nodeName = _this.config.type || Shape.GROUP; // compatible with G 3.0\n\n    _this.config.style = __assign(__assign(__assign(__assign({}, DEFAULT_STYLE_PROPS), {\n      zIndex: (_b = _this.config.zIndex) !== null && _b !== void 0 ? _b : 0,\n      interactive: (_c = _this.config.interactive) !== null && _c !== void 0 ? _c : true\n    }), _this.config.style), _this.config.attrs);\n\n    if (!isNil(_this.config.visible)) {\n      _this.config.style.visibility = _this.config.visible === false ? 'hidden' : 'visible';\n    }\n\n    if (!isNil(_this.config.interactive)) {\n      _this.config.style.pointerEvents = _this.config.interactive === false ? 'none' : 'auto';\n    }\n\n    _this.style = new Proxy(__assign(__assign({}, _this.attributes), {\n      setProperty: function setProperty(propertyName, value) {\n        _this.setAttribute(propertyName, value);\n      },\n      getPropertyValue: function getPropertyValue(propertyName) {\n        return _this.getAttribute(propertyName);\n      },\n      removeProperty: function removeProperty(propertyName) {\n        _this.removeAttribute(propertyName);\n      },\n      item: function item() {\n        return '';\n      }\n    }), {\n      get: function get(target, name) {\n        if (name in target) {\n          return target[name];\n        }\n\n        return _this.getAttribute(name);\n      },\n      set: function set(_, prop, value) {\n        _this.setAttribute(prop, value);\n\n        return true;\n      }\n    });\n\n    _this.initAttributes(_this.config.style); // insert this group into pool\n\n\n    GlobalContainer.get(DisplayObjectPool).add(_this.entity, _this);\n    return _this;\n  }\n\n  DisplayObject.prototype.destroy = function () {\n    _super.prototype.destroy.call(this); // remove from into pool\n\n\n    GlobalContainer.get(DisplayObjectPool).remove(this.entity); // stop all active animations\n\n    this.getAnimations().forEach(function (animation) {\n      animation.cancel();\n    });\n  };\n\n  DisplayObject.prototype.cloneNode = function (deep) {\n    var cloned = new this.constructor({\n      // copy id & name\n      // @see https://developer.mozilla.org/en-US/docs/Web/API/Node/cloneNode#notes\n      id: this.id,\n      name: this.name,\n      className: this.name,\n      interactive: this.interactive,\n      style: __assign({}, this.attributes)\n    });\n\n    if (deep) {\n      this.children.forEach(function (child) {\n        var clonedChild = child.cloneNode(deep);\n        cloned.appendChild(clonedChild);\n      });\n    }\n\n    return cloned;\n  };\n\n  DisplayObject.prototype.initAttributes = function (attributes) {\n    if (attributes === void 0) {\n      attributes = {};\n    }\n\n    var renderable = this.renderable;\n    this.styleValueRegistry.processProperties(this, attributes); // redraw at next frame\n\n    renderable.dirty = true;\n  };\n\n  DisplayObject.prototype.setAttribute = function (name, value, force) {\n    if (force === void 0) {\n      force = false;\n    }\n\n    var _a = __read(formatAttribute(name, value), 2),\n        attributeName = _a[0],\n        attributeValue = _a[1]; // ignore undefined value\n\n\n    if (isUndefined(value)) {\n      return;\n    }\n\n    if (force || !isEqual(attributeValue, this.attributes[attributeName])) {\n      this.internalSetAttribute(attributeName, attributeValue);\n\n      _super.prototype.setAttribute.call(this, attributeName, attributeValue);\n    }\n  };\n  /**\n   * called when attributes get changed or initialized\n   */\n\n\n  DisplayObject.prototype.internalSetAttribute = function (name, value, parseOptions) {\n    var _a;\n\n    var _this = this;\n\n    if (parseOptions === void 0) {\n      parseOptions = {};\n    }\n\n    var renderable = this.renderable;\n    var oldValue = this.attributes[name];\n    var oldParsedValue = this.parsedStyle[name];\n    this.styleValueRegistry.processProperties(this, (_a = {}, _a[name] = value, _a), parseOptions); // inform clip path targets\n\n    if (this.attributes.clipPathTargets && this.attributes.clipPathTargets.length) {\n      this.attributes.clipPathTargets.forEach(function (target) {\n        dirtifyToRoot(target);\n        target.dispatchEvent(new MutationEvent(ElementEvent.ATTR_MODIFIED, target, _this, _this, 'clipPath', MutationEvent.MODIFICATION, _this, _this));\n      });\n    } // redraw at next frame\n\n\n    renderable.dirty = true;\n    this.dispatchEvent(new MutationEvent(ElementEvent.ATTR_MODIFIED, this, oldValue, value, name, MutationEvent.MODIFICATION, oldParsedValue, this.parsedStyle[name]));\n  }; // #region transformable\n\n  /**\n   * returns different values than getBoundingClientRect(), as the latter returns value relative to the viewport\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/SVGGraphicsElement/getBBox\n   *\n   * FIXME: It is worth noting that getBBox responds to original untransformed values of a drawn object.\n   * @see https://www.w3.org/Graphics/SVG/IG/resources/svgprimer.html#getBBox\n   */\n\n\n  DisplayObject.prototype.getBBox = function () {\n    var aabb = this.getBounds();\n\n    var _a = __read(aabb.getMin(), 2),\n        left = _a[0],\n        top = _a[1];\n\n    var _b = __read(aabb.getMax(), 2),\n        right = _b[0],\n        bottom = _b[1];\n\n    return new Rectangle(left, top, right - left, bottom - top);\n  };\n\n  DisplayObject.prototype.setOrigin = function (position, y, z) {\n    if (y === void 0) {\n      y = 0;\n    }\n\n    if (z === void 0) {\n      z = 0;\n    }\n\n    this.sceneGraphService.setOrigin(this, createVec3(position, y, z));\n    return this;\n  };\n\n  DisplayObject.prototype.getOrigin = function () {\n    return this.sceneGraphService.getOrigin(this);\n  };\n  /**\n   * set position in world space\n   */\n\n\n  DisplayObject.prototype.setPosition = function (position, y, z) {\n    if (y === void 0) {\n      y = 0;\n    }\n\n    if (z === void 0) {\n      z = 0;\n    }\n\n    this.sceneGraphService.setPosition(this, createVec3(position, y, z));\n    this.syncLocalPosition();\n    return this;\n  };\n  /**\n   * set position in local space\n   */\n\n\n  DisplayObject.prototype.setLocalPosition = function (position, y, z) {\n    if (y === void 0) {\n      y = 0;\n    }\n\n    if (z === void 0) {\n      z = 0;\n    }\n\n    this.sceneGraphService.setLocalPosition(this, createVec3(position, y, z));\n    this.syncLocalPosition();\n    return this;\n  };\n  /**\n   * translate in world space\n   */\n\n\n  DisplayObject.prototype.translate = function (position, y, z) {\n    if (y === void 0) {\n      y = 0;\n    }\n\n    if (z === void 0) {\n      z = 0;\n    }\n\n    this.sceneGraphService.translate(this, createVec3(position, y, z));\n    this.syncLocalPosition();\n    return this;\n  };\n  /**\n   * translate in local space\n   */\n\n\n  DisplayObject.prototype.translateLocal = function (position, y, z) {\n    if (y === void 0) {\n      y = 0;\n    }\n\n    if (z === void 0) {\n      z = 0;\n    }\n\n    this.sceneGraphService.translateLocal(this, createVec3(position, y, z));\n    this.syncLocalPosition();\n    return this;\n  };\n\n  DisplayObject.prototype.getPosition = function () {\n    return this.sceneGraphService.getPosition(this);\n  };\n\n  DisplayObject.prototype.getLocalPosition = function () {\n    return this.sceneGraphService.getLocalPosition(this);\n  };\n  /**\n   * compatible with G 3.0\n   *\n   * scaling in local space\n   * scale(10) = scale(10, 10, 10)\n   *\n   * we can't set scale in world space\n   */\n\n\n  DisplayObject.prototype.scale = function (scaling, y, z) {\n    return this.scaleLocal(scaling, y, z);\n  };\n\n  DisplayObject.prototype.scaleLocal = function (scaling, y, z) {\n    if (typeof scaling === 'number') {\n      y = y || scaling;\n      z = z || scaling;\n      scaling = createVec3(scaling, y, z);\n    }\n\n    this.sceneGraphService.scaleLocal(this, scaling);\n    return this;\n  };\n  /**\n   * set scaling in local space\n   */\n\n\n  DisplayObject.prototype.setLocalScale = function (scaling, y, z) {\n    if (typeof scaling === 'number') {\n      y = y || scaling;\n      z = z || scaling;\n      scaling = createVec3(scaling, y, z);\n    }\n\n    this.sceneGraphService.setLocalScale(this, scaling);\n    return this;\n  };\n  /**\n   * get scaling in local space\n   */\n\n\n  DisplayObject.prototype.getLocalScale = function () {\n    return this.sceneGraphService.getLocalScale(this);\n  };\n  /**\n   * get scaling in world space\n   */\n\n\n  DisplayObject.prototype.getScale = function () {\n    return this.sceneGraphService.getScale(this);\n  };\n  /**\n   * only return degrees of Z axis in world space\n   */\n\n\n  DisplayObject.prototype.getEulerAngles = function () {\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    var _a = __read(getEuler(vec3.create(), this.sceneGraphService.getWorldTransform(this)), 3),\n        ex = _a[0],\n        ey = _a[1],\n        ez = _a[2];\n\n    return rad2deg(ez);\n  };\n  /**\n   * only return degrees of Z axis in local space\n   */\n\n\n  DisplayObject.prototype.getLocalEulerAngles = function () {\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    var _a = __read(getEuler(vec3.create(), this.sceneGraphService.getLocalRotation(this)), 3),\n        ex = _a[0],\n        ey = _a[1],\n        ez = _a[2];\n\n    return rad2deg(ez);\n  };\n  /**\n   * set euler angles(degrees) in world space\n   */\n\n\n  DisplayObject.prototype.setEulerAngles = function (z) {\n    this.sceneGraphService.setEulerAngles(this, 0, 0, z);\n    return this;\n  };\n  /**\n   * set euler angles(degrees) in local space\n   */\n\n\n  DisplayObject.prototype.setLocalEulerAngles = function (z) {\n    this.sceneGraphService.setLocalEulerAngles(this, 0, 0, z);\n    return this;\n  };\n\n  DisplayObject.prototype.rotateLocal = function (x, y, z) {\n    if (isNil(y) && isNil(z)) {\n      this.sceneGraphService.rotateLocal(this, 0, 0, x);\n    } else {\n      this.sceneGraphService.rotateLocal(this, x, y, z);\n    }\n\n    return this;\n  };\n\n  DisplayObject.prototype.rotate = function (x, y, z) {\n    if (isNil(y) && isNil(z)) {\n      this.sceneGraphService.rotate(this, 0, 0, x);\n    } else {\n      this.sceneGraphService.rotate(this, x, y, z);\n    }\n\n    return this;\n  };\n\n  DisplayObject.prototype.setRotation = function (rotation, y, z, w) {\n    this.sceneGraphService.setRotation(this, rotation, y, z, w);\n    return this;\n  };\n\n  DisplayObject.prototype.setLocalRotation = function (rotation, y, z, w) {\n    this.sceneGraphService.setLocalRotation(this, rotation, y, z, w);\n    return this;\n  };\n\n  DisplayObject.prototype.getRotation = function () {\n    return this.sceneGraphService.getRotation(this);\n  };\n\n  DisplayObject.prototype.getLocalRotation = function () {\n    return this.sceneGraphService.getLocalRotation(this);\n  };\n\n  DisplayObject.prototype.getLocalTransform = function () {\n    return this.sceneGraphService.getLocalTransform(this);\n  };\n\n  DisplayObject.prototype.getWorldTransform = function () {\n    return this.sceneGraphService.getWorldTransform(this);\n  };\n\n  DisplayObject.prototype.resetLocalTransform = function () {\n    this.sceneGraphService.resetLocalTransform(this);\n  };\n  /**\n   * sync style.x/y when local position changed\n   *\n   * Mixins may not declare private/protected properties\n   * however, you can use ES2020 private fields\n   */\n\n\n  DisplayObject.prototype.syncLocalPosition = function () {\n    var localPosition = this.getLocalPosition();\n    this.attributes.x = localPosition[0];\n    this.attributes.y = localPosition[1];\n    this.attributes.z = localPosition[2]; // should not affect computed style\n\n    this.parsedStyle.x = new CSSUnitValue(this.attributes.x, 'px');\n    this.parsedStyle.y = new CSSUnitValue(this.attributes.y, 'px');\n    this.parsedStyle.z = new CSSUnitValue(this.attributes.z, 'px');\n  }; // #endregion transformable\n  // #region animatable\n\n  /**\n   * returns an array of all Animation objects affecting this element\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/getAnimations\n   */\n\n\n  DisplayObject.prototype.getAnimations = function () {\n    return this.activeAnimations;\n  };\n  /**\n   * create an animation with WAAPI\n   * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/animate\n   */\n\n\n  DisplayObject.prototype.animate = function (keyframes, options) {\n    var _a, _b;\n\n    var timeline = (_a = this.ownerDocument) === null || _a === void 0 ? void 0 : _a.timeline; // accounte for clip path, use target's timeline\n\n    if (this.attributes.clipPathTargets && this.attributes.clipPathTargets.length) {\n      var target = this.attributes.clipPathTargets[0];\n      timeline = (_b = target.ownerDocument) === null || _b === void 0 ? void 0 : _b.timeline;\n    } // clear old parsed transform\n\n\n    delete this.parsedStyle.transform;\n\n    if (timeline) {\n      return timeline.play(new KeyframeEffect(this, keyframes, options));\n    }\n\n    return null;\n  }; // #endregion animatable\n  // #region visible\n\n  /**\n   * show group, which will also change visibility of its children in sceneGraphNode\n   *\n   * @deprecated\n   * @see https://developer.mozilla.org/en-US/docs/Web/CSS/visibility\n   */\n\n\n  DisplayObject.prototype.show = function () {\n    this.style.visibility = 'visible';\n  };\n  /**\n   * @deprecated\n   * hide group, which will also change visibility of its children in sceneGraphNode\n   */\n\n\n  DisplayObject.prototype.hide = function () {\n    this.style.visibility = 'hidden';\n  };\n  /**\n   * shortcut for Used value of `visibility`\n   */\n\n\n  DisplayObject.prototype.isVisible = function () {\n    var _a, _b;\n\n    return ((_b = (_a = this.parsedStyle) === null || _a === void 0 ? void 0 : _a.visibility) === null || _b === void 0 ? void 0 : _b.value) === 'visible';\n  };\n\n  Object.defineProperty(DisplayObject.prototype, \"interactive\", {\n    get: function get() {\n      return this.isInteractive();\n    },\n    set: function set(b) {\n      this.style.pointerEvents = b ? 'auto' : 'none';\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  DisplayObject.prototype.isInteractive = function () {\n    var _a, _b;\n\n    return ((_b = (_a = this.parsedStyle) === null || _a === void 0 ? void 0 : _a.pointerEvents) === null || _b === void 0 ? void 0 : _b.value) !== 'none';\n  };\n\n  DisplayObject.prototype.isCulled = function () {\n    return !!(this.cullable && this.cullable.isCulled());\n  };\n  /**\n   * bring to front in current group\n   */\n\n\n  DisplayObject.prototype.toFront = function () {\n    if (this.parentNode) {\n      this.style.zIndex = Math.max.apply(Math, __spreadArray([], __read(this.parentNode.children.map(function (child) {\n        return Number(child.style.zIndex);\n      })), false)) + 1;\n    }\n\n    return this;\n  };\n  /**\n   * send to back in current group\n   */\n\n\n  DisplayObject.prototype.toBack = function () {\n    if (this.parentNode) {\n      this.style.zIndex = Math.min.apply(Math, __spreadArray([], __read(this.parentNode.children.map(function (child) {\n        return Number(child.style.zIndex);\n      })), false)) - 1;\n    }\n\n    return this;\n  }; // #endregion visible\n  // #region deprecated\n\n  /**\n   * @deprecated\n   * compatible with G 3.0\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.getCount = function () {\n    return this.childElementCount;\n  };\n  /**\n   * @deprecated\n   * compatible with G 3.0\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.getParent = function () {\n    return this.parentElement;\n  };\n  /**\n   * @deprecated\n   * compatible with G 3.0\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.getChildren = function () {\n    return this.children;\n  };\n  /**\n   * @deprecated\n   * compatible with G 3.0\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.getFirst = function () {\n    return this.firstElementChild;\n  };\n  /**\n   * @deprecated\n   * compatible with G 3.0\n   * @deprecated\n   * get last child group/shape\n   */\n\n\n  DisplayObject.prototype.getLast = function () {\n    return this.lastElementChild;\n  };\n  /**\n   * @deprecated\n   * compatible with G 3.0\n   * @deprecated\n   * get child group/shape by index\n   */\n\n\n  DisplayObject.prototype.getChildByIndex = function (index) {\n    return this.children[index] || null;\n  };\n  /**\n   * compatible with G 3.0\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.add = function (child, index) {\n    return this.appendChild(child, index);\n  };\n  /**\n   * @alias style.clipPath\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.setClip = function (clipPath) {\n    this.style.clipPath = clipPath;\n  };\n  /**\n   * @alias style.clipPath\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.getClip = function () {\n    return this.style.clipPath || null;\n  };\n  /**\n   * compatible with G 3.0\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.set = function (name, value) {\n    this.config[name] = value;\n  };\n  /**\n   * compatible with G 3.0\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.get = function (name) {\n    return this.config[name];\n  };\n  /**\n   * compatible with G 3.0\n   * @alias object.config\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.getConfig = function () {\n    return this.config;\n  };\n\n  DisplayObject.prototype.attr = function () {\n    var _this = this;\n\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n\n    var _a = __read(args, 2),\n        name = _a[0],\n        value = _a[1];\n\n    if (!name) {\n      return this.attributes;\n    }\n\n    if (isObject(name)) {\n      Object.keys(name).forEach(function (key) {\n        _this.setAttribute(key, name[key]);\n      });\n      return this;\n    }\n\n    if (args.length === 2) {\n      this.setAttribute(name, value);\n      return this;\n    }\n\n    return this.attributes[name];\n  };\n  /**\n   * @alias setPosition\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.moveTo = function (position, y, z) {\n    if (y === void 0) {\n      y = 0;\n    }\n\n    if (z === void 0) {\n      z = 0;\n    }\n\n    this.setPosition(position, y, z);\n    return this;\n  };\n  /**\n   * @alias setPosition\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.move = function (position, y, z) {\n    if (y === void 0) {\n      y = 0;\n    }\n\n    if (z === void 0) {\n      z = 0;\n    }\n\n    this.setPosition(position, y, z);\n    return this;\n  };\n  /**\n   * @alias style.zIndex\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.setZIndex = function (zIndex) {\n    this.style.zIndex = zIndex;\n    return this;\n  };\n  /**\n   * return 3x3 matrix in world space\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.getMatrix = function (transformMat4) {\n    var transform = transformMat4 || this.getWorldTransform();\n\n    var _a = __read(mat4.getTranslation(vec3.create(), transform), 2),\n        tx = _a[0],\n        ty = _a[1];\n\n    var _b = __read(mat4.getScaling(vec3.create(), transform), 2),\n        sx = _b[0],\n        sy = _b[1];\n\n    var rotation = mat4.getRotation(quat.create(), transform); // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n    var _c = __read(getEuler(vec3.create(), rotation), 3),\n        eux = _c[0],\n        euy = _c[1],\n        euz = _c[2]; // gimbal lock at 90 degrees\n\n\n    return fromRotationTranslationScale(eux || euz, tx, ty, sx, sy);\n  };\n  /**\n   * return 3x3 matrix in local space\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.getLocalMatrix = function () {\n    return this.getMatrix(this.getLocalTransform());\n  };\n  /**\n   * set 3x3 matrix in world space\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.setMatrix = function (mat) {\n    var _a = __read(decompose(mat), 5),\n        tx = _a[0],\n        ty = _a[1],\n        scalingX = _a[2],\n        scalingY = _a[3],\n        angle = _a[4];\n\n    this.setEulerAngles(angle).setPosition(tx, ty).setLocalScale(scalingX, scalingY);\n  };\n  /**\n   * set 3x3 matrix in local space\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.setLocalMatrix = function (mat) {\n    var _a = __read(decompose(mat), 5),\n        tx = _a[0],\n        ty = _a[1],\n        scalingX = _a[2],\n        scalingY = _a[3],\n        angle = _a[4];\n\n    this.setLocalEulerAngles(angle).setLocalPosition(tx, ty).setLocalScale(scalingX, scalingY);\n  };\n\n  return DisplayObject;\n}(Element);\n\nexport { DisplayObject };","map":{"version":3,"sources":["/Users/dennis.zhang/Desktop/其它代码库/moa-flow/node_modules/@antv/g/es/display-objects/DisplayObject.js"],"names":["__assign","__extends","__read","__spreadArray","GlobalContainer","isEqual","isNil","isObject","isUndefined","mat4","quat","vec3","DisplayObjectPool","KeyframeEffect","Element","ElementEvent","Shape","createVec3","decompose","formatAttribute","fromRotationTranslationScale","getEuler","rad2deg","dirtifyToRoot","MutationEvent","Rectangle","StyleValueRegistry","CSSUnitValue","DEFAULT_STYLE_PROPS","x","y","z","anchor","opacity","fillOpacity","strokeOpacity","fill","stroke","transformOrigin","visibility","pointerEvents","lineCap","lineJoin","fontSize","fontFamily","fontStyle","fontWeight","fontVariant","textAlign","textBaseline","textTransform","DisplayObject","_super","config","_this","_a","_b","_c","call","styleValueRegistry","get","activeAnimations","interactive","capture","id","name","className","class","nodeName","type","GROUP","style","zIndex","attrs","visible","Proxy","attributes","setProperty","propertyName","value","setAttribute","getPropertyValue","getAttribute","removeProperty","removeAttribute","item","target","set","_","prop","initAttributes","add","entity","prototype","destroy","remove","getAnimations","forEach","animation","cancel","cloneNode","deep","cloned","constructor","children","child","clonedChild","appendChild","renderable","processProperties","dirty","force","attributeName","attributeValue","internalSetAttribute","parseOptions","oldValue","oldParsedValue","parsedStyle","clipPathTargets","length","dispatchEvent","ATTR_MODIFIED","MODIFICATION","getBBox","aabb","getBounds","getMin","left","top","getMax","right","bottom","setOrigin","position","sceneGraphService","getOrigin","setPosition","syncLocalPosition","setLocalPosition","translate","translateLocal","getPosition","getLocalPosition","scale","scaling","scaleLocal","setLocalScale","getLocalScale","getScale","getEulerAngles","create","getWorldTransform","ex","ey","ez","getLocalEulerAngles","getLocalRotation","setEulerAngles","setLocalEulerAngles","rotateLocal","rotate","setRotation","rotation","w","setLocalRotation","getRotation","getLocalTransform","resetLocalTransform","localPosition","animate","keyframes","options","timeline","ownerDocument","transform","play","show","hide","isVisible","Object","defineProperty","isInteractive","b","enumerable","configurable","isCulled","cullable","toFront","parentNode","Math","max","apply","map","Number","toBack","min","getCount","childElementCount","getParent","parentElement","getChildren","getFirst","firstElementChild","getLast","lastElementChild","getChildByIndex","index","setClip","clipPath","getClip","getConfig","attr","args","_i","arguments","keys","key","moveTo","move","setZIndex","getMatrix","transformMat4","getTranslation","tx","ty","getScaling","sx","sy","eux","euy","euz","getLocalMatrix","setMatrix","mat","scalingX","scalingY","angle","setLocalMatrix"],"mappings":"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","sourcesContent":["import { __assign, __extends, __read, __spreadArray } from \"tslib\";\nimport { GlobalContainer } from 'mana-syringe';\nimport { isEqual, isNil, isObject, isUndefined } from 'lodash-es';\nimport { mat4, quat, vec3 } from 'gl-matrix';\nimport { DisplayObjectPool } from '../DisplayObjectPool';\nimport { KeyframeEffect } from '../dom/KeyframeEffect';\nimport { Element } from '../dom/Element';\nimport { ElementEvent } from '../dom/interfaces';\nimport { Shape } from '../types';\nimport { createVec3, decompose, formatAttribute, fromRotationTranslationScale, getEuler, rad2deg } from '../utils';\nimport { dirtifyToRoot } from '../services';\nimport { MutationEvent } from '../dom/MutationEvent';\nimport { Rectangle } from '../shapes';\nimport { StyleValueRegistry } from '../css/StyleValueRegistry';\nimport { CSSUnitValue } from '../css';\nvar DEFAULT_STYLE_PROPS = {\n  x: '',\n  y: '',\n  z: '',\n  anchor: [0, 0],\n  opacity: '',\n  fillOpacity: '',\n  strokeOpacity: '',\n  fill: '',\n  stroke: '',\n  transformOrigin: '',\n  visibility: '',\n  pointerEvents: '',\n  lineCap: '',\n  lineJoin: '',\n  fontSize: '',\n  fontFamily: '',\n  fontStyle: '',\n  fontWeight: '',\n  fontVariant: '',\n  textAlign: '',\n  textBaseline: '',\n  textTransform: ''\n};\n/**\n * prototype chains: DisplayObject -> Element -> Node -> EventTarget\n *\n * mixins: Animatable, Transformable, Visible\n * @see https://github.com/tannerntannern/ts-mixer/blob/master/README.md#mixing-generic-classes\n *\n * Provide abilities in scene graph, such as:\n * * transform `translate/rotate/scale`\n * * add/remove child\n * * visibility and z-index\n *\n * Those abilities are implemented with those components: `Transform/Sortable/Visible`.\n *\n * Emit following events:\n * * init\n * * destroy\n * * attributeChanged\n */\n\nvar DisplayObject =\n/** @class */\nfunction (_super) {\n  __extends(DisplayObject, _super);\n\n  function DisplayObject(config) {\n    var _this = this;\n\n    var _a, _b, _c;\n\n    _this = _super.call(this) || this;\n    _this.styleValueRegistry = GlobalContainer.get(StyleValueRegistry);\n    /**\n     * push to active animations after calling `animate()`\n     */\n\n    _this.activeAnimations = []; // assign name, id to config\n    // eg. group.get('name')\n\n    _this.config = config; // compatible with G 3.0\n\n    _this.config.interactive = (_a = _this.config.capture) !== null && _a !== void 0 ? _a : _this.config.interactive; // init scene graph node\n\n    _this.id = _this.config.id || '';\n    _this.name = _this.config.name || '';\n\n    if (_this.config.className || _this.config.class) {\n      _this.className = _this.config.className || _this.config.class;\n    }\n\n    _this.nodeName = _this.config.type || Shape.GROUP; // compatible with G 3.0\n\n    _this.config.style = __assign(__assign(__assign(__assign({}, DEFAULT_STYLE_PROPS), {\n      zIndex: (_b = _this.config.zIndex) !== null && _b !== void 0 ? _b : 0,\n      interactive: (_c = _this.config.interactive) !== null && _c !== void 0 ? _c : true\n    }), _this.config.style), _this.config.attrs);\n\n    if (!isNil(_this.config.visible)) {\n      _this.config.style.visibility = _this.config.visible === false ? 'hidden' : 'visible';\n    }\n\n    if (!isNil(_this.config.interactive)) {\n      _this.config.style.pointerEvents = _this.config.interactive === false ? 'none' : 'auto';\n    }\n\n    _this.style = new Proxy(__assign(__assign({}, _this.attributes), {\n      setProperty: function setProperty(propertyName, value) {\n        _this.setAttribute(propertyName, value);\n      },\n      getPropertyValue: function getPropertyValue(propertyName) {\n        return _this.getAttribute(propertyName);\n      },\n      removeProperty: function removeProperty(propertyName) {\n        _this.removeAttribute(propertyName);\n      },\n      item: function item() {\n        return '';\n      }\n    }), {\n      get: function get(target, name) {\n        if (name in target) {\n          return target[name];\n        }\n\n        return _this.getAttribute(name);\n      },\n      set: function set(_, prop, value) {\n        _this.setAttribute(prop, value);\n\n        return true;\n      }\n    });\n\n    _this.initAttributes(_this.config.style); // insert this group into pool\n\n\n    GlobalContainer.get(DisplayObjectPool).add(_this.entity, _this);\n    return _this;\n  }\n\n  DisplayObject.prototype.destroy = function () {\n    _super.prototype.destroy.call(this); // remove from into pool\n\n\n    GlobalContainer.get(DisplayObjectPool).remove(this.entity); // stop all active animations\n\n    this.getAnimations().forEach(function (animation) {\n      animation.cancel();\n    });\n  };\n\n  DisplayObject.prototype.cloneNode = function (deep) {\n    var cloned = new this.constructor({\n      // copy id & name\n      // @see https://developer.mozilla.org/en-US/docs/Web/API/Node/cloneNode#notes\n      id: this.id,\n      name: this.name,\n      className: this.name,\n      interactive: this.interactive,\n      style: __assign({}, this.attributes)\n    });\n\n    if (deep) {\n      this.children.forEach(function (child) {\n        var clonedChild = child.cloneNode(deep);\n        cloned.appendChild(clonedChild);\n      });\n    }\n\n    return cloned;\n  };\n\n  DisplayObject.prototype.initAttributes = function (attributes) {\n    if (attributes === void 0) {\n      attributes = {};\n    }\n\n    var renderable = this.renderable;\n    this.styleValueRegistry.processProperties(this, attributes); // redraw at next frame\n\n    renderable.dirty = true;\n  };\n\n  DisplayObject.prototype.setAttribute = function (name, value, force) {\n    if (force === void 0) {\n      force = false;\n    }\n\n    var _a = __read(formatAttribute(name, value), 2),\n        attributeName = _a[0],\n        attributeValue = _a[1]; // ignore undefined value\n\n\n    if (isUndefined(value)) {\n      return;\n    }\n\n    if (force || !isEqual(attributeValue, this.attributes[attributeName])) {\n      this.internalSetAttribute(attributeName, attributeValue);\n\n      _super.prototype.setAttribute.call(this, attributeName, attributeValue);\n    }\n  };\n  /**\n   * called when attributes get changed or initialized\n   */\n\n\n  DisplayObject.prototype.internalSetAttribute = function (name, value, parseOptions) {\n    var _a;\n\n    var _this = this;\n\n    if (parseOptions === void 0) {\n      parseOptions = {};\n    }\n\n    var renderable = this.renderable;\n    var oldValue = this.attributes[name];\n    var oldParsedValue = this.parsedStyle[name];\n    this.styleValueRegistry.processProperties(this, (_a = {}, _a[name] = value, _a), parseOptions); // inform clip path targets\n\n    if (this.attributes.clipPathTargets && this.attributes.clipPathTargets.length) {\n      this.attributes.clipPathTargets.forEach(function (target) {\n        dirtifyToRoot(target);\n        target.dispatchEvent(new MutationEvent(ElementEvent.ATTR_MODIFIED, target, _this, _this, 'clipPath', MutationEvent.MODIFICATION, _this, _this));\n      });\n    } // redraw at next frame\n\n\n    renderable.dirty = true;\n    this.dispatchEvent(new MutationEvent(ElementEvent.ATTR_MODIFIED, this, oldValue, value, name, MutationEvent.MODIFICATION, oldParsedValue, this.parsedStyle[name]));\n  }; // #region transformable\n\n  /**\n   * returns different values than getBoundingClientRect(), as the latter returns value relative to the viewport\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/SVGGraphicsElement/getBBox\n   *\n   * FIXME: It is worth noting that getBBox responds to original untransformed values of a drawn object.\n   * @see https://www.w3.org/Graphics/SVG/IG/resources/svgprimer.html#getBBox\n   */\n\n\n  DisplayObject.prototype.getBBox = function () {\n    var aabb = this.getBounds();\n\n    var _a = __read(aabb.getMin(), 2),\n        left = _a[0],\n        top = _a[1];\n\n    var _b = __read(aabb.getMax(), 2),\n        right = _b[0],\n        bottom = _b[1];\n\n    return new Rectangle(left, top, right - left, bottom - top);\n  };\n\n  DisplayObject.prototype.setOrigin = function (position, y, z) {\n    if (y === void 0) {\n      y = 0;\n    }\n\n    if (z === void 0) {\n      z = 0;\n    }\n\n    this.sceneGraphService.setOrigin(this, createVec3(position, y, z));\n    return this;\n  };\n\n  DisplayObject.prototype.getOrigin = function () {\n    return this.sceneGraphService.getOrigin(this);\n  };\n  /**\n   * set position in world space\n   */\n\n\n  DisplayObject.prototype.setPosition = function (position, y, z) {\n    if (y === void 0) {\n      y = 0;\n    }\n\n    if (z === void 0) {\n      z = 0;\n    }\n\n    this.sceneGraphService.setPosition(this, createVec3(position, y, z));\n    this.syncLocalPosition();\n    return this;\n  };\n  /**\n   * set position in local space\n   */\n\n\n  DisplayObject.prototype.setLocalPosition = function (position, y, z) {\n    if (y === void 0) {\n      y = 0;\n    }\n\n    if (z === void 0) {\n      z = 0;\n    }\n\n    this.sceneGraphService.setLocalPosition(this, createVec3(position, y, z));\n    this.syncLocalPosition();\n    return this;\n  };\n  /**\n   * translate in world space\n   */\n\n\n  DisplayObject.prototype.translate = function (position, y, z) {\n    if (y === void 0) {\n      y = 0;\n    }\n\n    if (z === void 0) {\n      z = 0;\n    }\n\n    this.sceneGraphService.translate(this, createVec3(position, y, z));\n    this.syncLocalPosition();\n    return this;\n  };\n  /**\n   * translate in local space\n   */\n\n\n  DisplayObject.prototype.translateLocal = function (position, y, z) {\n    if (y === void 0) {\n      y = 0;\n    }\n\n    if (z === void 0) {\n      z = 0;\n    }\n\n    this.sceneGraphService.translateLocal(this, createVec3(position, y, z));\n    this.syncLocalPosition();\n    return this;\n  };\n\n  DisplayObject.prototype.getPosition = function () {\n    return this.sceneGraphService.getPosition(this);\n  };\n\n  DisplayObject.prototype.getLocalPosition = function () {\n    return this.sceneGraphService.getLocalPosition(this);\n  };\n  /**\n   * compatible with G 3.0\n   *\n   * scaling in local space\n   * scale(10) = scale(10, 10, 10)\n   *\n   * we can't set scale in world space\n   */\n\n\n  DisplayObject.prototype.scale = function (scaling, y, z) {\n    return this.scaleLocal(scaling, y, z);\n  };\n\n  DisplayObject.prototype.scaleLocal = function (scaling, y, z) {\n    if (typeof scaling === 'number') {\n      y = y || scaling;\n      z = z || scaling;\n      scaling = createVec3(scaling, y, z);\n    }\n\n    this.sceneGraphService.scaleLocal(this, scaling);\n    return this;\n  };\n  /**\n   * set scaling in local space\n   */\n\n\n  DisplayObject.prototype.setLocalScale = function (scaling, y, z) {\n    if (typeof scaling === 'number') {\n      y = y || scaling;\n      z = z || scaling;\n      scaling = createVec3(scaling, y, z);\n    }\n\n    this.sceneGraphService.setLocalScale(this, scaling);\n    return this;\n  };\n  /**\n   * get scaling in local space\n   */\n\n\n  DisplayObject.prototype.getLocalScale = function () {\n    return this.sceneGraphService.getLocalScale(this);\n  };\n  /**\n   * get scaling in world space\n   */\n\n\n  DisplayObject.prototype.getScale = function () {\n    return this.sceneGraphService.getScale(this);\n  };\n  /**\n   * only return degrees of Z axis in world space\n   */\n\n\n  DisplayObject.prototype.getEulerAngles = function () {\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    var _a = __read(getEuler(vec3.create(), this.sceneGraphService.getWorldTransform(this)), 3),\n        ex = _a[0],\n        ey = _a[1],\n        ez = _a[2];\n\n    return rad2deg(ez);\n  };\n  /**\n   * only return degrees of Z axis in local space\n   */\n\n\n  DisplayObject.prototype.getLocalEulerAngles = function () {\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    var _a = __read(getEuler(vec3.create(), this.sceneGraphService.getLocalRotation(this)), 3),\n        ex = _a[0],\n        ey = _a[1],\n        ez = _a[2];\n\n    return rad2deg(ez);\n  };\n  /**\n   * set euler angles(degrees) in world space\n   */\n\n\n  DisplayObject.prototype.setEulerAngles = function (z) {\n    this.sceneGraphService.setEulerAngles(this, 0, 0, z);\n    return this;\n  };\n  /**\n   * set euler angles(degrees) in local space\n   */\n\n\n  DisplayObject.prototype.setLocalEulerAngles = function (z) {\n    this.sceneGraphService.setLocalEulerAngles(this, 0, 0, z);\n    return this;\n  };\n\n  DisplayObject.prototype.rotateLocal = function (x, y, z) {\n    if (isNil(y) && isNil(z)) {\n      this.sceneGraphService.rotateLocal(this, 0, 0, x);\n    } else {\n      this.sceneGraphService.rotateLocal(this, x, y, z);\n    }\n\n    return this;\n  };\n\n  DisplayObject.prototype.rotate = function (x, y, z) {\n    if (isNil(y) && isNil(z)) {\n      this.sceneGraphService.rotate(this, 0, 0, x);\n    } else {\n      this.sceneGraphService.rotate(this, x, y, z);\n    }\n\n    return this;\n  };\n\n  DisplayObject.prototype.setRotation = function (rotation, y, z, w) {\n    this.sceneGraphService.setRotation(this, rotation, y, z, w);\n    return this;\n  };\n\n  DisplayObject.prototype.setLocalRotation = function (rotation, y, z, w) {\n    this.sceneGraphService.setLocalRotation(this, rotation, y, z, w);\n    return this;\n  };\n\n  DisplayObject.prototype.getRotation = function () {\n    return this.sceneGraphService.getRotation(this);\n  };\n\n  DisplayObject.prototype.getLocalRotation = function () {\n    return this.sceneGraphService.getLocalRotation(this);\n  };\n\n  DisplayObject.prototype.getLocalTransform = function () {\n    return this.sceneGraphService.getLocalTransform(this);\n  };\n\n  DisplayObject.prototype.getWorldTransform = function () {\n    return this.sceneGraphService.getWorldTransform(this);\n  };\n\n  DisplayObject.prototype.resetLocalTransform = function () {\n    this.sceneGraphService.resetLocalTransform(this);\n  };\n  /**\n   * sync style.x/y when local position changed\n   *\n   * Mixins may not declare private/protected properties\n   * however, you can use ES2020 private fields\n   */\n\n\n  DisplayObject.prototype.syncLocalPosition = function () {\n    var localPosition = this.getLocalPosition();\n    this.attributes.x = localPosition[0];\n    this.attributes.y = localPosition[1];\n    this.attributes.z = localPosition[2]; // should not affect computed style\n\n    this.parsedStyle.x = new CSSUnitValue(this.attributes.x, 'px');\n    this.parsedStyle.y = new CSSUnitValue(this.attributes.y, 'px');\n    this.parsedStyle.z = new CSSUnitValue(this.attributes.z, 'px');\n  }; // #endregion transformable\n  // #region animatable\n\n  /**\n   * returns an array of all Animation objects affecting this element\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/getAnimations\n   */\n\n\n  DisplayObject.prototype.getAnimations = function () {\n    return this.activeAnimations;\n  };\n  /**\n   * create an animation with WAAPI\n   * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/animate\n   */\n\n\n  DisplayObject.prototype.animate = function (keyframes, options) {\n    var _a, _b;\n\n    var timeline = (_a = this.ownerDocument) === null || _a === void 0 ? void 0 : _a.timeline; // accounte for clip path, use target's timeline\n\n    if (this.attributes.clipPathTargets && this.attributes.clipPathTargets.length) {\n      var target = this.attributes.clipPathTargets[0];\n      timeline = (_b = target.ownerDocument) === null || _b === void 0 ? void 0 : _b.timeline;\n    } // clear old parsed transform\n\n\n    delete this.parsedStyle.transform;\n\n    if (timeline) {\n      return timeline.play(new KeyframeEffect(this, keyframes, options));\n    }\n\n    return null;\n  }; // #endregion animatable\n  // #region visible\n\n  /**\n   * show group, which will also change visibility of its children in sceneGraphNode\n   *\n   * @deprecated\n   * @see https://developer.mozilla.org/en-US/docs/Web/CSS/visibility\n   */\n\n\n  DisplayObject.prototype.show = function () {\n    this.style.visibility = 'visible';\n  };\n  /**\n   * @deprecated\n   * hide group, which will also change visibility of its children in sceneGraphNode\n   */\n\n\n  DisplayObject.prototype.hide = function () {\n    this.style.visibility = 'hidden';\n  };\n  /**\n   * shortcut for Used value of `visibility`\n   */\n\n\n  DisplayObject.prototype.isVisible = function () {\n    var _a, _b;\n\n    return ((_b = (_a = this.parsedStyle) === null || _a === void 0 ? void 0 : _a.visibility) === null || _b === void 0 ? void 0 : _b.value) === 'visible';\n  };\n\n  Object.defineProperty(DisplayObject.prototype, \"interactive\", {\n    get: function get() {\n      return this.isInteractive();\n    },\n    set: function set(b) {\n      this.style.pointerEvents = b ? 'auto' : 'none';\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  DisplayObject.prototype.isInteractive = function () {\n    var _a, _b;\n\n    return ((_b = (_a = this.parsedStyle) === null || _a === void 0 ? void 0 : _a.pointerEvents) === null || _b === void 0 ? void 0 : _b.value) !== 'none';\n  };\n\n  DisplayObject.prototype.isCulled = function () {\n    return !!(this.cullable && this.cullable.isCulled());\n  };\n  /**\n   * bring to front in current group\n   */\n\n\n  DisplayObject.prototype.toFront = function () {\n    if (this.parentNode) {\n      this.style.zIndex = Math.max.apply(Math, __spreadArray([], __read(this.parentNode.children.map(function (child) {\n        return Number(child.style.zIndex);\n      })), false)) + 1;\n    }\n\n    return this;\n  };\n  /**\n   * send to back in current group\n   */\n\n\n  DisplayObject.prototype.toBack = function () {\n    if (this.parentNode) {\n      this.style.zIndex = Math.min.apply(Math, __spreadArray([], __read(this.parentNode.children.map(function (child) {\n        return Number(child.style.zIndex);\n      })), false)) - 1;\n    }\n\n    return this;\n  }; // #endregion visible\n  // #region deprecated\n\n  /**\n   * @deprecated\n   * compatible with G 3.0\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.getCount = function () {\n    return this.childElementCount;\n  };\n  /**\n   * @deprecated\n   * compatible with G 3.0\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.getParent = function () {\n    return this.parentElement;\n  };\n  /**\n   * @deprecated\n   * compatible with G 3.0\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.getChildren = function () {\n    return this.children;\n  };\n  /**\n   * @deprecated\n   * compatible with G 3.0\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.getFirst = function () {\n    return this.firstElementChild;\n  };\n  /**\n   * @deprecated\n   * compatible with G 3.0\n   * @deprecated\n   * get last child group/shape\n   */\n\n\n  DisplayObject.prototype.getLast = function () {\n    return this.lastElementChild;\n  };\n  /**\n   * @deprecated\n   * compatible with G 3.0\n   * @deprecated\n   * get child group/shape by index\n   */\n\n\n  DisplayObject.prototype.getChildByIndex = function (index) {\n    return this.children[index] || null;\n  };\n  /**\n   * compatible with G 3.0\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.add = function (child, index) {\n    return this.appendChild(child, index);\n  };\n  /**\n   * @alias style.clipPath\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.setClip = function (clipPath) {\n    this.style.clipPath = clipPath;\n  };\n  /**\n   * @alias style.clipPath\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.getClip = function () {\n    return this.style.clipPath || null;\n  };\n  /**\n   * compatible with G 3.0\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.set = function (name, value) {\n    this.config[name] = value;\n  };\n  /**\n   * compatible with G 3.0\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.get = function (name) {\n    return this.config[name];\n  };\n  /**\n   * compatible with G 3.0\n   * @alias object.config\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.getConfig = function () {\n    return this.config;\n  };\n\n  DisplayObject.prototype.attr = function () {\n    var _this = this;\n\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n\n    var _a = __read(args, 2),\n        name = _a[0],\n        value = _a[1];\n\n    if (!name) {\n      return this.attributes;\n    }\n\n    if (isObject(name)) {\n      Object.keys(name).forEach(function (key) {\n        _this.setAttribute(key, name[key]);\n      });\n      return this;\n    }\n\n    if (args.length === 2) {\n      this.setAttribute(name, value);\n      return this;\n    }\n\n    return this.attributes[name];\n  };\n  /**\n   * @alias setPosition\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.moveTo = function (position, y, z) {\n    if (y === void 0) {\n      y = 0;\n    }\n\n    if (z === void 0) {\n      z = 0;\n    }\n\n    this.setPosition(position, y, z);\n    return this;\n  };\n  /**\n   * @alias setPosition\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.move = function (position, y, z) {\n    if (y === void 0) {\n      y = 0;\n    }\n\n    if (z === void 0) {\n      z = 0;\n    }\n\n    this.setPosition(position, y, z);\n    return this;\n  };\n  /**\n   * @alias style.zIndex\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.setZIndex = function (zIndex) {\n    this.style.zIndex = zIndex;\n    return this;\n  };\n  /**\n   * return 3x3 matrix in world space\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.getMatrix = function (transformMat4) {\n    var transform = transformMat4 || this.getWorldTransform();\n\n    var _a = __read(mat4.getTranslation(vec3.create(), transform), 2),\n        tx = _a[0],\n        ty = _a[1];\n\n    var _b = __read(mat4.getScaling(vec3.create(), transform), 2),\n        sx = _b[0],\n        sy = _b[1];\n\n    var rotation = mat4.getRotation(quat.create(), transform); // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n    var _c = __read(getEuler(vec3.create(), rotation), 3),\n        eux = _c[0],\n        euy = _c[1],\n        euz = _c[2]; // gimbal lock at 90 degrees\n\n\n    return fromRotationTranslationScale(eux || euz, tx, ty, sx, sy);\n  };\n  /**\n   * return 3x3 matrix in local space\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.getLocalMatrix = function () {\n    return this.getMatrix(this.getLocalTransform());\n  };\n  /**\n   * set 3x3 matrix in world space\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.setMatrix = function (mat) {\n    var _a = __read(decompose(mat), 5),\n        tx = _a[0],\n        ty = _a[1],\n        scalingX = _a[2],\n        scalingY = _a[3],\n        angle = _a[4];\n\n    this.setEulerAngles(angle).setPosition(tx, ty).setLocalScale(scalingX, scalingY);\n  };\n  /**\n   * set 3x3 matrix in local space\n   * @deprecated\n   */\n\n\n  DisplayObject.prototype.setLocalMatrix = function (mat) {\n    var _a = __read(decompose(mat), 5),\n        tx = _a[0],\n        ty = _a[1],\n        scalingX = _a[2],\n        scalingY = _a[3],\n        angle = _a[4];\n\n    this.setLocalEulerAngles(angle).setLocalPosition(tx, ty).setLocalScale(scalingX, scalingY);\n  };\n\n  return DisplayObject;\n}(Element);\n\nexport { DisplayObject };"]},"metadata":{},"sourceType":"module"}