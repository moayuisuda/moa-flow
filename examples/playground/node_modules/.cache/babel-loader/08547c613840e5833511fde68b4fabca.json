{"ast":null,"code":"import { __read, __spreadArray } from \"tslib\";\nimport { Animation } from './Animation';\nexport function compareAnimations(leftAnimation, rightAnimation) {\n  return Number(leftAnimation.id) - Number(rightAnimation.id);\n}\n/**\n * @see https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/web-animations-js/index.d.ts\n */\n\nvar AnimationTimeline =\n/** @class */\nfunction () {\n  function AnimationTimeline(document) {\n    var _this = this;\n\n    this.document = document;\n    /**\n     * all active animations\n     */\n\n    this.animations = [];\n    this.ticking = false;\n    this.timelineTicking = false;\n    this.hasRestartedThisFrame = false;\n    this.animationsWithPromises = [];\n    this.inTick = false;\n    this.pendingEffects = [];\n    this.currentTime = null;\n    this.rafId = 0;\n    this.rafCallbacks = [];\n\n    this.webAnimationsNextTick = function (t) {\n      _this.currentTime = t;\n\n      _this.discardAnimations();\n\n      if (_this.animations.length === 0) {\n        _this.timelineTicking = false;\n      } else {\n        _this.requestAnimationFrame(_this.webAnimationsNextTick);\n      }\n    };\n\n    this.processRafCallbacks = function (t) {\n      var processing = _this.rafCallbacks;\n      _this.rafCallbacks = [];\n      if (t < Number(_this.currentTime)) t = Number(_this.currentTime);\n\n      _this.animations.sort(compareAnimations);\n\n      _this.animations = _this.tick(t, true, _this.animations)[0];\n      processing.forEach(function (entry) {\n        entry[1](t);\n      });\n\n      _this.applyPendingEffects();\n    };\n  }\n\n  AnimationTimeline.prototype.getAnimations = function () {\n    this.discardAnimations();\n    return this.animations.slice();\n  };\n\n  AnimationTimeline.prototype.isTicking = function () {\n    return this.inTick;\n  };\n\n  AnimationTimeline.prototype.play = function (effect) {\n    var animation = new Animation(effect, this);\n    this.animations.push(animation);\n    this.restartWebAnimationsNextTick();\n    animation.updatePromises();\n    animation.play();\n    animation.updatePromises();\n    return animation;\n  }; // RAF is supposed to be the last script to occur before frame rendering but not\n  // all browsers behave like this. This function is for synchonously updating an\n  // animation's effects whenever its state is mutated by script to work around\n  // incorrect script execution ordering by the browser.\n\n\n  AnimationTimeline.prototype.applyDirtiedAnimation = function (animation) {\n    var _this = this;\n\n    if (this.inTick) {\n      return;\n    } // update active animations in displayobject\n\n\n    animation.markTarget();\n    var animations = animation.targetAnimations();\n    animations.sort(compareAnimations); // clear inactive animations\n\n    var inactiveAnimations = this.tick(Number(this.currentTime), false, animations.slice())[1];\n    inactiveAnimations.forEach(function (animation) {\n      var index = _this.animations.indexOf(animation);\n\n      if (index !== -1) {\n        _this.animations.splice(index, 1);\n      }\n    });\n    this.applyPendingEffects();\n  };\n\n  AnimationTimeline.prototype.restart = function () {\n    if (!this.ticking) {\n      this.ticking = true;\n      this.requestAnimationFrame(function () {});\n      this.hasRestartedThisFrame = true;\n    }\n\n    return this.hasRestartedThisFrame;\n  };\n\n  AnimationTimeline.prototype.destroy = function () {\n    this.document.defaultView.cancelAnimationFrame(this.frameId);\n  };\n\n  AnimationTimeline.prototype.applyPendingEffects = function () {\n    this.pendingEffects.forEach(function (effect) {\n      effect === null || effect === void 0 ? void 0 : effect.applyInterpolations();\n    });\n    this.pendingEffects = [];\n  };\n\n  AnimationTimeline.prototype.updateAnimationsPromises = function () {\n    this.animationsWithPromises = this.animationsWithPromises.filter(function (animation) {\n      return animation.updatePromises();\n    });\n  };\n\n  AnimationTimeline.prototype.discardAnimations = function () {\n    this.updateAnimationsPromises();\n    this.animations = this.animations.filter(function (animation) {\n      return animation.playState !== 'finished' && animation.playState !== 'idle';\n    });\n  };\n\n  AnimationTimeline.prototype.restartWebAnimationsNextTick = function () {\n    if (!this.timelineTicking) {\n      this.timelineTicking = true;\n      this.requestAnimationFrame(this.webAnimationsNextTick);\n    }\n  };\n\n  AnimationTimeline.prototype.rAF = function (f) {\n    var id = this.rafId++;\n\n    if (this.rafCallbacks.length === 0) {\n      this.frameId = this.document.defaultView.requestAnimationFrame(this.processRafCallbacks);\n    }\n\n    this.rafCallbacks.push([id, f]);\n    return id;\n  };\n\n  AnimationTimeline.prototype.requestAnimationFrame = function (f) {\n    var _this = this;\n\n    return this.rAF(function (x) {\n      _this.updateAnimationsPromises();\n\n      f(x);\n\n      _this.updateAnimationsPromises();\n    });\n  };\n\n  AnimationTimeline.prototype.tick = function (t, isAnimationFrame, updatingAnimations) {\n    var _a, _b;\n\n    var _this = this;\n\n    this.inTick = true;\n    this.hasRestartedThisFrame = false;\n    this.currentTime = t;\n    this.ticking = false;\n    var newPendingClears = [];\n    var newPendingEffects = [];\n    var activeAnimations = [];\n    var inactiveAnimations = [];\n    updatingAnimations.forEach(function (animation) {\n      animation.tick(t, isAnimationFrame);\n\n      if (!animation._inEffect) {\n        newPendingClears.push(animation.effect);\n        animation.unmarkTarget();\n      } else {\n        newPendingEffects.push(animation.effect);\n        animation.markTarget();\n      }\n\n      if (animation._needsTick) _this.ticking = true;\n      var alive = animation._inEffect || animation._needsTick;\n      animation._inTimeline = alive;\n\n      if (alive) {\n        activeAnimations.push(animation);\n      } else {\n        inactiveAnimations.push(animation);\n      }\n    });\n\n    (_a = this.pendingEffects).push.apply(_a, __spreadArray([], __read(newPendingClears), false));\n\n    (_b = this.pendingEffects).push.apply(_b, __spreadArray([], __read(newPendingEffects), false));\n\n    if (this.ticking) this.requestAnimationFrame(function () {});\n    this.inTick = false;\n    return [activeAnimations, inactiveAnimations];\n  };\n\n  return AnimationTimeline;\n}();\n\nexport { AnimationTimeline };","map":{"version":3,"sources":["/Users/dennis.zhang/Desktop/其它代码库/moa-flow/node_modules/@antv/g/es/dom/AnimationTimeline.js"],"names":["__read","__spreadArray","Animation","compareAnimations","leftAnimation","rightAnimation","Number","id","AnimationTimeline","document","_this","animations","ticking","timelineTicking","hasRestartedThisFrame","animationsWithPromises","inTick","pendingEffects","currentTime","rafId","rafCallbacks","webAnimationsNextTick","t","discardAnimations","length","requestAnimationFrame","processRafCallbacks","processing","sort","tick","forEach","entry","applyPendingEffects","prototype","getAnimations","slice","isTicking","play","effect","animation","push","restartWebAnimationsNextTick","updatePromises","applyDirtiedAnimation","markTarget","targetAnimations","inactiveAnimations","index","indexOf","splice","restart","destroy","defaultView","cancelAnimationFrame","frameId","applyInterpolations","updateAnimationsPromises","filter","playState","rAF","f","x","isAnimationFrame","updatingAnimations","_a","_b","newPendingClears","newPendingEffects","activeAnimations","_inEffect","unmarkTarget","_needsTick","alive","_inTimeline","apply"],"mappings":"AAAA,SAASA,MAAT,EAAiBC,aAAjB,QAAsC,OAAtC;AACA,SAASC,SAAT,QAA0B,aAA1B;AACA,OAAO,SAASC,iBAAT,CAA2BC,aAA3B,EAA0CC,cAA1C,EAA0D;AAC/D,SAAOC,MAAM,CAACF,aAAa,CAACG,EAAf,CAAN,GAA2BD,MAAM,CAACD,cAAc,CAACE,EAAhB,CAAxC;AACD;AACD;AACA;AACA;;AAEA,IAAIC,iBAAiB;AACrB;AACA,YAAY;AACV,WAASA,iBAAT,CAA2BC,QAA3B,EAAqC;AACnC,QAAIC,KAAK,GAAG,IAAZ;;AAEA,SAAKD,QAAL,GAAgBA,QAAhB;AACA;AACJ;AACA;;AAEI,SAAKE,UAAL,GAAkB,EAAlB;AACA,SAAKC,OAAL,GAAe,KAAf;AACA,SAAKC,eAAL,GAAuB,KAAvB;AACA,SAAKC,qBAAL,GAA6B,KAA7B;AACA,SAAKC,sBAAL,GAA8B,EAA9B;AACA,SAAKC,MAAL,GAAc,KAAd;AACA,SAAKC,cAAL,GAAsB,EAAtB;AACA,SAAKC,WAAL,GAAmB,IAAnB;AACA,SAAKC,KAAL,GAAa,CAAb;AACA,SAAKC,YAAL,GAAoB,EAApB;;AAEA,SAAKC,qBAAL,GAA6B,UAAUC,CAAV,EAAa;AACxCZ,MAAAA,KAAK,CAACQ,WAAN,GAAoBI,CAApB;;AAEAZ,MAAAA,KAAK,CAACa,iBAAN;;AAEA,UAAIb,KAAK,CAACC,UAAN,CAAiBa,MAAjB,KAA4B,CAAhC,EAAmC;AACjCd,QAAAA,KAAK,CAACG,eAAN,GAAwB,KAAxB;AACD,OAFD,MAEO;AACLH,QAAAA,KAAK,CAACe,qBAAN,CAA4Bf,KAAK,CAACW,qBAAlC;AACD;AACF,KAVD;;AAYA,SAAKK,mBAAL,GAA2B,UAAUJ,CAAV,EAAa;AACtC,UAAIK,UAAU,GAAGjB,KAAK,CAACU,YAAvB;AACAV,MAAAA,KAAK,CAACU,YAAN,GAAqB,EAArB;AACA,UAAIE,CAAC,GAAGhB,MAAM,CAACI,KAAK,CAACQ,WAAP,CAAd,EAAmCI,CAAC,GAAGhB,MAAM,CAACI,KAAK,CAACQ,WAAP,CAAV;;AAEnCR,MAAAA,KAAK,CAACC,UAAN,CAAiBiB,IAAjB,CAAsBzB,iBAAtB;;AAEAO,MAAAA,KAAK,CAACC,UAAN,GAAmBD,KAAK,CAACmB,IAAN,CAAWP,CAAX,EAAc,IAAd,EAAoBZ,KAAK,CAACC,UAA1B,EAAsC,CAAtC,CAAnB;AACAgB,MAAAA,UAAU,CAACG,OAAX,CAAmB,UAAUC,KAAV,EAAiB;AAClCA,QAAAA,KAAK,CAAC,CAAD,CAAL,CAAST,CAAT;AACD,OAFD;;AAIAZ,MAAAA,KAAK,CAACsB,mBAAN;AACD,KAbD;AAcD;;AAEDxB,EAAAA,iBAAiB,CAACyB,SAAlB,CAA4BC,aAA5B,GAA4C,YAAY;AACtD,SAAKX,iBAAL;AACA,WAAO,KAAKZ,UAAL,CAAgBwB,KAAhB,EAAP;AACD,GAHD;;AAKA3B,EAAAA,iBAAiB,CAACyB,SAAlB,CAA4BG,SAA5B,GAAwC,YAAY;AAClD,WAAO,KAAKpB,MAAZ;AACD,GAFD;;AAIAR,EAAAA,iBAAiB,CAACyB,SAAlB,CAA4BI,IAA5B,GAAmC,UAAUC,MAAV,EAAkB;AACnD,QAAIC,SAAS,GAAG,IAAIrC,SAAJ,CAAcoC,MAAd,EAAsB,IAAtB,CAAhB;AACA,SAAK3B,UAAL,CAAgB6B,IAAhB,CAAqBD,SAArB;AACA,SAAKE,4BAAL;AACAF,IAAAA,SAAS,CAACG,cAAV;AACAH,IAAAA,SAAS,CAACF,IAAV;AACAE,IAAAA,SAAS,CAACG,cAAV;AACA,WAAOH,SAAP;AACD,GARD,CAzDU,CAiEP;AACH;AACA;AACA;;;AAGA/B,EAAAA,iBAAiB,CAACyB,SAAlB,CAA4BU,qBAA5B,GAAoD,UAAUJ,SAAV,EAAqB;AACvE,QAAI7B,KAAK,GAAG,IAAZ;;AAEA,QAAI,KAAKM,MAAT,EAAiB;AACf;AACD,KALsE,CAKrE;;;AAGFuB,IAAAA,SAAS,CAACK,UAAV;AACA,QAAIjC,UAAU,GAAG4B,SAAS,CAACM,gBAAV,EAAjB;AACAlC,IAAAA,UAAU,CAACiB,IAAX,CAAgBzB,iBAAhB,EAVuE,CAUnC;;AAEpC,QAAI2C,kBAAkB,GAAG,KAAKjB,IAAL,CAAUvB,MAAM,CAAC,KAAKY,WAAN,CAAhB,EAAoC,KAApC,EAA2CP,UAAU,CAACwB,KAAX,EAA3C,EAA+D,CAA/D,CAAzB;AACAW,IAAAA,kBAAkB,CAAChB,OAAnB,CAA2B,UAAUS,SAAV,EAAqB;AAC9C,UAAIQ,KAAK,GAAGrC,KAAK,CAACC,UAAN,CAAiBqC,OAAjB,CAAyBT,SAAzB,CAAZ;;AAEA,UAAIQ,KAAK,KAAK,CAAC,CAAf,EAAkB;AAChBrC,QAAAA,KAAK,CAACC,UAAN,CAAiBsC,MAAjB,CAAwBF,KAAxB,EAA+B,CAA/B;AACD;AACF,KAND;AAOA,SAAKf,mBAAL;AACD,GArBD;;AAuBAxB,EAAAA,iBAAiB,CAACyB,SAAlB,CAA4BiB,OAA5B,GAAsC,YAAY;AAChD,QAAI,CAAC,KAAKtC,OAAV,EAAmB;AACjB,WAAKA,OAAL,GAAe,IAAf;AACA,WAAKa,qBAAL,CAA2B,YAAY,CAAE,CAAzC;AACA,WAAKX,qBAAL,GAA6B,IAA7B;AACD;;AAED,WAAO,KAAKA,qBAAZ;AACD,GARD;;AAUAN,EAAAA,iBAAiB,CAACyB,SAAlB,CAA4BkB,OAA5B,GAAsC,YAAY;AAChD,SAAK1C,QAAL,CAAc2C,WAAd,CAA0BC,oBAA1B,CAA+C,KAAKC,OAApD;AACD,GAFD;;AAIA9C,EAAAA,iBAAiB,CAACyB,SAAlB,CAA4BD,mBAA5B,GAAkD,YAAY;AAC5D,SAAKf,cAAL,CAAoBa,OAApB,CAA4B,UAAUQ,MAAV,EAAkB;AAC5CA,MAAAA,MAAM,KAAK,IAAX,IAAmBA,MAAM,KAAK,KAAK,CAAnC,GAAuC,KAAK,CAA5C,GAAgDA,MAAM,CAACiB,mBAAP,EAAhD;AACD,KAFD;AAGA,SAAKtC,cAAL,GAAsB,EAAtB;AACD,GALD;;AAOAT,EAAAA,iBAAiB,CAACyB,SAAlB,CAA4BuB,wBAA5B,GAAuD,YAAY;AACjE,SAAKzC,sBAAL,GAA8B,KAAKA,sBAAL,CAA4B0C,MAA5B,CAAmC,UAAUlB,SAAV,EAAqB;AACpF,aAAOA,SAAS,CAACG,cAAV,EAAP;AACD,KAF6B,CAA9B;AAGD,GAJD;;AAMAlC,EAAAA,iBAAiB,CAACyB,SAAlB,CAA4BV,iBAA5B,GAAgD,YAAY;AAC1D,SAAKiC,wBAAL;AACA,SAAK7C,UAAL,GAAkB,KAAKA,UAAL,CAAgB8C,MAAhB,CAAuB,UAAUlB,SAAV,EAAqB;AAC5D,aAAOA,SAAS,CAACmB,SAAV,KAAwB,UAAxB,IAAsCnB,SAAS,CAACmB,SAAV,KAAwB,MAArE;AACD,KAFiB,CAAlB;AAGD,GALD;;AAOAlD,EAAAA,iBAAiB,CAACyB,SAAlB,CAA4BQ,4BAA5B,GAA2D,YAAY;AACrE,QAAI,CAAC,KAAK5B,eAAV,EAA2B;AACzB,WAAKA,eAAL,GAAuB,IAAvB;AACA,WAAKY,qBAAL,CAA2B,KAAKJ,qBAAhC;AACD;AACF,GALD;;AAOAb,EAAAA,iBAAiB,CAACyB,SAAlB,CAA4B0B,GAA5B,GAAkC,UAAUC,CAAV,EAAa;AAC7C,QAAIrD,EAAE,GAAG,KAAKY,KAAL,EAAT;;AAEA,QAAI,KAAKC,YAAL,CAAkBI,MAAlB,KAA6B,CAAjC,EAAoC;AAClC,WAAK8B,OAAL,GAAe,KAAK7C,QAAL,CAAc2C,WAAd,CAA0B3B,qBAA1B,CAAgD,KAAKC,mBAArD,CAAf;AACD;;AAED,SAAKN,YAAL,CAAkBoB,IAAlB,CAAuB,CAACjC,EAAD,EAAKqD,CAAL,CAAvB;AACA,WAAOrD,EAAP;AACD,GATD;;AAWAC,EAAAA,iBAAiB,CAACyB,SAAlB,CAA4BR,qBAA5B,GAAoD,UAAUmC,CAAV,EAAa;AAC/D,QAAIlD,KAAK,GAAG,IAAZ;;AAEA,WAAO,KAAKiD,GAAL,CAAS,UAAUE,CAAV,EAAa;AAC3BnD,MAAAA,KAAK,CAAC8C,wBAAN;;AAEAI,MAAAA,CAAC,CAACC,CAAD,CAAD;;AAEAnD,MAAAA,KAAK,CAAC8C,wBAAN;AACD,KANM,CAAP;AAOD,GAVD;;AAYAhD,EAAAA,iBAAiB,CAACyB,SAAlB,CAA4BJ,IAA5B,GAAmC,UAAUP,CAAV,EAAawC,gBAAb,EAA+BC,kBAA/B,EAAmD;AACpF,QAAIC,EAAJ,EAAQC,EAAR;;AAEA,QAAIvD,KAAK,GAAG,IAAZ;;AAEA,SAAKM,MAAL,GAAc,IAAd;AACA,SAAKF,qBAAL,GAA6B,KAA7B;AACA,SAAKI,WAAL,GAAmBI,CAAnB;AACA,SAAKV,OAAL,GAAe,KAAf;AACA,QAAIsD,gBAAgB,GAAG,EAAvB;AACA,QAAIC,iBAAiB,GAAG,EAAxB;AACA,QAAIC,gBAAgB,GAAG,EAAvB;AACA,QAAItB,kBAAkB,GAAG,EAAzB;AACAiB,IAAAA,kBAAkB,CAACjC,OAAnB,CAA2B,UAAUS,SAAV,EAAqB;AAC9CA,MAAAA,SAAS,CAACV,IAAV,CAAeP,CAAf,EAAkBwC,gBAAlB;;AAEA,UAAI,CAACvB,SAAS,CAAC8B,SAAf,EAA0B;AACxBH,QAAAA,gBAAgB,CAAC1B,IAAjB,CAAsBD,SAAS,CAACD,MAAhC;AACAC,QAAAA,SAAS,CAAC+B,YAAV;AACD,OAHD,MAGO;AACLH,QAAAA,iBAAiB,CAAC3B,IAAlB,CAAuBD,SAAS,CAACD,MAAjC;AACAC,QAAAA,SAAS,CAACK,UAAV;AACD;;AAED,UAAIL,SAAS,CAACgC,UAAd,EAA0B7D,KAAK,CAACE,OAAN,GAAgB,IAAhB;AAC1B,UAAI4D,KAAK,GAAGjC,SAAS,CAAC8B,SAAV,IAAuB9B,SAAS,CAACgC,UAA7C;AACAhC,MAAAA,SAAS,CAACkC,WAAV,GAAwBD,KAAxB;;AAEA,UAAIA,KAAJ,EAAW;AACTJ,QAAAA,gBAAgB,CAAC5B,IAAjB,CAAsBD,SAAtB;AACD,OAFD,MAEO;AACLO,QAAAA,kBAAkB,CAACN,IAAnB,CAAwBD,SAAxB;AACD;AACF,KApBD;;AAsBA,KAACyB,EAAE,GAAG,KAAK/C,cAAX,EAA2BuB,IAA3B,CAAgCkC,KAAhC,CAAsCV,EAAtC,EAA0C/D,aAAa,CAAC,EAAD,EAAKD,MAAM,CAACkE,gBAAD,CAAX,EAA+B,KAA/B,CAAvD;;AAEA,KAACD,EAAE,GAAG,KAAKhD,cAAX,EAA2BuB,IAA3B,CAAgCkC,KAAhC,CAAsCT,EAAtC,EAA0ChE,aAAa,CAAC,EAAD,EAAKD,MAAM,CAACmE,iBAAD,CAAX,EAAgC,KAAhC,CAAvD;;AAEA,QAAI,KAAKvD,OAAT,EAAkB,KAAKa,qBAAL,CAA2B,YAAY,CAAE,CAAzC;AAClB,SAAKT,MAAL,GAAc,KAAd;AACA,WAAO,CAACoD,gBAAD,EAAmBtB,kBAAnB,CAAP;AACD,GA1CD;;AA4CA,SAAOtC,iBAAP;AACD,CA3MD,EAFA;;AA+MA,SAASA,iBAAT","sourcesContent":["import { __read, __spreadArray } from \"tslib\";\nimport { Animation } from './Animation';\nexport function compareAnimations(leftAnimation, rightAnimation) {\n  return Number(leftAnimation.id) - Number(rightAnimation.id);\n}\n/**\n * @see https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/web-animations-js/index.d.ts\n */\n\nvar AnimationTimeline =\n/** @class */\nfunction () {\n  function AnimationTimeline(document) {\n    var _this = this;\n\n    this.document = document;\n    /**\n     * all active animations\n     */\n\n    this.animations = [];\n    this.ticking = false;\n    this.timelineTicking = false;\n    this.hasRestartedThisFrame = false;\n    this.animationsWithPromises = [];\n    this.inTick = false;\n    this.pendingEffects = [];\n    this.currentTime = null;\n    this.rafId = 0;\n    this.rafCallbacks = [];\n\n    this.webAnimationsNextTick = function (t) {\n      _this.currentTime = t;\n\n      _this.discardAnimations();\n\n      if (_this.animations.length === 0) {\n        _this.timelineTicking = false;\n      } else {\n        _this.requestAnimationFrame(_this.webAnimationsNextTick);\n      }\n    };\n\n    this.processRafCallbacks = function (t) {\n      var processing = _this.rafCallbacks;\n      _this.rafCallbacks = [];\n      if (t < Number(_this.currentTime)) t = Number(_this.currentTime);\n\n      _this.animations.sort(compareAnimations);\n\n      _this.animations = _this.tick(t, true, _this.animations)[0];\n      processing.forEach(function (entry) {\n        entry[1](t);\n      });\n\n      _this.applyPendingEffects();\n    };\n  }\n\n  AnimationTimeline.prototype.getAnimations = function () {\n    this.discardAnimations();\n    return this.animations.slice();\n  };\n\n  AnimationTimeline.prototype.isTicking = function () {\n    return this.inTick;\n  };\n\n  AnimationTimeline.prototype.play = function (effect) {\n    var animation = new Animation(effect, this);\n    this.animations.push(animation);\n    this.restartWebAnimationsNextTick();\n    animation.updatePromises();\n    animation.play();\n    animation.updatePromises();\n    return animation;\n  }; // RAF is supposed to be the last script to occur before frame rendering but not\n  // all browsers behave like this. This function is for synchonously updating an\n  // animation's effects whenever its state is mutated by script to work around\n  // incorrect script execution ordering by the browser.\n\n\n  AnimationTimeline.prototype.applyDirtiedAnimation = function (animation) {\n    var _this = this;\n\n    if (this.inTick) {\n      return;\n    } // update active animations in displayobject\n\n\n    animation.markTarget();\n    var animations = animation.targetAnimations();\n    animations.sort(compareAnimations); // clear inactive animations\n\n    var inactiveAnimations = this.tick(Number(this.currentTime), false, animations.slice())[1];\n    inactiveAnimations.forEach(function (animation) {\n      var index = _this.animations.indexOf(animation);\n\n      if (index !== -1) {\n        _this.animations.splice(index, 1);\n      }\n    });\n    this.applyPendingEffects();\n  };\n\n  AnimationTimeline.prototype.restart = function () {\n    if (!this.ticking) {\n      this.ticking = true;\n      this.requestAnimationFrame(function () {});\n      this.hasRestartedThisFrame = true;\n    }\n\n    return this.hasRestartedThisFrame;\n  };\n\n  AnimationTimeline.prototype.destroy = function () {\n    this.document.defaultView.cancelAnimationFrame(this.frameId);\n  };\n\n  AnimationTimeline.prototype.applyPendingEffects = function () {\n    this.pendingEffects.forEach(function (effect) {\n      effect === null || effect === void 0 ? void 0 : effect.applyInterpolations();\n    });\n    this.pendingEffects = [];\n  };\n\n  AnimationTimeline.prototype.updateAnimationsPromises = function () {\n    this.animationsWithPromises = this.animationsWithPromises.filter(function (animation) {\n      return animation.updatePromises();\n    });\n  };\n\n  AnimationTimeline.prototype.discardAnimations = function () {\n    this.updateAnimationsPromises();\n    this.animations = this.animations.filter(function (animation) {\n      return animation.playState !== 'finished' && animation.playState !== 'idle';\n    });\n  };\n\n  AnimationTimeline.prototype.restartWebAnimationsNextTick = function () {\n    if (!this.timelineTicking) {\n      this.timelineTicking = true;\n      this.requestAnimationFrame(this.webAnimationsNextTick);\n    }\n  };\n\n  AnimationTimeline.prototype.rAF = function (f) {\n    var id = this.rafId++;\n\n    if (this.rafCallbacks.length === 0) {\n      this.frameId = this.document.defaultView.requestAnimationFrame(this.processRafCallbacks);\n    }\n\n    this.rafCallbacks.push([id, f]);\n    return id;\n  };\n\n  AnimationTimeline.prototype.requestAnimationFrame = function (f) {\n    var _this = this;\n\n    return this.rAF(function (x) {\n      _this.updateAnimationsPromises();\n\n      f(x);\n\n      _this.updateAnimationsPromises();\n    });\n  };\n\n  AnimationTimeline.prototype.tick = function (t, isAnimationFrame, updatingAnimations) {\n    var _a, _b;\n\n    var _this = this;\n\n    this.inTick = true;\n    this.hasRestartedThisFrame = false;\n    this.currentTime = t;\n    this.ticking = false;\n    var newPendingClears = [];\n    var newPendingEffects = [];\n    var activeAnimations = [];\n    var inactiveAnimations = [];\n    updatingAnimations.forEach(function (animation) {\n      animation.tick(t, isAnimationFrame);\n\n      if (!animation._inEffect) {\n        newPendingClears.push(animation.effect);\n        animation.unmarkTarget();\n      } else {\n        newPendingEffects.push(animation.effect);\n        animation.markTarget();\n      }\n\n      if (animation._needsTick) _this.ticking = true;\n      var alive = animation._inEffect || animation._needsTick;\n      animation._inTimeline = alive;\n\n      if (alive) {\n        activeAnimations.push(animation);\n      } else {\n        inactiveAnimations.push(animation);\n      }\n    });\n\n    (_a = this.pendingEffects).push.apply(_a, __spreadArray([], __read(newPendingClears), false));\n\n    (_b = this.pendingEffects).push.apply(_b, __spreadArray([], __read(newPendingEffects), false));\n\n    if (this.ticking) this.requestAnimationFrame(function () {});\n    this.inTick = false;\n    return [activeAnimations, inactiveAnimations];\n  };\n\n  return AnimationTimeline;\n}();\n\nexport { AnimationTimeline };"]},"metadata":{},"sourceType":"module"}