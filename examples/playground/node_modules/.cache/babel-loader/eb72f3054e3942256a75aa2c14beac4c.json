{"ast":null,"code":"import * as React from 'react';\nimport KeyCode from \"rc-util/es/KeyCode\";\nvar ESC = KeyCode.ESC,\n    TAB = KeyCode.TAB;\nexport default function useAccessibility(_ref) {\n  var visible = _ref.visible,\n      setTriggerVisible = _ref.setTriggerVisible,\n      triggerRef = _ref.triggerRef,\n      menuRef = _ref.menuRef,\n      onVisibleChange = _ref.onVisibleChange;\n\n  var handleCloseMenuAndReturnFocus = function handleCloseMenuAndReturnFocus() {\n    if (visible && triggerRef.current) {\n      var _triggerRef$current, _triggerRef$current$t, _triggerRef$current$t2;\n\n      (_triggerRef$current = triggerRef.current) === null || _triggerRef$current === void 0 ? void 0 : (_triggerRef$current$t = _triggerRef$current.triggerRef) === null || _triggerRef$current$t === void 0 ? void 0 : (_triggerRef$current$t2 = _triggerRef$current$t.current) === null || _triggerRef$current$t2 === void 0 ? void 0 : _triggerRef$current$t2.focus();\n      setTriggerVisible(false);\n\n      if (typeof onVisibleChange === 'function') {\n        onVisibleChange(false);\n      }\n    }\n  };\n\n  var handleKeyDown = function handleKeyDown(event) {\n    switch (event.keyCode) {\n      case ESC:\n        handleCloseMenuAndReturnFocus();\n        break;\n\n      case TAB:\n        handleCloseMenuAndReturnFocus();\n        break;\n    }\n  };\n\n  var focusOpenedMenu = function focusOpenedMenu() {\n    var _menuRef$current, _menuRef$current$focu;\n\n    (_menuRef$current = menuRef.current) === null || _menuRef$current === void 0 ? void 0 : (_menuRef$current$focu = _menuRef$current.focus) === null || _menuRef$current$focu === void 0 ? void 0 : _menuRef$current$focu.call(_menuRef$current);\n  };\n\n  React.useEffect(function () {\n    if (visible) {\n      setTimeout(function () {\n        focusOpenedMenu();\n        window.addEventListener('keydown', handleKeyDown);\n      }, 100);\n      return function () {\n        window.removeEventListener('keydown', handleKeyDown);\n      };\n    }\n\n    return function () {\n      return null;\n    };\n  }, [visible]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  var returnFocus = function returnFocus() {\n    if (visible) {\n      setTimeout(function () {\n        var _triggerRef$current2, _triggerRef$current2$, _triggerRef$current2$2, _triggerRef$current2$3;\n\n        (_triggerRef$current2 = triggerRef.current) === null || _triggerRef$current2 === void 0 ? void 0 : (_triggerRef$current2$ = _triggerRef$current2.triggerRef) === null || _triggerRef$current2$ === void 0 ? void 0 : (_triggerRef$current2$2 = _triggerRef$current2$.current) === null || _triggerRef$current2$2 === void 0 ? void 0 : (_triggerRef$current2$3 = _triggerRef$current2$2.focus) === null || _triggerRef$current2$3 === void 0 ? void 0 : _triggerRef$current2$3.call(_triggerRef$current2$2);\n      }, 100);\n    }\n  };\n\n  return {\n    returnFocus: returnFocus\n  };\n}","map":{"version":3,"sources":["/Users/dennis.zhang/Desktop/其它代码库/moa-flow/node_modules/rc-tabs/node_modules/rc-dropdown/es/hooks/useAccessibility.js"],"names":["React","KeyCode","ESC","TAB","useAccessibility","_ref","visible","setTriggerVisible","triggerRef","menuRef","onVisibleChange","handleCloseMenuAndReturnFocus","current","_triggerRef$current","_triggerRef$current$t","_triggerRef$current$t2","focus","handleKeyDown","event","keyCode","focusOpenedMenu","_menuRef$current","_menuRef$current$focu","call","useEffect","setTimeout","window","addEventListener","removeEventListener","returnFocus","_triggerRef$current2","_triggerRef$current2$","_triggerRef$current2$2","_triggerRef$current2$3"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport KeyCode from \"rc-util/es/KeyCode\";\nvar ESC = KeyCode.ESC,\n    TAB = KeyCode.TAB;\nexport default function useAccessibility(_ref) {\n  var visible = _ref.visible,\n      setTriggerVisible = _ref.setTriggerVisible,\n      triggerRef = _ref.triggerRef,\n      menuRef = _ref.menuRef,\n      onVisibleChange = _ref.onVisibleChange;\n\n  var handleCloseMenuAndReturnFocus = function handleCloseMenuAndReturnFocus() {\n    if (visible && triggerRef.current) {\n      var _triggerRef$current, _triggerRef$current$t, _triggerRef$current$t2;\n\n      (_triggerRef$current = triggerRef.current) === null || _triggerRef$current === void 0 ? void 0 : (_triggerRef$current$t = _triggerRef$current.triggerRef) === null || _triggerRef$current$t === void 0 ? void 0 : (_triggerRef$current$t2 = _triggerRef$current$t.current) === null || _triggerRef$current$t2 === void 0 ? void 0 : _triggerRef$current$t2.focus();\n      setTriggerVisible(false);\n\n      if (typeof onVisibleChange === 'function') {\n        onVisibleChange(false);\n      }\n    }\n  };\n\n  var handleKeyDown = function handleKeyDown(event) {\n    switch (event.keyCode) {\n      case ESC:\n        handleCloseMenuAndReturnFocus();\n        break;\n\n      case TAB:\n        handleCloseMenuAndReturnFocus();\n        break;\n    }\n  };\n\n  var focusOpenedMenu = function focusOpenedMenu() {\n    var _menuRef$current, _menuRef$current$focu;\n\n    (_menuRef$current = menuRef.current) === null || _menuRef$current === void 0 ? void 0 : (_menuRef$current$focu = _menuRef$current.focus) === null || _menuRef$current$focu === void 0 ? void 0 : _menuRef$current$focu.call(_menuRef$current);\n  };\n\n  React.useEffect(function () {\n    if (visible) {\n      setTimeout(function () {\n        focusOpenedMenu();\n        window.addEventListener('keydown', handleKeyDown);\n      }, 100);\n      return function () {\n        window.removeEventListener('keydown', handleKeyDown);\n      };\n    }\n\n    return function () {\n      return null;\n    };\n  }, [visible]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  var returnFocus = function returnFocus() {\n    if (visible) {\n      setTimeout(function () {\n        var _triggerRef$current2, _triggerRef$current2$, _triggerRef$current2$2, _triggerRef$current2$3;\n\n        (_triggerRef$current2 = triggerRef.current) === null || _triggerRef$current2 === void 0 ? void 0 : (_triggerRef$current2$ = _triggerRef$current2.triggerRef) === null || _triggerRef$current2$ === void 0 ? void 0 : (_triggerRef$current2$2 = _triggerRef$current2$.current) === null || _triggerRef$current2$2 === void 0 ? void 0 : (_triggerRef$current2$3 = _triggerRef$current2$2.focus) === null || _triggerRef$current2$3 === void 0 ? void 0 : _triggerRef$current2$3.call(_triggerRef$current2$2);\n      }, 100);\n    }\n  };\n\n  return {\n    returnFocus: returnFocus\n  };\n}"]},"metadata":{},"sourceType":"module"}