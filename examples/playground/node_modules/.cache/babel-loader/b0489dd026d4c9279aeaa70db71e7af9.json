{"ast":null,"code":"import { __read, __spreadArray } from \"tslib\";\nimport { isBoolean, isFunction, isObject } from 'lodash-es';\nimport { EventEmitter } from 'eventemitter3';\nimport { CustomEvent } from './CustomEvent';\nimport { FederatedEvent } from './FederatedEvent';\nexport var DELEGATION_SPLITTER = ':';\n/**\n * Objects that can receive events and may have listeners for them.\n * eg. Element, Canvas, DisplayObject\n * @see https://developer.mozilla.org/en-US/docs/Web/API/EventTarget\n */\n\nvar EventTarget =\n/** @class */\nfunction () {\n  function EventTarget() {\n    /**\n     * event emitter\n     */\n    this.emitter = new EventEmitter();\n  }\n  /**\n   * @deprecated\n   * @alias addEventListener\n   */\n\n\n  EventTarget.prototype.on = function (type, listener, options) {\n    this.addEventListener(type, listener, options);\n    return this;\n  };\n  /**\n   * support `capture` & `once` in options\n   * @see https://developer.mozilla.org/zh-CN/docs/Web/API/EventTarget/addEventListener\n   */\n\n\n  EventTarget.prototype.addEventListener = function (type, listener, options) {\n    var capture = isBoolean(options) && options || isObject(options) && options.capture;\n    var once = isObject(options) && options.once;\n    var context = isFunction(listener) ? undefined : listener; // compatible with G 3.0\n    // support using delegate name in event type, eg. 'node:click'\n\n    var useDelegatedName = false;\n    var delegatedName = '';\n\n    if (type.indexOf(DELEGATION_SPLITTER) > -1) {\n      var _a = __read(type.split(DELEGATION_SPLITTER), 2),\n          name_1 = _a[0],\n          eventType = _a[1];\n\n      type = eventType;\n      delegatedName = name_1;\n      useDelegatedName = true;\n    }\n\n    type = capture ? \"\".concat(type, \"capture\") : type;\n    listener = isFunction(listener) ? listener : listener.handleEvent; // compatible with G 3.0\n\n    if (useDelegatedName) {\n      var originListener_1 = listener;\n\n      listener = function listener() {\n        var _a;\n\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        if (((_a = args[0].target) === null || _a === void 0 ? void 0 : _a.name) !== delegatedName) {\n          return;\n        } // @ts-ignore\n\n\n        originListener_1.apply(void 0, __spreadArray([], __read(args), false));\n      };\n    }\n\n    if (once) {\n      this.emitter.once(type, listener, context);\n    } else {\n      this.emitter.on(type, listener, context);\n    }\n\n    return this;\n  };\n  /**\n   * @deprecated\n   * @alias removeEventListener\n   */\n\n\n  EventTarget.prototype.off = function (type, listener, options) {\n    if (type) {\n      this.removeEventListener(type, listener, options);\n    } else {\n      // remove all listeners\n      this.removeAllEventListeners();\n    }\n\n    return this;\n  };\n\n  EventTarget.prototype.removeAllEventListeners = function () {\n    this.emitter.removeAllListeners();\n  };\n\n  EventTarget.prototype.removeEventListener = function (type, listener, options) {\n    var capture = isBoolean(options) && options || isObject(options) && options.capture;\n    var context = isFunction(listener) ? undefined : listener;\n    type = capture ? \"\".concat(type, \"capture\") : type;\n    listener = isFunction(listener) ? listener : listener === null || listener === void 0 ? void 0 : listener.handleEvent;\n    this.emitter.off(type, listener, context);\n    return this;\n  };\n  /**\n   * @deprecated\n   * @alias dispatchEvent\n   */\n  // eslint-disable-next-line @typescript-eslint/ban-types\n\n\n  EventTarget.prototype.emit = function (eventName, object) {\n    this.dispatchEvent(new CustomEvent(eventName, object));\n  };\n  /**\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/dispatchEvent\n   */\n\n\n  EventTarget.prototype.dispatchEvent = function (e) {\n    var _a, _b;\n\n    if (!(e instanceof FederatedEvent)) {\n      throw new Error('DisplayObject cannot propagate events outside of the Federated Events API');\n    }\n\n    var document = // @ts-ignore\n    this.ownerDocument || this.document; // assign event manager\n\n    if (document) {\n      e.manager = ((_a = document.defaultView) === null || _a === void 0 ? void 0 : _a.getEventService()) || null;\n      e.defaultPrevented = false;\n      e.path = [];\n      e.target = this;\n      (_b = e.manager) === null || _b === void 0 ? void 0 : _b.dispatchEvent(e);\n    }\n\n    return !e.defaultPrevented;\n  };\n\n  return EventTarget;\n}();\n\nexport { EventTarget };","map":{"version":3,"sources":["/Users/dennis.zhang/Desktop/其它代码库/moa-flow/node_modules/@antv/g/es/dom/EventTarget.js"],"names":["__read","__spreadArray","isBoolean","isFunction","isObject","EventEmitter","CustomEvent","FederatedEvent","DELEGATION_SPLITTER","EventTarget","emitter","prototype","on","type","listener","options","addEventListener","capture","once","context","undefined","useDelegatedName","delegatedName","indexOf","_a","split","name_1","eventType","concat","handleEvent","originListener_1","args","_i","arguments","length","target","name","apply","off","removeEventListener","removeAllEventListeners","removeAllListeners","emit","eventName","object","dispatchEvent","e","_b","Error","document","ownerDocument","manager","defaultView","getEventService","defaultPrevented","path"],"mappings":"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","sourcesContent":["import { __read, __spreadArray } from \"tslib\";\nimport { isBoolean, isFunction, isObject } from 'lodash-es';\nimport { EventEmitter } from 'eventemitter3';\nimport { CustomEvent } from './CustomEvent';\nimport { FederatedEvent } from './FederatedEvent';\nexport var DELEGATION_SPLITTER = ':';\n/**\n * Objects that can receive events and may have listeners for them.\n * eg. Element, Canvas, DisplayObject\n * @see https://developer.mozilla.org/en-US/docs/Web/API/EventTarget\n */\n\nvar EventTarget =\n/** @class */\nfunction () {\n  function EventTarget() {\n    /**\n     * event emitter\n     */\n    this.emitter = new EventEmitter();\n  }\n  /**\n   * @deprecated\n   * @alias addEventListener\n   */\n\n\n  EventTarget.prototype.on = function (type, listener, options) {\n    this.addEventListener(type, listener, options);\n    return this;\n  };\n  /**\n   * support `capture` & `once` in options\n   * @see https://developer.mozilla.org/zh-CN/docs/Web/API/EventTarget/addEventListener\n   */\n\n\n  EventTarget.prototype.addEventListener = function (type, listener, options) {\n    var capture = isBoolean(options) && options || isObject(options) && options.capture;\n    var once = isObject(options) && options.once;\n    var context = isFunction(listener) ? undefined : listener; // compatible with G 3.0\n    // support using delegate name in event type, eg. 'node:click'\n\n    var useDelegatedName = false;\n    var delegatedName = '';\n\n    if (type.indexOf(DELEGATION_SPLITTER) > -1) {\n      var _a = __read(type.split(DELEGATION_SPLITTER), 2),\n          name_1 = _a[0],\n          eventType = _a[1];\n\n      type = eventType;\n      delegatedName = name_1;\n      useDelegatedName = true;\n    }\n\n    type = capture ? \"\".concat(type, \"capture\") : type;\n    listener = isFunction(listener) ? listener : listener.handleEvent; // compatible with G 3.0\n\n    if (useDelegatedName) {\n      var originListener_1 = listener;\n\n      listener = function listener() {\n        var _a;\n\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        if (((_a = args[0].target) === null || _a === void 0 ? void 0 : _a.name) !== delegatedName) {\n          return;\n        } // @ts-ignore\n\n\n        originListener_1.apply(void 0, __spreadArray([], __read(args), false));\n      };\n    }\n\n    if (once) {\n      this.emitter.once(type, listener, context);\n    } else {\n      this.emitter.on(type, listener, context);\n    }\n\n    return this;\n  };\n  /**\n   * @deprecated\n   * @alias removeEventListener\n   */\n\n\n  EventTarget.prototype.off = function (type, listener, options) {\n    if (type) {\n      this.removeEventListener(type, listener, options);\n    } else {\n      // remove all listeners\n      this.removeAllEventListeners();\n    }\n\n    return this;\n  };\n\n  EventTarget.prototype.removeAllEventListeners = function () {\n    this.emitter.removeAllListeners();\n  };\n\n  EventTarget.prototype.removeEventListener = function (type, listener, options) {\n    var capture = isBoolean(options) && options || isObject(options) && options.capture;\n    var context = isFunction(listener) ? undefined : listener;\n    type = capture ? \"\".concat(type, \"capture\") : type;\n    listener = isFunction(listener) ? listener : listener === null || listener === void 0 ? void 0 : listener.handleEvent;\n    this.emitter.off(type, listener, context);\n    return this;\n  };\n  /**\n   * @deprecated\n   * @alias dispatchEvent\n   */\n  // eslint-disable-next-line @typescript-eslint/ban-types\n\n\n  EventTarget.prototype.emit = function (eventName, object) {\n    this.dispatchEvent(new CustomEvent(eventName, object));\n  };\n  /**\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/dispatchEvent\n   */\n\n\n  EventTarget.prototype.dispatchEvent = function (e) {\n    var _a, _b;\n\n    if (!(e instanceof FederatedEvent)) {\n      throw new Error('DisplayObject cannot propagate events outside of the Federated Events API');\n    }\n\n    var document = // @ts-ignore\n    this.ownerDocument || this.document; // assign event manager\n\n    if (document) {\n      e.manager = ((_a = document.defaultView) === null || _a === void 0 ? void 0 : _a.getEventService()) || null;\n      e.defaultPrevented = false;\n      e.path = [];\n      e.target = this;\n      (_b = e.manager) === null || _b === void 0 ? void 0 : _b.dispatchEvent(e);\n    }\n\n    return !e.defaultPrevented;\n  };\n\n  return EventTarget;\n}();\n\nexport { EventTarget };"]},"metadata":{},"sourceType":"module"}