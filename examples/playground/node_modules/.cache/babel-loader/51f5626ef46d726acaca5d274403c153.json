{"ast":null,"code":"import { __extends, __values } from \"tslib\";\nimport { Shape } from '../types'; // import { Text } from '../display-objects/Text';\n\nimport { EventTarget } from './EventTarget';\n/**\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Node\n */\n\nvar Node =\n/** @class */\nfunction (_super) {\n  __extends(Node, _super);\n\n  function Node() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.shadow = false;\n    /**\n     * points to canvas.document\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Node/ownerDocument\n     */\n\n    _this.ownerDocument = null;\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/isConnected\n     * @example\n        circle.isConnected; // false\n        canvas.appendChild(circle);\n        circle.isConnected; // true\n     */\n\n    _this.isConnected = false;\n    /**\n     * Returns node's node document's document base URL.\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node\n     */\n\n    _this.baseURI = '';\n    /**\n     * Returns the children.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Node/childNodes\n     */\n\n    _this.childNodes = [];\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/nodeType\n     */\n\n    _this.nodeType = 0;\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/nodeName\n     */\n\n    _this.nodeName = '';\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/nodeValue\n     */\n\n    _this.nodeValue = null;\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/ParentNode\n     */\n\n    _this.parentNode = null;\n    return _this;\n  }\n\n  Node.isNode = function (target) {\n    return !!target.childNodes;\n  };\n\n  Object.defineProperty(Node.prototype, \"textContent\", {\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/textContent\n     */\n    get: function get() {\n      var e_1, _a;\n\n      var out = '';\n\n      if (this.nodeName === Shape.TEXT) {\n        // @ts-ignore\n        out += this.style.text;\n      }\n\n      try {\n        for (var _b = __values(this.childNodes), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var child = _c.value;\n\n          if (child.nodeName === Shape.TEXT) {\n            out += child.nodeValue;\n          } else {\n            out += child.textContent;\n          }\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n\n      return out;\n    },\n    set: function set(content) {\n      var _this = this; // remove all children\n\n\n      this.childNodes.slice().forEach(function (child) {\n        _this.removeChild(child, true);\n      });\n\n      if (this.nodeName === Shape.TEXT) {\n        // @ts-ignore\n        this.style.text = \"\".concat(content);\n      } else {// this.appendChild(\n        //   new Text({\n        //     style: {\n        //       text: content,\n        //     },\n        //   }),\n        // );\n      }\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\n   * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/getRootNode\n   */\n\n  Node.prototype.getRootNode = function (opts) {\n    if (opts === void 0) {\n      opts = {};\n    }\n\n    if (this.parentNode) {\n      return this.parentNode.getRootNode(opts);\n    }\n\n    if (opts.composed && this.host) {\n      return this.host.getRootNode(opts);\n    }\n\n    return this;\n  };\n\n  Node.prototype.hasChildNodes = function () {\n    return this.childNodes.length > 0;\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  Node.prototype.isDefaultNamespace = function (namespace) {\n    throw new Error('Method not implemented.');\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  Node.prototype.lookupNamespaceURI = function (prefix) {\n    throw new Error('Method not implemented.');\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  Node.prototype.lookupPrefix = function (namespace) {\n    throw new Error('Method not implemented.');\n  };\n\n  Node.prototype.normalize = function () {\n    throw new Error('Method not implemented.');\n  };\n  /**\n   * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/isEqualNode\n   */\n\n\n  Node.prototype.isEqualNode = function (otherNode) {\n    // TODO: compare 2 nodes, not sameness\n    return this === otherNode;\n  };\n\n  Node.prototype.isSameNode = function (otherNode) {\n    return this.isEqualNode(otherNode);\n  };\n\n  Object.defineProperty(Node.prototype, \"parent\", {\n    /**\n     * @deprecated\n     * @alias parentNode\n     */\n    get: function get() {\n      return this.parentNode;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Node.prototype, \"parentElement\", {\n    get: function get() {\n      return null;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Node.prototype, \"nextSibling\", {\n    get: function get() {\n      return null;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Node.prototype, \"previousSibling\", {\n    get: function get() {\n      return null;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Node.prototype, \"firstChild\", {\n    get: function get() {\n      return this.childNodes.length > 0 ? this.childNodes[0] : null;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Node.prototype, \"lastChild\", {\n    get: function get() {\n      return this.childNodes.length > 0 ? this.childNodes[this.childNodes.length - 1] : null;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/Node/compareDocumentPosition\n   * @see https://github.com/b-fuze/deno-dom/blob/master/src/dom/node.ts#L338\n   */\n\n  Node.prototype.compareDocumentPosition = function (other) {\n    var _a;\n\n    if (other === this) {\n      // same node\n      return 0;\n    }\n\n    if (!(other instanceof Node)) {\n      throw new TypeError('Node.compareDocumentPosition: Argument 1 does not implement interface Node.');\n    }\n\n    var node1Root = other; // eslint-disable-next-line @typescript-eslint/no-this-alias\n\n    var node2Root = this;\n    var node1Hierarchy = [node1Root];\n    var node2Hierarchy = [node2Root];\n\n    while ((_a = node1Root.parentNode) !== null && _a !== void 0 ? _a : node2Root.parentNode) {\n      node1Root = node1Root.parentNode ? (node1Hierarchy.push(node1Root.parentNode), node1Root.parentNode) : node1Root;\n      node2Root = node2Root.parentNode ? (node2Hierarchy.push(node2Root.parentNode), node2Root.parentNode) : node2Root;\n    } // Check if they don't share the same root node\n\n\n    if (node1Root !== node2Root) {\n      return Node.DOCUMENT_POSITION_DISCONNECTED | Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC | Node.DOCUMENT_POSITION_PRECEDING;\n    }\n\n    var longerHierarchy = node1Hierarchy.length > node2Hierarchy.length ? node1Hierarchy : node2Hierarchy;\n    var shorterHierarchy = longerHierarchy === node1Hierarchy ? node2Hierarchy : node1Hierarchy; // Check if either is a container of the other\n\n    if (longerHierarchy[longerHierarchy.length - shorterHierarchy.length] === shorterHierarchy[0]) {\n      return longerHierarchy === node1Hierarchy ? // other is a child of this\n      Node.DOCUMENT_POSITION_CONTAINED_BY | Node.DOCUMENT_POSITION_FOLLOWING : // this is a child of other\n      Node.DOCUMENT_POSITION_CONTAINS | Node.DOCUMENT_POSITION_PRECEDING;\n    } // Find their first common ancestor and see whether they\n    // are preceding or following\n\n\n    var longerStart = longerHierarchy.length - shorterHierarchy.length;\n\n    for (var i = shorterHierarchy.length - 1; i >= 0; i--) {\n      var shorterHierarchyNode = shorterHierarchy[i];\n      var longerHierarchyNode = longerHierarchy[longerStart + i]; // We found the first common ancestor\n\n      if (longerHierarchyNode !== shorterHierarchyNode) {\n        var siblings = shorterHierarchyNode.parentNode.childNodes;\n\n        if (siblings.indexOf(shorterHierarchyNode) < siblings.indexOf(longerHierarchyNode)) {\n          // Shorter is before longer\n          if (shorterHierarchy === node1Hierarchy) {\n            // Other is before this\n            return Node.DOCUMENT_POSITION_PRECEDING;\n          } else {\n            // This is before other\n            return Node.DOCUMENT_POSITION_FOLLOWING;\n          }\n        } else {\n          // Longer is before shorter\n          if (longerHierarchy === node1Hierarchy) {\n            // Other is before this\n            return Node.DOCUMENT_POSITION_PRECEDING;\n          } else {\n            // Other is after this\n            return Node.DOCUMENT_POSITION_FOLLOWING;\n          }\n        }\n      }\n    }\n\n    return Node.DOCUMENT_POSITION_FOLLOWING;\n  };\n  /**\n   * @deprecated\n   * @alias contains\n   */\n\n\n  Node.prototype.contain = function (other) {\n    return this.contains(other);\n  };\n\n  Node.prototype.contains = function (other) {\n    // the node itself, one of its direct children\n    var tmp = other; // @see https://developer.mozilla.org/en-US/docs/Web/API/Node/contains\n\n    while (tmp && this !== tmp) {\n      tmp = tmp.parentNode;\n    }\n\n    return !!tmp;\n  };\n\n  Node.prototype.getAncestor = function (n) {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    var temp = this;\n\n    while (n > 0 && temp) {\n      temp = temp.parentNode;\n      n--;\n    }\n\n    return temp;\n  };\n\n  Node.prototype.forEach = function (callback) {\n    if (!callback(this)) {\n      this.childNodes.forEach(function (child) {\n        child.forEach(callback);\n      });\n    }\n  };\n  /**\n   * Both nodes are in different documents or different trees in the same document.\n   */\n\n\n  Node.DOCUMENT_POSITION_DISCONNECTED = 1;\n  /**\n   * otherNode precedes the node in either a pre-order depth-first traversal\n   * of a tree containing both (e.g., as an ancestor or previous sibling or a descendant of a previous sibling or previous sibling of an ancestor) or (if they are disconnected) in an arbitrary but consistent ordering.\n   */\n\n  Node.DOCUMENT_POSITION_PRECEDING = 2;\n  /**\n   * otherNode follows the node in either a pre-order depth-first traversal of a tree containing both (e.g., as a descendant or following sibling or a descendant of a following sibling or following sibling of an ancestor) or (if they are disconnected) in an arbitrary but consistent ordering.\n   */\n\n  Node.DOCUMENT_POSITION_FOLLOWING = 4;\n  /**\n   * otherNode is an ancestor of the node.\n   */\n\n  Node.DOCUMENT_POSITION_CONTAINS = 8;\n  /**\n   * otherNode is a descendant of the node.\n   */\n\n  Node.DOCUMENT_POSITION_CONTAINED_BY = 16;\n  /**\n   * The result relies upon arbitrary and/or implementation-specific behavior and is not guaranteed to be portable.\n   */\n\n  Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC = 32;\n  return Node;\n}(EventTarget);\n\nexport { Node };","map":{"version":3,"sources":["/Users/dennis.zhang/Desktop/其它代码库/moa-flow/node_modules/@antv/g/es/dom/Node.js"],"names":["__extends","__values","Shape","EventTarget","Node","_super","_this","apply","arguments","shadow","ownerDocument","isConnected","baseURI","childNodes","nodeType","nodeName","nodeValue","parentNode","isNode","target","Object","defineProperty","prototype","get","e_1","_a","out","TEXT","style","text","_b","_c","next","done","child","value","textContent","e_1_1","error","return","call","set","content","slice","forEach","removeChild","concat","enumerable","configurable","getRootNode","opts","composed","host","hasChildNodes","length","isDefaultNamespace","namespace","Error","lookupNamespaceURI","prefix","lookupPrefix","normalize","isEqualNode","otherNode","isSameNode","compareDocumentPosition","other","TypeError","node1Root","node2Root","node1Hierarchy","node2Hierarchy","push","DOCUMENT_POSITION_DISCONNECTED","DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC","DOCUMENT_POSITION_PRECEDING","longerHierarchy","shorterHierarchy","DOCUMENT_POSITION_CONTAINED_BY","DOCUMENT_POSITION_FOLLOWING","DOCUMENT_POSITION_CONTAINS","longerStart","i","shorterHierarchyNode","longerHierarchyNode","siblings","indexOf","contain","contains","tmp","getAncestor","n","temp","callback"],"mappings":"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","sourcesContent":["import { __extends, __values } from \"tslib\";\nimport { Shape } from '../types'; // import { Text } from '../display-objects/Text';\n\nimport { EventTarget } from './EventTarget';\n/**\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Node\n */\n\nvar Node =\n/** @class */\nfunction (_super) {\n  __extends(Node, _super);\n\n  function Node() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.shadow = false;\n    /**\n     * points to canvas.document\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Node/ownerDocument\n     */\n\n    _this.ownerDocument = null;\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/isConnected\n     * @example\n        circle.isConnected; // false\n        canvas.appendChild(circle);\n        circle.isConnected; // true\n     */\n\n    _this.isConnected = false;\n    /**\n     * Returns node's node document's document base URL.\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node\n     */\n\n    _this.baseURI = '';\n    /**\n     * Returns the children.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Node/childNodes\n     */\n\n    _this.childNodes = [];\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/nodeType\n     */\n\n    _this.nodeType = 0;\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/nodeName\n     */\n\n    _this.nodeName = '';\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/nodeValue\n     */\n\n    _this.nodeValue = null;\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/ParentNode\n     */\n\n    _this.parentNode = null;\n    return _this;\n  }\n\n  Node.isNode = function (target) {\n    return !!target.childNodes;\n  };\n\n  Object.defineProperty(Node.prototype, \"textContent\", {\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/textContent\n     */\n    get: function get() {\n      var e_1, _a;\n\n      var out = '';\n\n      if (this.nodeName === Shape.TEXT) {\n        // @ts-ignore\n        out += this.style.text;\n      }\n\n      try {\n        for (var _b = __values(this.childNodes), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var child = _c.value;\n\n          if (child.nodeName === Shape.TEXT) {\n            out += child.nodeValue;\n          } else {\n            out += child.textContent;\n          }\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n\n      return out;\n    },\n    set: function set(content) {\n      var _this = this; // remove all children\n\n\n      this.childNodes.slice().forEach(function (child) {\n        _this.removeChild(child, true);\n      });\n\n      if (this.nodeName === Shape.TEXT) {\n        // @ts-ignore\n        this.style.text = \"\".concat(content);\n      } else {// this.appendChild(\n        //   new Text({\n        //     style: {\n        //       text: content,\n        //     },\n        //   }),\n        // );\n      }\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\n   * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/getRootNode\n   */\n\n  Node.prototype.getRootNode = function (opts) {\n    if (opts === void 0) {\n      opts = {};\n    }\n\n    if (this.parentNode) {\n      return this.parentNode.getRootNode(opts);\n    }\n\n    if (opts.composed && this.host) {\n      return this.host.getRootNode(opts);\n    }\n\n    return this;\n  };\n\n  Node.prototype.hasChildNodes = function () {\n    return this.childNodes.length > 0;\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  Node.prototype.isDefaultNamespace = function (namespace) {\n    throw new Error('Method not implemented.');\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  Node.prototype.lookupNamespaceURI = function (prefix) {\n    throw new Error('Method not implemented.');\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  Node.prototype.lookupPrefix = function (namespace) {\n    throw new Error('Method not implemented.');\n  };\n\n  Node.prototype.normalize = function () {\n    throw new Error('Method not implemented.');\n  };\n  /**\n   * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/isEqualNode\n   */\n\n\n  Node.prototype.isEqualNode = function (otherNode) {\n    // TODO: compare 2 nodes, not sameness\n    return this === otherNode;\n  };\n\n  Node.prototype.isSameNode = function (otherNode) {\n    return this.isEqualNode(otherNode);\n  };\n\n  Object.defineProperty(Node.prototype, \"parent\", {\n    /**\n     * @deprecated\n     * @alias parentNode\n     */\n    get: function get() {\n      return this.parentNode;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Node.prototype, \"parentElement\", {\n    get: function get() {\n      return null;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Node.prototype, \"nextSibling\", {\n    get: function get() {\n      return null;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Node.prototype, \"previousSibling\", {\n    get: function get() {\n      return null;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Node.prototype, \"firstChild\", {\n    get: function get() {\n      return this.childNodes.length > 0 ? this.childNodes[0] : null;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Node.prototype, \"lastChild\", {\n    get: function get() {\n      return this.childNodes.length > 0 ? this.childNodes[this.childNodes.length - 1] : null;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\n   * @see https://developer.mozilla.org/en-US/docs/Web/API/Node/compareDocumentPosition\n   * @see https://github.com/b-fuze/deno-dom/blob/master/src/dom/node.ts#L338\n   */\n\n  Node.prototype.compareDocumentPosition = function (other) {\n    var _a;\n\n    if (other === this) {\n      // same node\n      return 0;\n    }\n\n    if (!(other instanceof Node)) {\n      throw new TypeError('Node.compareDocumentPosition: Argument 1 does not implement interface Node.');\n    }\n\n    var node1Root = other; // eslint-disable-next-line @typescript-eslint/no-this-alias\n\n    var node2Root = this;\n    var node1Hierarchy = [node1Root];\n    var node2Hierarchy = [node2Root];\n\n    while ((_a = node1Root.parentNode) !== null && _a !== void 0 ? _a : node2Root.parentNode) {\n      node1Root = node1Root.parentNode ? (node1Hierarchy.push(node1Root.parentNode), node1Root.parentNode) : node1Root;\n      node2Root = node2Root.parentNode ? (node2Hierarchy.push(node2Root.parentNode), node2Root.parentNode) : node2Root;\n    } // Check if they don't share the same root node\n\n\n    if (node1Root !== node2Root) {\n      return Node.DOCUMENT_POSITION_DISCONNECTED | Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC | Node.DOCUMENT_POSITION_PRECEDING;\n    }\n\n    var longerHierarchy = node1Hierarchy.length > node2Hierarchy.length ? node1Hierarchy : node2Hierarchy;\n    var shorterHierarchy = longerHierarchy === node1Hierarchy ? node2Hierarchy : node1Hierarchy; // Check if either is a container of the other\n\n    if (longerHierarchy[longerHierarchy.length - shorterHierarchy.length] === shorterHierarchy[0]) {\n      return longerHierarchy === node1Hierarchy ? // other is a child of this\n      Node.DOCUMENT_POSITION_CONTAINED_BY | Node.DOCUMENT_POSITION_FOLLOWING : // this is a child of other\n      Node.DOCUMENT_POSITION_CONTAINS | Node.DOCUMENT_POSITION_PRECEDING;\n    } // Find their first common ancestor and see whether they\n    // are preceding or following\n\n\n    var longerStart = longerHierarchy.length - shorterHierarchy.length;\n\n    for (var i = shorterHierarchy.length - 1; i >= 0; i--) {\n      var shorterHierarchyNode = shorterHierarchy[i];\n      var longerHierarchyNode = longerHierarchy[longerStart + i]; // We found the first common ancestor\n\n      if (longerHierarchyNode !== shorterHierarchyNode) {\n        var siblings = shorterHierarchyNode.parentNode.childNodes;\n\n        if (siblings.indexOf(shorterHierarchyNode) < siblings.indexOf(longerHierarchyNode)) {\n          // Shorter is before longer\n          if (shorterHierarchy === node1Hierarchy) {\n            // Other is before this\n            return Node.DOCUMENT_POSITION_PRECEDING;\n          } else {\n            // This is before other\n            return Node.DOCUMENT_POSITION_FOLLOWING;\n          }\n        } else {\n          // Longer is before shorter\n          if (longerHierarchy === node1Hierarchy) {\n            // Other is before this\n            return Node.DOCUMENT_POSITION_PRECEDING;\n          } else {\n            // Other is after this\n            return Node.DOCUMENT_POSITION_FOLLOWING;\n          }\n        }\n      }\n    }\n\n    return Node.DOCUMENT_POSITION_FOLLOWING;\n  };\n  /**\n   * @deprecated\n   * @alias contains\n   */\n\n\n  Node.prototype.contain = function (other) {\n    return this.contains(other);\n  };\n\n  Node.prototype.contains = function (other) {\n    // the node itself, one of its direct children\n    var tmp = other; // @see https://developer.mozilla.org/en-US/docs/Web/API/Node/contains\n\n    while (tmp && this !== tmp) {\n      tmp = tmp.parentNode;\n    }\n\n    return !!tmp;\n  };\n\n  Node.prototype.getAncestor = function (n) {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    var temp = this;\n\n    while (n > 0 && temp) {\n      temp = temp.parentNode;\n      n--;\n    }\n\n    return temp;\n  };\n\n  Node.prototype.forEach = function (callback) {\n    if (!callback(this)) {\n      this.childNodes.forEach(function (child) {\n        child.forEach(callback);\n      });\n    }\n  };\n  /**\n   * Both nodes are in different documents or different trees in the same document.\n   */\n\n\n  Node.DOCUMENT_POSITION_DISCONNECTED = 1;\n  /**\n   * otherNode precedes the node in either a pre-order depth-first traversal\n   * of a tree containing both (e.g., as an ancestor or previous sibling or a descendant of a previous sibling or previous sibling of an ancestor) or (if they are disconnected) in an arbitrary but consistent ordering.\n   */\n\n  Node.DOCUMENT_POSITION_PRECEDING = 2;\n  /**\n   * otherNode follows the node in either a pre-order depth-first traversal of a tree containing both (e.g., as a descendant or following sibling or a descendant of a following sibling or following sibling of an ancestor) or (if they are disconnected) in an arbitrary but consistent ordering.\n   */\n\n  Node.DOCUMENT_POSITION_FOLLOWING = 4;\n  /**\n   * otherNode is an ancestor of the node.\n   */\n\n  Node.DOCUMENT_POSITION_CONTAINS = 8;\n  /**\n   * otherNode is a descendant of the node.\n   */\n\n  Node.DOCUMENT_POSITION_CONTAINED_BY = 16;\n  /**\n   * The result relies upon arbitrary and/or implementation-specific behavior and is not guaranteed to be portable.\n   */\n\n  Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC = 32;\n  return Node;\n}(EventTarget);\n\nexport { Node };"]},"metadata":{},"sourceType":"module"}